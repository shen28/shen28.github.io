<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[天河公园]]></title>
      <url>/2017/10/08/tianhe/</url>
      <content type="html"><![CDATA[<p>跑跑步…<br><img src="\assets\articleImg\tianhepark.png" alt="天河公园"></p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[闭包]]></title>
      <url>/2017/09/12/%E9%97%AD%E5%8C%85/</url>
      <content type="html"><![CDATA[<p>在Web开发中，在使用JavScript时，就算没用过，也听说过闭包这个名词。闭将外部作用域中的局部变量封闭起来的函数成为闭包，本质就是一个函数。<a id="more"></a><br>闭包的作用</p>
<ul>
<li>保护函数内变量的安全，不能被外部随意修改，只能通过制定函数接口操作</li>
<li>在内存中维持变量，不会被销毁，所以弊端是滥用可能造成内存泄漏</li>
</ul>
<p>例子<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> num = <span class="number">9</span>;</div><div class="line">    add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	num++;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	<span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> clo;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//add();//这里还不能执行</span></div><div class="line"><span class="keyword">var</span> f = fun();<span class="comment">//获得闭包函数</span></div><div class="line">add();<span class="comment">//操作num的值</span></div><div class="line"><span class="keyword">var</span> value = f();<span class="comment">//执行函数获取局部变量num的值 11</span></div></pre></td></tr></table></figure></p>
<p>以上例子最终的 value 值就是局部变量 num 的值， clo 函数就是闭包。<br>我们无法直接访问 num 变量，但根据Javascript的链式作用域，对于 clo ， fun 内部的所有内部变量都是可见的，所以只要把 clo 作为返回值就可以在外部访问 num 内部变量了。<br>add 函数在这里是一个全局变量，在Javascript中，在函数中变量定义不加上 var 或者其他类型，会被视为全局变量，但要在函数执行后得到声明才能使用，如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> i = <span class="number">1</span>;<span class="comment">//局部</span></div><div class="line">    j = <span class="number">2</span>;<span class="comment">//全局，执行test函数时声明，之后全局可用</span></div><div class="line">&#125;</div><div class="line">test();</div><div class="line"><span class="built_in">console</span>.log(j)</div></pre></td></tr></table></figure></p>
<p>所以在 fun 函数执行后声明完成，就可以在外部执行，由于闭包 clo 维持了 num 变量，所以在外部 add 函数修改的 num 跟在 fun 函数中 num 的是同一个。</p>
<p>事实上， num 变量在函数中有点类似 Java 中的私有变量，外部不能直接访问，而需要函数内部其他方法访问。以函数对象写另一个例子<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fun = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> age = <span class="number">23</span>;</div><div class="line">    <span class="keyword">var</span> name = <span class="string">"shen"</span>;</div><div class="line">    <span class="keyword">this</span>.getAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	<span class="keyword">return</span> age;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	<span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.setAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    	age++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> ff = <span class="keyword">new</span> foo();</div><div class="line"><span class="comment">//ff.age;//访问不到局部变量</span></div><div class="line">ff.setAge();</div><div class="line"><span class="built_in">console</span>.log(ff.getAge())<span class="comment">//24</span></div><div class="line"><span class="built_in">console</span>.log(ff.getName())<span class="comment">//shen</span></div></pre></td></tr></table></figure></p>
<p>在 Java 中，也有类似的闭包实现存在，匿名内部类就是一个例子，它可以访问外部类的成员变量（相当于第一个例子的clo函数可以访问fun函数的num变量）。但是，由于Java无法保证内部类使用的外部类的局部变量在内外部类同步都指向同一基本类型数据或对象，因为Java只是把外部类的变量做一个拷贝丢给了内部类另一个变量而已。所以，只能干脆限制在内部类访问的外部类变量必须定义为 final 类型，即初始化后就不能修改<br>接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Cat</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>测试类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eatSomething</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//final int num = 10;</span></div><div class="line">        <span class="keyword">int</span> num = <span class="number">10</span>;<span class="comment">//final默认可以不写，但当你尝试对num进行操作，比如num++之类，编译器会报错（环境Java8）</span></div><div class="line">        Cat a = <span class="keyword">new</span> Cat() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"eat "</span> + num + <span class="string">" fish"</span>);<span class="comment">//访问外部num变量</span></div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        a.eat();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="comment">//Java8支持更简便的Lambda表达式</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LambdaEatTest</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">10</span>;</div><div class="line">        Cat cat = ()-&gt;System.out.println(<span class="string">"eat "</span> + num + <span class="string">" fish"</span>);</div><div class="line">        cat.eat();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> Test().eatSomething();</div><div class="line">        <span class="keyword">new</span> Test().LambdaEatTest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>因此，也有些人认为Java的闭包不能算是真正意义上的闭包，有不可修改外部变量的限制。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RESTful API开发的简单应用]]></title>
      <url>/2017/09/02/RESTful%20API%20%E5%BC%80%E5%8F%91/</url>
      <content type="html"><![CDATA[<p>在很早之前接触 Spring MVC 的时候，都知道 Spring MVC 支持 RESTful 风格API的开发，但对于 RESTful 只是有个模糊的认识，以至于甚至在开发写出来的接口其实不符合 RESTful 的要求。</p>
<p>#####定义<br>REST 的全称是 Resource Representational State Transfer ，资源以某种表现形式进行状态转移<br>Resource：资源，即数据；<br>Representational：某种表现形式，比如用JSON，XML，JPEG等；<br>State Transfer：状态变化。通过HTTP动词实现。<br><a id="more"></a><br>HTTP动词有如下几个：</p>
<ul>
<li>GET    用来获取资源，</li>
<li>POST  用来新建资源（也可以用于更新资源），</li>
<li>PUT    用来更新资源，</li>
<li>DELETE  用来删除资源</li>
</ul>
<p>在RESTful API中，URL中只使用名词来指定资源，原则上不使用动词，并且一般使用复数，比如 GET 操作 <a href="https://v1/users/1" target="_blank" rel="external">https://v1/users/1</a> 来获取用户id为1的信息资源，禁止使用 <a href="http://v1/getUserById" target="_blank" rel="external">http://v1/getUserById</a> 、 <a href="http://v1/deleteUser" target="_blank" rel="external">http://v1/deleteUser</a> 之类的url。</p>
<h5 id="用处"><a href="#用处" class="headerlink" title="用处"></a>用处</h5><p>一种技术的存在肯定是为了解决一些问题而诞生的，REST是一种软件架构模式，通过使用RESTful 风格的 API 用来解决多端（PC、Android、IOS）共用一套统一的 API ，避免重复开发。</p>
<h5 id="在-SpringMVC-中的应用"><a href="#在-SpringMVC-中的应用" class="headerlink" title="在 SpringMVC 中的应用"></a>在 SpringMVC 中的应用</h5><p>用 SpringMVC 可以开发 restful 风格的restful api，以 Spring Boot 为基本框架，这里写一个基本的 controller 类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/users"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    UserService userService;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"&#123;id&#125;"</span>, method=RequestMethod.GET)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> String userId) </span>&#123;</div><div class="line">        <span class="keyword">return</span> ResultUtil.success(userService.getUserById(userId), <span class="string">"操作成功"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"&#123;id&#125;"</span>, method=RequestMethod.PUT)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateUser</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> String userId) </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = userService.updateUser(userId);</div><div class="line">        <span class="keyword">if</span> (<span class="number">1</span>==num)&#123;</div><div class="line">            <span class="keyword">return</span> ResultUtil.success(<span class="string">"操作成功"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> ResultUtil.error(<span class="string">"操作失败"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(method=RequestMethod.POST)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">insertUser</span><span class="params">(String userCode, String userName)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = userService.insertUser(userCode, userName);</div><div class="line">        <span class="keyword">if</span> (<span class="number">1</span>==num)&#123;</div><div class="line">            <span class="keyword">return</span> ResultUtil.success(<span class="string">"操作成功"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> ResultUtil.error(<span class="string">"操作失败"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"&#123;id&#125;"</span>, method=RequestMethod.DELETE)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteUser</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> String userId) </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = userService.deleteUser(userId);</div><div class="line">        <span class="keyword">if</span> (<span class="number">1</span>==num)&#123;</div><div class="line">            <span class="keyword">return</span> ResultUtil.success(<span class="string">"操作成功"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> ResultUtil.error(<span class="string">"操作失败"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ResultUtil 封装返回数据格式，这里只是一个简单的封装<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultUtil</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String SUCCESS = <span class="string">"success"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String MSG = <span class="string">"msg"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String DATA = <span class="string">"data"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">success</span><span class="params">(String msg)</span></span>&#123;</div><div class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</div><div class="line">        result.put(SUCCESS, <span class="keyword">true</span>);</div><div class="line">        result.put(MSG, msg);</div><div class="line">        result.put(DATA, <span class="keyword">new</span> Object());</div><div class="line">        <span class="keyword">return</span> JSON.toJSONString(result);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">success</span><span class="params">(Object data, String msg)</span></span>&#123;</div><div class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</div><div class="line">        result.put(SUCCESS, <span class="keyword">true</span>);</div><div class="line">        result.put(MSG, msg);</div><div class="line">        result.put(DATA, data);</div><div class="line">        <span class="keyword">return</span> JSON.toJSONString(result);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">error</span><span class="params">(String msg)</span></span>&#123;</div><div class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</div><div class="line">        result.put(SUCCESS, <span class="keyword">false</span>);</div><div class="line">        result.put(MSG, msg);</div><div class="line">        result.put(DATA, <span class="keyword">new</span> Object());</div><div class="line">        <span class="keyword">return</span> JSON.toJSONString(result);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">error</span><span class="params">(Object data, String msg)</span></span>&#123;</div><div class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</div><div class="line">        result.put(SUCCESS, <span class="keyword">false</span>);</div><div class="line">        result.put(MSG, msg);</div><div class="line">        result.put(DATA, data);</div><div class="line">        <span class="keyword">return</span> JSON.toJSONString(result);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>对应的请求url为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">查询、更新、删除： /users/1</div><div class="line">插入： /users</div></pre></td></tr></table></figure></p>
<p>有时需要管理版本号会把版本号写在url，比如 <code>v1/users/1</code>、 <code>v2/users/1</code> 。至于请求是什么类型的，可以在请求在head中设置，如果是ajax请求则设置比较简单<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$.ajax(&#123;</div><div class="line">    <span class="attr">url</span>: <span class="string">'/users/1'</span>,</div><div class="line">    <span class="attr">type</span>: <span class="string">'get'</span>,<span class="comment">//put、delete</span></div><div class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(data)</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">$.ajax(&#123;</div><div class="line">    <span class="attr">url</span>: <span class="string">'/users'</span>,</div><div class="line">    <span class="attr">type</span>: <span class="string">'post'</span>,</div><div class="line">    <span class="attr">data</span>: &#123;</div><div class="line">        <span class="attr">userCode</span>: <span class="string">'test'</span>,</div><div class="line">        <span class="attr">userName</span>: <span class="string">'测试名字'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(data)</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>RESTful API 的开发涉及许多细节和技术实现，实际开发中的应用会可能会用到一些封装库和框架，这里不做深入了解，只是简单的记录自己的一些基本认识，相关的知识参考了以下的链接。</p>
<p>#####相关参考链接</p>
<ul>
<li><a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="external">REST的出处论文 - 作者Roy Fielding</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/05/restful_api.html" target="_blank" rel="external">RESTful API 设计指南 - 阮一峰的网络日志</a></li>
<li><a href="https://zhihu.com/question/28557115/answer/48094438" target="_blank" rel="external">怎样用通俗的语言解释REST，以及RESTful？ - 回答作者: 覃超</a></li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> Web技术 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[用本地服务器解决node-sass安装失败问题]]></title>
      <url>/2017/08/20/%E7%94%A8%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%A3%E5%86%B3node-sass%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>今天要用到node-sass这东西，使用命令 <code>npm install node-sass --save</code> 安装。然而搞半天始终下载不来，换成淘宝的镜像都不行，因为下载时还会去github下载一个 <code>win32-x64-48_binding.node</code> 的包，然后下不来就一直卡着最后失败。<br>一种解决方法就是根据下载失败提示的链接直接把那个二进制包下载下来，然后放在本地服务器目录下，比如可以根据失败提示的版本号在Nginx的html目录下以版本号建个文件夹放进去，像这样 <code>nginx-1.10.1\html\v4.5.3\win32-x64-48_binding.node</code> ,然后执行 <code>npm install node-sass --save-dev --sass-binary-site=http://localhost:8090/ --registry=https://registry.npm.taobao.org</code> 端口号为Nginx设置的端口号， <code>v4.5.3\win32-x64-48_binding.node</code> 这一串不用加，这样 <code>win32-x64-48_binding.node</code> 这个包就直接从本地服务器下载了。</p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[线程池]]></title>
      <url>/2017/07/20/%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
      <content type="html"><![CDATA[<p>创建一个新的线程是有代价的，创建大量的线程会消耗许多系统资源，影响系统的性能。这时，我们就需要使用线程池来管理线程，线程池能缓存线程，可用闲置的线程来执行新任务，能有效控制线程并发数，并对线程进行一些简单的管理。<a id="more"></a></p>
<p>先创建一个线程任务类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(TaskThread.class);</div><div class="line">    <span class="keyword">private</span> String task;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TaskThread</span><span class="params">(String task)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.task = task;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        task();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">task</span><span class="params">()</span></span>&#123;</div><div class="line">        LOG.info(<span class="string">"任务:"</span> + task + <span class="string">"  线程:"</span>+ Thread.currentThread().getName());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>按照一般方式我们通过 <code>new Thread(new TaskThread(&quot;task&quot;));</code> 的方式来创建一个线程，再调用start方法来启动线程。而线程池为我们提供了另一种创建管理方式，线程池的实现方式也有多种。</p>
<h3 id="使用LinkedList做任务队列来实现一个简单线程池"><a href="#使用LinkedList做任务队列来实现一个简单线程池" class="headerlink" title="使用LinkedList做任务队列来实现一个简单线程池"></a>使用LinkedList做任务队列来实现一个简单线程池</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WorkQueue</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(WorkQueue.class);</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,WorkQueue&gt; queues = <span class="keyword">new</span> HashMap&lt;String,WorkQueue&gt;();</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> nThreads;<span class="comment">//线程池大小</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PoolWorker[] threads;<span class="comment">//用数组实现线程池</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LinkedList&lt;Runnable&gt; queue;<span class="comment">//双向链表实现任务队列</span></div><div class="line"></div><div class="line">    <span class="comment">/**私有构造**/</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">WorkQueue</span><span class="params">(String name,<span class="keyword">int</span> nThreads)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">this</span>.nThreads = nThreads;</div><div class="line">        queue = <span class="keyword">new</span> LinkedList&lt;Runnable&gt;();</div><div class="line">        threads = <span class="keyword">new</span> PoolWorker[nThreads];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.nThreads; i++) &#123;</div><div class="line">            threads[i] = <span class="keyword">new</span> PoolWorker(name+<span class="string">"_"</span>+(i+<span class="number">1</span>));</div><div class="line">            threads[i].start();</div><div class="line">        &#125;</div><div class="line">        LOG.info(<span class="string">"初始化线程池，线程数："</span>+nThreads);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**静态工厂方法创建线程池**/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> WorkQueue <span class="title">createWorkQueue</span><span class="params">(String name,<span class="keyword">int</span> count)</span></span>&#123;</div><div class="line">    	WorkQueue wq = queues.get(name);</div><div class="line">    	<span class="keyword">if</span>(wq == <span class="keyword">null</span>)&#123;</div><div class="line">    		wq = <span class="keyword">new</span> WorkQueue(name,count);</div><div class="line">    		queues.put(name, wq);</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">return</span> wq;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="comment">/**执行任务**/</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable r)</span> </span>&#123;</div><div class="line">        <span class="keyword">synchronized</span>(queue) &#123;</div><div class="line">            queue.addLast(r);</div><div class="line">            queue.notify();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**工作线程类**/</span></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">PoolWorker</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">    	PoolWorker(String name)&#123;</div><div class="line">    		<span class="keyword">super</span>(name);</div><div class="line">    	&#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            Runnable r;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">                <span class="keyword">synchronized</span>(queue) &#123;</div><div class="line">                    <span class="keyword">while</span> (queue.isEmpty()) &#123;</div><div class="line">                        <span class="keyword">try</span>&#123;</div><div class="line">                            queue.wait();<span class="comment">//如果任务队列没有任务，等待</span></div><div class="line">                        &#125;<span class="keyword">catch</span> (InterruptedException ignored)&#123;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    r = (Runnable) queue.removeFirst();<span class="comment">//有任务时，取出任务</span></div><div class="line">                &#125;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    LOG.info(<span class="string">"线程:"</span>+Thread.currentThread().getName()+<span class="string">" 开始执行"</span>);</div><div class="line">                    r.run();<span class="comment">//执行任务</span></div><div class="line">                &#125;</div><div class="line">                <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                    LOG.info(<span class="string">"线程:"</span>+Thread.currentThread().getName()+<span class="string">" 执行出现异常！"</span>);</div><div class="line">                	e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">                LOG.info(<span class="string">"线程:"</span>+Thread.currentThread().getName()+<span class="string">" 执行完成"</span>);</div><div class="line">                r = <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试例子，大小为10的线程池执行20个任务<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">WorkQueue wq = WorkQueue.createWorkQueue(<span class="string">"thread"</span>, <span class="number">10</span>);</div><div class="line"></div><div class="line">TaskThread task[] = <span class="keyword">new</span> TaskThread[<span class="number">20</span>];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; task.length; i++)&#123;</div><div class="line">    task[i] = <span class="keyword">new</span> TaskThread(<span class="string">"task_"</span>+i);</div><div class="line">    wq.execute(task[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="使用Executors和ThreadPoolExecutor创建线程池"><a href="#使用Executors和ThreadPoolExecutor创建线程池" class="headerlink" title="使用Executors和ThreadPoolExecutor创建线程池"></a>使用Executors和ThreadPoolExecutor创建线程池</h3><p>Java 的 java.util.concurrent 包提供了 Executors 类来创建线程池，Executors 类有四种线程池构造，分别为：</p>
<ul>
<li>newCachedThreadPool创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。</li>
<li>newFixedThreadPool 创建一个定长线程池，可控制线程最大并发数，超出的线程会在队列中等待。</li>
<li>newScheduledThreadPool 创建一个定长线程池，支持定时及周期性任务执行。</li>
<li>newSingleThreadExecutor 创建一个单线程化的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。</li>
</ul>
<p>之前在阿里的开发手册中有看到，各种 Executors 返回的线程池对象弊端如下：<br>1）    FixedThreadPool 和 SingleThreadPool:<br>允许的请求队列长度为 Integer.MAX_VALUE，可能会堆积大量的请求，从而导致 OOM。<br>2）    CachedThreadPool 和 ScheduledThreadPool:<br>允许的创建线程数量为 Integer.MAX_VALUE，可能会创建大量的线程，从而导致 OOM。</p>
<p>一般常用 newFixedThreadPool 构造返回 ExecutorService 对象来创建线程池。 ExecutorService 接口继承了 Executor 接口（Executor是接口，Executors是类），提供了线程池的操作的成员函数。</p>
<p>使用 Executors 创建线程池类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPool</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(ThreadPool.class);</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,ThreadPool&gt; pools = <span class="keyword">new</span> HashMap&lt;String,ThreadPool&gt;();</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> threadCount = <span class="number">0</span>;</div><div class="line">	<span class="keyword">private</span> String name = <span class="keyword">null</span>;;</div><div class="line">	ExecutorService service = <span class="keyword">null</span>;</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">ThreadPool</span><span class="params">(String name,<span class="keyword">int</span> count)</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.threadCount = count;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		service = Executors.newFixedThreadPool(<span class="keyword">this</span>.threadCount);</div><div class="line">		LOG.info(<span class="string">"初始化线程池，线程数["</span>+<span class="keyword">this</span>.name+<span class="string">"]："</span>+<span class="keyword">this</span>.threadCount);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ThreadPool <span class="title">createThreadPool</span><span class="params">(String name,<span class="keyword">int</span> count)</span></span>&#123;</div><div class="line">		ThreadPool pool = pools.get(name);</div><div class="line">    	<span class="keyword">if</span>(pool == <span class="keyword">null</span>)&#123;</div><div class="line">    		pool = <span class="keyword">new</span> ThreadPool(name,count);</div><div class="line">    		pools.put(name, pool);</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">return</span> pool;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable r)</span> </span>&#123;</div><div class="line">		service.execute(r);</div><div class="line">    &#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</div><div class="line">		service.shutdown();</div><div class="line">		pools.remove(<span class="keyword">this</span>.getName());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其中，看下 newFixedThreadPool 方法的源码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</div><div class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</div><div class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这是 ThreadPoolExecutor 类的一个实现，再看下构造方法的参数<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></div><div class="line">                          <span class="keyword">int</span> maximumPoolSize,</div><div class="line">                          <span class="keyword">long</span> keepAliveTime,</div><div class="line">                          TimeUnit unit,</div><div class="line">                          BlockingQueue&lt;Runnable&gt; workQueue) &#123;</div><div class="line">    <span class="keyword">this</span>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,</div><div class="line">         Executors.defaultThreadFactory(), defaultHandler);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>corePoolSize 核心线程数。核心线程会一直存活，即使没有任务需要处理。即使现有的线程空闲，线程池也会优先创建新线程来处理任务，而不是直接交给现有的线程处理。<br>核心线程在allowCoreThreadTimeout被设置为true时会超时退出，默认情况下不会退出。</li>
<li>maximumPoolSize 最大的线程数。当线程数大于或等于核心线程，且任务队列已满时，线程池会创建新的线程，直到线程数量达到maximumPoolSize。如果线程数已等于maximumPoolSize，且任务队列已满，则已超出线程池的处理能力，线程池会拒绝处理任务而抛出异常。</li>
<li>keepAliveTime 存活时间。当线程空闲时间达到keepAliveTime，该线程会退出，直到线程数量等于corePoolSize。如果allowCoreThreadTimeout设置为true，则所有线程均会退出直到线程数量为0。</li>
</ul>
<p>allowCoreThreadTimeout 属性标识默认情况下核心线程不会退出，可通过将该参数设置为true，让核心线程也退出。</p>
<p>测试例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ThreadPool threadPool = ThreadPool.createThreadPool(<span class="string">"testThread"</span>, <span class="number">10</span>);</div><div class="line">TaskThread task[] = <span class="keyword">new</span> TaskThread[<span class="number">20</span>];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; task.length; i++)&#123;</div><div class="line">    task[i] = <span class="keyword">new</span> TaskThread(<span class="string">"task_"</span>+i);</div><div class="line">    threadPool.execute(task[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ThreadPoolExecutor-其他相关"><a href="#ThreadPoolExecutor-其他相关" class="headerlink" title="ThreadPoolExecutor 其他相关"></a>ThreadPoolExecutor 其他相关</h3><p>ThreadPoolExecutor 本身可以指定创建活跃线程数、限制线程池的大小，还可以创建自己的 RejectedExecutionHandler 来处理不适合放在工作队列里的任务。</p>
<p>终止策略 RejectedExecutionHandler 实现类,当提交的任务无法进入等待队列且线程池中创建的线程数量已经达到了最大线程数量的限制，则会拒绝新提交的任务<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.concurrent.RejectedExecutionHandler;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RejectedExecutionHandlerImpl</span> <span class="keyword">implements</span> <span class="title">RejectedExecutionHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(RejectedExecutionHandlerImpl.class);</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rejectedExecution</span><span class="params">(Runnable r, ThreadPoolExecutor executor)</span> </span>&#123;</div><div class="line">        LOG.info(r.toString() + <span class="string">"不能执行。"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>完整测试例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ThreadFactory;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(TaskTest.class);</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">/*WorkQueue wq = WorkQueue.createWorkQueue("thread", 10);</span></div><div class="line">        TaskThread task[] = new TaskThread[20];</div><div class="line">        for(int i=0; i&lt;task.length; i++)&#123;</div><div class="line">            task[i] = new TaskThread("task_"+i);</div><div class="line">            wq.execute(task[i]);</div><div class="line">        &#125;*/</div><div class="line"></div><div class="line">        <span class="comment">/*ThreadPool threadPool = ThreadPool.createThreadPool("testThread", 10);</span></div><div class="line">        TaskThread task[] = new TaskThread[20];</div><div class="line">        for(int i=0; i&lt;task.length; i++)&#123;</div><div class="line">            task[i] = new TaskThread("task_"+i);</div><div class="line">            threadPool.execute(task[i]);</div><div class="line">        &#125;*/</div><div class="line"></div><div class="line">        RejectedExecutionHandlerImpl rejectionHandler = <span class="keyword">new</span> RejectedExecutionHandlerImpl();</div><div class="line">        ThreadFactory threadFactory = Executors.defaultThreadFactory();</div><div class="line">        ThreadPoolExecutor threadPool = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">2</span>, <span class="number">4</span>, <span class="number">10</span>,</div><div class="line">                TimeUnit.SECONDS, <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">2</span>), threadFactory, rejectionHandler);</div><div class="line">        <span class="comment">//TaskThread task[] = new TaskThread[4];//少数量任务</span></div><div class="line">        TaskThread task[] = <span class="keyword">new</span> TaskThread[<span class="number">20</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;task.length; i++)&#123;</div><div class="line">            task[i] = <span class="keyword">new</span> TaskThread(<span class="string">"task_"</span>+i);</div><div class="line">            threadPool.execute(task[i]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>线程池线程核心数设置为2，最大线程数设置为4，当执行少数量任务时线程池未饱和不会触发终止策略，而执行大量任务就可能会触发，比如以上测试例子的4个任务和20任务的区别。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boot 打包部署]]></title>
      <url>/2017/07/15/Spring%20Boot%E9%83%A8%E7%BD%B2/</url>
      <content type="html"><![CDATA[<p>Spring Boot默认集成Web容器，部署也相对简单，如果需要以war包形式部署在外部Web容器上也可以，只需要做一些简单的修改配置。<br><a id="more"></a></p>
<h2 id="使用集成的Web容器部署方式"><a href="#使用集成的Web容器部署方式" class="headerlink" title="使用集成的Web容器部署方式"></a>使用集成的Web容器部署方式</h2><p><strong>打包</strong><br>maven 工程在 eclipse 中执行 Run as Maven build，输入 clean package 进行打包，这里要注意的是 Spring Boot 打成jar包要可以运行，必须使用Spring Boot提供的一个插件，不然打成的普通的jar是无法运行Spring Boot工程的，一般会提示 jar中没有主清单属性。<br>在pom.xml加入插件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>生成的 jar 包使用 <code>java -jar xx.jar</code> 命令就可以启动。</p>
<h2 id="部署到外部Web容器方式"><a href="#部署到外部Web容器方式" class="headerlink" title="部署到外部Web容器方式"></a>部署到外部Web容器方式</h2><p>在 pom.xml 文件将 <code>&lt;packaging&gt;jar&lt;/packaging&gt;</code> 改为 <code>&lt;packaging&gt;war&lt;/packaging&gt;</code><br>加上build插件，表明此Web工程不需要web.xml文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">failOnMissingWebXml</span>&gt;</span>false<span class="tag">&lt;/<span class="name">failOnMissingWebXml</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>排除 Spring Boot Tomcat 组件，scope 属性设为 provided<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>在 Application 即main方法类同包下创建实现外部 Web 容器启动的启动类<br>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.web.support.SpringBootServletInitializer;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WxServletInitializer</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder builder)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> builder.sources(WxApplication.class);<span class="comment">//WxApplication 为原main函数启动类</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>打包完毕将war包部署到外部Web容器。</p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ThreadLcoal]]></title>
      <url>/2017/07/01/ThreadLcoal/</url>
      <content type="html"><![CDATA[<p>ThreadLcoal不是线程，而是一个创建线程的局部变量的类，主要用于存储多线程下类的某些变量，ThreadLocal为每个使用该变量的线程提供独立的变量副本，当前线程的ThreadLocal的变量只能被该线程访问，而其他线程访问不到。<br><a id="more"></a><br><strong>使用</strong><br>类定义，支持泛型<br><code>public class ThreadLocal&lt;T&gt;</code><br>初始化值<br><code>private T setInitialValue()</code><br>set方法<br><code>public void set(T value)</code><br>get方法<br><code>public T get()</code></p>
<p><strong>例子</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test04</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> ThreadLocal&lt;Integer&gt; local = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</div><div class="line">    </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">localTread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNum</span><span class="params">()</span></span>&#123;</div><div class="line">            local.set(i++);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getNum</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> local.get();</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(local.get() == <span class="keyword">null</span>)&#123;</div><div class="line">                setNum();</div><div class="line">                System.out.println(<span class="string">"set threadlocal num..."</span>);</div><div class="line">            &#125;</div><div class="line">            System.out.print(<span class="string">"the object is: "</span>);</div><div class="line">            System.out.println(local);</div><div class="line">            System.out.println(local.get());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            localTread t = <span class="keyword">new</span> Test04().new localTread();</div><div class="line">            </div><div class="line">            Thread t1 = <span class="keyword">new</span> Thread(t);</div><div class="line">            Thread t2 = <span class="keyword">new</span> Thread(t);</div><div class="line">            Thread t3 = <span class="keyword">new</span> Thread(t);</div><div class="line">            </div><div class="line">            t1.start();</div><div class="line">            Thread.sleep(<span class="number">1000</span>);</div><div class="line">            t2.start();</div><div class="line">            Thread.sleep(<span class="number">1000</span>);</div><div class="line">            t3.start();</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">set threadlocal num...</div><div class="line">the object is: java.lang.ThreadLocal@6b2ce86d</div><div class="line">0</div><div class="line">set threadlocal num...</div><div class="line">the object is: java.lang.ThreadLocal@6b2ce86d</div><div class="line">1</div><div class="line">set threadlocal num...</div><div class="line">the object is: java.lang.ThreadLocal@6b2ce86d</div><div class="line">2</div></pre></td></tr></table></figure></p>
<p>可以看到三个线程访问的都是同一个ThreadLocal，但只能访问当前线程存储的各自的变量。<br>看源码set方法的实现<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;</div><div class="line">	Thread t = Thread.currentThread();</div><div class="line">	ThreadLocalMap map = getMap(t);</div><div class="line">	<span class="keyword">if</span> (map != <span class="keyword">null</span>)</div><div class="line">		map.set(<span class="keyword">this</span>, value);</div><div class="line">	<span class="keyword">else</span></div><div class="line">		createMap(t, value);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>通过获取当前线程，再ThreadL中，ThreadLocalMap用弱引用实现<br>get方法实现<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</div><div class="line">	Thread t = Thread.currentThread();</div><div class="line">	ThreadLocalMap map = getMap(t);</div><div class="line">	<span class="keyword">if</span> (map != <span class="keyword">null</span>) &#123;</div><div class="line">		ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</div><div class="line">		<span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</div><div class="line">			<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">			T result = (T)e.value;</div><div class="line">			<span class="keyword">return</span> result;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> setInitialValue();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>同样是为了解决多线程中变量冲突的问题，线程同步机制实现在某个时间点只有一个线程能访问变量，而ThreadLcoal是通过存储每个线程自己变量，以隔离多线程访问数据的冲突，一个损耗时间，一个损耗空间。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[泛型]]></title>
      <url>/2017/06/30/%E6%B3%9B%E5%9E%8B/</url>
      <content type="html"><![CDATA[<p>泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。使用泛型，意味着编写的代码可以被很多不同类型    的对象所重用。<br><a id="more"></a><br><strong>泛型类</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassTest</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> T firtsFiled;</div><div class="line">    <span class="keyword">public</span> T secondFiled;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirtsFiled</span><span class="params">(T data)</span></span>&#123;</div><div class="line">        firtsFiled = data;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSecondFiled</span><span class="params">(T data)</span></span>&#123;</div><div class="line">        secondFiled = data;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getFirtsFiled</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> firtsFiled;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getSecondFiled</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> secondFiled;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">getStaticData</span><span class="params">(T data)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> data;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>以上是一个简单的泛型类，T成为类型变量，一般使用大写字母命名。在Java中常用变量E表示集合的元素类型，K和V表示关键字与值的类型，T表示任意类型（约定俗成的用法，事实随便一个字母都行）。<br>当实例化泛型类型需要用具体类型替代类型变量<br>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ClassTest&lt;String&gt; one  = <span class="keyword">new</span> ClassTest&lt;&gt;();</div><div class="line">ClassTest&lt;Integer&gt; two  = <span class="keyword">new</span> ClassTest&lt;&gt;();</div><div class="line">one.setFirtsFiled(<span class="string">"data1"</span>);      </div><div class="line">two.setFirtsFiled(<span class="number">123</span>);</div></pre></td></tr></table></figure></p>
<p><strong>泛型方法</strong><br>泛型方法可以定义在普通类或泛型类中，与普通方法不同，泛型方法可以在调用它的时候定义类型变量。<br>例如 <code>public static &lt;T&gt; T getStaticData(T data)</code> 就是一个泛型方法，在方法的返回值前加上 <code>&lt;T&gt;</code> ，在调用时指定类型变量，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Integer staticData = ClassTest.getStaticData(<span class="number">9090</span>);</div><div class="line">String hello = ClassTest.getStaticData(<span class="string">"hello"</span>);</div></pre></td></tr></table></figure></p>
<p><strong>类型变量的限制</strong><br>先看这个代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Comparable&gt; <span class="function"><span class="keyword">boolean</span> <span class="title">getMinData</span><span class="params">(T data)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span>  data.compareTo(data) &gt; <span class="number">0</span> ;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>之所以在定义泛型方法时给 <code>&lt;T&gt;</code> 继承 <code>Comparable</code> 接口，是因为 <code>data</code> 的类型无法确定，不能保证对象都有 <code>compareTo</code> 方法。<br>一个类型变量或通配符可以有多个限定，例如 <code>T extends Comparable &amp; Serializable</code><br>限定类型用“&amp;”分隔，而逗号用来分隔类型变量。<br>在Java的继承中，可以根据需要拥有多个接口超类型，但限定中至多有一个类。如果用一个类作为限定，它必须是限定列表中的第一个。(core Java)</p>
<p><strong>类型擦除</strong><br>在虚拟机中没有泛型类型对象，所有对象都属于普通类。Java中的泛型基本上都是在编译器这个级别实现的，生成的字节码信息中是不包含泛型中的类型信息的。在定义一个泛型类型时， 都会提供一个删去类型参数后的原始类型，擦除类型变量，并替换为限定类型（无限定的变量用Object）。<br>例如以上的泛型类擦除类型后的原始类型：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> Object firtsFiled;</div><div class="line">    <span class="keyword">public</span> Object secondFiled;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirtsFiled</span><span class="params">(Object data)</span></span>&#123;</div><div class="line">        firtsFiled = data;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSecondFiled</span><span class="params">(Object data)</span></span>&#123;</div><div class="line">        secondFiled = data;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getFirtsFiled</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> firtsFiled;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getSecondFiled</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> secondFiled;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getStaticData</span><span class="params">(Object data)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> data;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>所以，不能存在如此两个方法，编译器会提示错误<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFirtsFiled</span><span class="params">(T a)</span></span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="string">"1"</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getFirtsFiled</span><span class="params">(Object w)</span></span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="string">"1"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>通配符类型</strong><br>在泛型操作中进行参数传递时泛型类型必须匹配才能传递，使用通配符来设置传递参数的类型<br>例子，其中Man是Peple的子类，不必关心实现：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubClass</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(ClassTest&lt;Peple&gt; p)</span></span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(ClassTest&lt;? extends Peple&gt; p )</span></span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        SubClass sub = <span class="keyword">new</span> SubClass();</div><div class="line">        ClassTest&lt;Man&gt; tt = <span class="keyword">new</span> ClassTest&lt;&gt;();</div><div class="line">        <span class="comment">//sub.test(tt);错误</span></div><div class="line">        sub.transfer(tt);</div><div class="line"></div><div class="line">        ClassTest&lt;? extends Peple&gt; tt2 = <span class="keyword">new</span> ClassTest();</div><div class="line">        <span class="comment">//tt2.setFirtsFiled(new Man());错误</span></div><div class="line">        <span class="comment">//tt2.setFirtsFiled(new Peple());错误</span></div><div class="line">        Peple pp =tt2.getSecondFiled();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当调用 <code>sub.test(tt);</code> 时发生错误，我们不能把一个 <code>ClassTest&lt;Man&gt;</code> 传递给这个方法， tt 的类型是 <code>ClassTest&lt;People&gt;</code> ，但定义 <code>public void transfer(ClassTest&lt;? extends Peple&gt; p )</code> 使用通配符后 <code>sub.transfer(tt);</code> 可以正确使用。<br>再看下面的两个错误，使用通配符后set方法和get方法显然为<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setFirtsFiled</span><span class="params">(? extends Peple)</span></span></div><div class="line">? extends Peple <span class="title">getSecondFiled</span><span class="params">()</span></div></pre></td></tr></table></figure></p>
<p>编译器只知道要将 <code>People</code> 的子类型，但未具体指定，所有set方法会报错，而get方法就没这个问题，有点类似于多态的子类对象指定父类引用，返回一个 <code>People</code> 子类型没有问题。</p>
<p><strong>通配符的超类限定</strong><br>有 <code>extends</code> 来匹配子类，当然也有 <code>super</code> 来指定超类型限定，使用的意思刚好相反<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubClass</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(ClassTest&lt;Man&gt; m)</span></span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(ClassTest&lt;? <span class="keyword">super</span> Man&gt; m )</span></span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        SubClass sub = <span class="keyword">new</span> SubClass();</div><div class="line">        ClassTest&lt;Peple&gt; tt = <span class="keyword">new</span> ClassTest&lt;&gt;();</div><div class="line">        <span class="comment">//sub.test(tt);错误</span></div><div class="line">        sub.transfer(tt);</div><div class="line"></div><div class="line">        ClassTest&lt;? <span class="keyword">super</span> Man&gt; tt2 = <span class="keyword">new</span> ClassTest();</div><div class="line">        tt2.setFirtsFiled(<span class="keyword">new</span> Tom());<span class="comment">//Tom继承自Man</span></div><div class="line">        tt2.setFirtsFiled(<span class="keyword">new</span> Man());</div><div class="line">        <span class="comment">//tt2.setFirtsFiled(new Peple());错误</span></div><div class="line">        <span class="comment">//Peple pp = tt2.getSecondFiled();错误</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>transfer</code> 方法允许使用通配符方式传进一个 <code>ClassTest&lt;Peple&gt;</code> ,因为 <code>People</code>  是 <code>Man</code> 的超类。下面的两个错误是因为此时不确定get方法返回的对象类型无法保证，只能把它赋给一个 Object ，而set方法可以使用任意 Man 对象或它的子类型调用它。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SSM框架，基于JavaConfig配置方式，不用xml配置文件]]></title>
      <url>/2017/06/14/SSM%E6%A1%86%E6%9E%B6%EF%BC%8C%E5%9F%BA%E4%BA%8EJavaConfig%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%EF%BC%8C%E4%B8%8D%E7%94%A8xml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>在使用Spring开发时，我们经常会看到各种各样xml配置，过于繁多的xml配置显得复杂烦人。在Spring3之后，Spring支持使用JavaConfig来代替xml配置，这种方式也得到越来越多人的推荐，甚至在Spring Boot的项目中，基本上已经见不到xml的影子了。这里将使用JavaConfig方式对SSM框架进行整合。<br><a id="more"></a><br>一、maven 的pom.xml配置<br>各种jar包的配置如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.open.ssm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></div><div class="line">  </div><div class="line">  	</div><div class="line">  	<span class="comment">&lt;!-- 版本 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>4.3.0.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">jackson.version</span>&gt;</span>2.5.0<span class="tag">&lt;/<span class="name">jackson.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mysql-connector-java.version</span>&gt;</span>5.1.37<span class="tag">&lt;/<span class="name">mysql-connector-java.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">fastjson.version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">fastjson.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">slf4j.version</span>&gt;</span>1.7.12<span class="tag">&lt;/<span class="name">slf4j.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commons-io.version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">commons-io.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commons-fileupload.version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">commons-fileupload.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commons-collections.version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">commons-collections.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commons-lang3.version</span>&gt;</span>3.3.2<span class="tag">&lt;/<span class="name">commons-lang3.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commons-codec.version</span>&gt;</span>1.10<span class="tag">&lt;/<span class="name">commons-codec.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">javax.servlet-api.version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">javax.servlet-api.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.0.16<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.4.0<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mybatis-spring.version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">mybatis-spring.version</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 依赖管理 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line">   	</div><div class="line">	   	<span class="comment">&lt;!-- 单元测试 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!-- json --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;fastjson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!-- spring --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!-- jdbc驱动包  --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql-connector-java.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!--common 组件 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons-io.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons-fileupload.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons-collections.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons-lang3.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;commons-codec.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!-- 日志处理 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="comment">&lt;!-- servlet --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- javax.servlet相关 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;javax.servlet-api.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis-spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">		</div><div class="line">  	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div><div class="line">  	</div><div class="line">	<span class="tag">&lt;<span class="name">build</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">finalName</span>&gt;</span>ssm-demo<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">			</div><div class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">failOnMissingWebXml</span>&gt;</span>false<span class="tag">&lt;/<span class="name">failOnMissingWebXml</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">port</span>&gt;</span>8088<span class="tag">&lt;/<span class="name">port</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">			</div><div class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>二、SpringMvc的配置<br>首先创建一个初始化类，继承 <code>AbstractAnnotationConfigDispatcherServletInitializer</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.config;</div><div class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.support.AbstractAnnotationConfigDispatcherServletInitializer;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: SpittrWebAppInitializer.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 前端控制器配置&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月12日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebAppInitializer</span> <span class="keyword">extends</span> <span class="title">AbstractAnnotationConfigDispatcherServletInitializer</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger LOG = Logger.getLogger(WebAppInitializer.class);</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</div><div class="line">		LOG.info(<span class="string">"------root配置类初始化------"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Class&lt;?&gt;[] &#123; RootConfig.class &#125;;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</div><div class="line">		LOG.info(<span class="string">"------web配置类初始化------"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Class&lt;?&gt;[] &#123; WebConfig.class &#125;;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="keyword">protected</span> String[] getServletMappings() &#123;</div><div class="line">		LOG.info(<span class="string">"------映射根路径初始化------"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> String[]&#123; <span class="string">"/"</span> &#125;;<span class="comment">//请求路径映射，根路径</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里需要实现三个方法，可以其中两个方法看到需要两个配置类 <code>RootConfig</code> 和 <code>WebConfig</code> , <code>getServletMappings</code> 方法处理路径映射到 “/”，表示默认的Servlet，会处理进入应用的所有请求。</p>
<p>其中 <code>WebConfig</code> 用于定义 <code>DispatcherServlet</code> 加载应用上下文的配置，主要包含一些web组件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.web.multipart.commons.CommonsMultipartResolver;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.ViewResolver;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.DefaultServletHandlerConfigurer;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.EnableWebMvc;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.view.InternalResourceViewResolver;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: WebConfig.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 配置类，用于定义DispatcherServlet上下文的bean&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月12日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@EnableWebMvc</span></div><div class="line"><span class="meta">@ComponentScan</span>( <span class="string">"com.open.ssm.controller"</span> )</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="meta">@Bean</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ViewResolver <span class="title">viewResolver</span><span class="params">()</span></span>&#123;</div><div class="line">		InternalResourceViewResolver resolver = <span class="keyword">new</span> InternalResourceViewResolver();</div><div class="line">		resolver.setPrefix(<span class="string">"/WEB-INF/view/"</span>);</div><div class="line">		resolver.setSuffix(<span class="string">".jsp"</span>);</div><div class="line">		<span class="keyword">return</span> resolver;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">//文件上传，bean必须写name属性且必须为multipartResolver，不然取不到文件对象，别问我为什么，我也唔知</span></div><div class="line">	<span class="meta">@Bean</span>(name=<span class="string">"multipartResolver"</span>)</div><div class="line">	<span class="function"><span class="keyword">protected</span> CommonsMultipartResolver <span class="title">MultipartResolver</span><span class="params">()</span> </span>&#123;</div><div class="line">		CommonsMultipartResolver multipartResolver = <span class="keyword">new</span> CommonsMultipartResolver();</div><div class="line">		<span class="comment">//multipartResolver.setUploadTempDir(new FileSystemResource("/tmp"));//可不设置</span></div><div class="line">		multipartResolver.setMaxUploadSize(<span class="number">2097152</span>);<span class="comment">//2M</span></div><div class="line">		multipartResolver.setMaxInMemorySize(<span class="number">0</span>);</div><div class="line">		multipartResolver.setDefaultEncoding(<span class="string">"UTF-8"</span>);</div><div class="line">		<span class="keyword">return</span> multipartResolver;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">   <span class="comment">//静态资源的处理</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> </span>&#123;</div><div class="line">        configurer.enable();</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而 <code>RootConfig</code> 类主要配置持久层的一些东西，包括数据库、Mybatis框架，事务之类的东西。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.config;</div><div class="line"><span class="keyword">import</span> org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Import;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: RootConfig.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 配置类，用于管理ContextLoadListener创建的上下文的bean&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月12日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@ComponentScan</span>(basePackages=&#123; <span class="string">"com.open.ssm.config"</span>, <span class="string">"com.open.ssm.dao"</span>, <span class="string">"com.open.ssm.service"</span> &#125;)</div><div class="line"><span class="meta">@Import</span>(DruidDataSourceConfig.class)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RootConfig</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="meta">@Bean</span></div><div class="line">	<span class="function"><span class="keyword">public</span> BeanNameAutoProxyCreator <span class="title">proxycreate</span><span class="params">()</span></span>&#123;</div><div class="line">    	BeanNameAutoProxyCreator proxycreate = <span class="keyword">new</span> BeanNameAutoProxyCreator();</div><div class="line">    	proxycreate.setProxyTargetClass(<span class="keyword">true</span>);</div><div class="line">    	proxycreate.setBeanNames(<span class="string">"*ServiceImpl"</span>);</div><div class="line">    	proxycreate.setInterceptorNames(<span class="string">"transactionInterceptor"</span>);</div><div class="line">    	<span class="keyword">return</span> proxycreate;</div><div class="line">    &#125;	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>三、数据库与Mybatis相关配置<br>这里的数据源使用的是阿里的Druid，接上面 <code>RootConfig</code> 类，可以看到 <code>RootConfig</code> 类又 import 导入了一个配置类 <code>DruidDataSourceConfig</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.sql.DataSource;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</div><div class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</div><div class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</div><div class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</div><div class="line"><span class="keyword">import</span> org.springframework.core.io.support.ResourcePatternResolver;</div><div class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</div><div class="line"><span class="keyword">import</span> org.springframework.transaction.interceptor.TransactionInterceptor;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: DruidDataSourceConfig.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 数据源属性配置&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月12日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:/jdbc.properties"</span>)</div><div class="line"><span class="meta">@MapperScan</span>(basePackages=<span class="string">"com.open.ssm.dao"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidDataSourceConfig</span></span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger LOG = Logger.getLogger(DruidDataSourceConfig.class);</div><div class="line">	</div><div class="line">	<span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.url&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String dbUrl;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.username&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String username;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.password&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String password;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.driverClassName&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String driverClassName;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.initialSize&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> initialSize;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.minIdle&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> minIdle;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxActive&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxActive;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxWait&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxWait;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.timeBetweenEvictionRunsMillis&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> timeBetweenEvictionRunsMillis;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.minEvictableIdleTimeMillis&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> minEvictableIdleTimeMillis;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.validationQuery&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String validationQuery;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testWhileIdle&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testWhileIdle;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testOnBorrow&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnBorrow;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testOnReturn&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnReturn;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.poolPreparedStatements&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> poolPreparedStatements;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxPoolPreparedStatementPerConnectionSize&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxPoolPreparedStatementPerConnectionSize;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.filters&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String filters;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"&#123;spring.datasource.connectionProperties&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String connectionProperties;  </div><div class="line">      </div><div class="line">    <span class="meta">@Bean</span>     <span class="comment">//声明其为Bean实例  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span></span>&#123;</div><div class="line">    	LOG.info(<span class="string">"Initialize the data source..."</span>);</div><div class="line">        DruidDataSource datasource = <span class="keyword">new</span> DruidDataSource();  </div><div class="line">          </div><div class="line">        datasource.setUrl(<span class="keyword">this</span>.dbUrl);  </div><div class="line">        datasource.setUsername(username);  </div><div class="line">        datasource.setPassword(password);  </div><div class="line">        datasource.setDriverClassName(driverClassName);  </div><div class="line">          </div><div class="line">        <span class="comment">//configuration  </span></div><div class="line">        datasource.setInitialSize(initialSize);  </div><div class="line">        datasource.setMinIdle(minIdle);  </div><div class="line">        datasource.setMaxActive(maxActive);  </div><div class="line">        datasource.setMaxWait(maxWait);  </div><div class="line">        datasource.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);  </div><div class="line">        datasource.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);  </div><div class="line">        datasource.setValidationQuery(validationQuery);  </div><div class="line">        datasource.setTestWhileIdle(testWhileIdle);  </div><div class="line">        datasource.setTestOnBorrow(testOnBorrow);  </div><div class="line">        datasource.setTestOnReturn(testOnReturn);  </div><div class="line">        datasource.setPoolPreparedStatements(poolPreparedStatements);  </div><div class="line">        datasource.setMaxPoolPreparedStatementPerConnectionSize(maxPoolPreparedStatementPerConnectionSize);  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            datasource.setFilters(filters);  </div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">        	LOG.error(<span class="string">"druid configuration initialization filter"</span>, e);  </div><div class="line">        &#125;  </div><div class="line">        datasource.setConnectionProperties(connectionProperties);  </div><div class="line">        <span class="keyword">return</span> datasource;  </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">    //JdbcTemplate的配置</div><div class="line">    @Bean</div><div class="line">    public JdbcTemplate jdbcTemplate()&#123;</div><div class="line">    	JdbcTemplate jdbcTemplate = new JdbcTemplate();</div><div class="line">    	jdbcTemplate.setDataSource(dataSource());</div><div class="line">    	return jdbcTemplate;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    @Bean</div><div class="line">    public NamedParameterJdbcTemplate namedParameterJdbcTemplate()&#123;</div><div class="line">    	NamedParameterJdbcTemplate namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(dataSource());</div><div class="line">    	return namedParameterJdbcTemplate;</div><div class="line">    &#125;*/</div><div class="line">    </div><div class="line">    <span class="comment">//mybatis的配置</span></div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactoryBean <span class="title">sqlSessionFactoryBean</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</div><div class="line">    	ResourcePatternResolver resourcePatternResolver = <span class="keyword">new</span> PathMatchingResourcePatternResolver();  </div><div class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();  </div><div class="line">        sqlSessionFactoryBean.setDataSource(dataSource());  </div><div class="line">        sqlSessionFactoryBean.setMapperLocations(resourcePatternResolver.getResources(<span class="string">"classpath*:mappers/*.xml"</span>));</div><div class="line">        sqlSessionFactoryBean.setTypeAliasesPackage(<span class="string">"com.open.ssm.model"</span>);<span class="comment">//别名，让*Mpper.xml实体类映射可以不加上具体包名</span></div><div class="line">        <span class="keyword">return</span> sqlSessionFactoryBean;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Bean</span>(name = <span class="string">"transactionManager"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> DataSourceTransactionManager <span class="title">dataSourceTransactionManager</span><span class="params">()</span></span>&#123;</div><div class="line">    	DataSourceTransactionManager dataSourceTransactionManager = <span class="keyword">new</span> DataSourceTransactionManager();</div><div class="line">    	dataSourceTransactionManager.setDataSource(dataSource());</div><div class="line">    	<span class="keyword">return</span> dataSourceTransactionManager;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Bean</span>(name=<span class="string">"transactionInterceptor"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> TransactionInterceptor <span class="title">interceptor</span><span class="params">()</span></span>&#123;</div><div class="line">    	TransactionInterceptor interceptor = <span class="keyword">new</span> TransactionInterceptor();</div><div class="line">    	interceptor.setTransactionManager(dataSourceTransactionManager());</div><div class="line">    	</div><div class="line">    	Properties transactionAttributes = <span class="keyword">new</span> Properties();</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"save*"</span>, <span class="string">"PROPAGATION_REQUIRED"</span>);</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"del*"</span>, <span class="string">"PROPAGATION_REQUIRED"</span>);</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"update*"</span>, <span class="string">"PROPAGATION_REQUIRED"</span>);</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"get*"</span>, <span class="string">"PROPAGATION_REQUIRED,readOnly"</span>);</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"find*"</span>, <span class="string">"PROPAGATION_REQUIRED,readOnly"</span>);</div><div class="line">    	transactionAttributes.setProperty(<span class="string">"*"</span>, <span class="string">"PROPAGATION_REQUIRED"</span>);</div><div class="line">    	</div><div class="line">    	interceptor.setTransactionAttributes(transactionAttributes);</div><div class="line">    	<span class="keyword">return</span> interceptor;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">    //放这里会导致@value注解获取不到配置的值，移到RootConfig</div><div class="line">    @Bean</div><div class="line">    public BeanNameAutoProxyCreator proxycreate()&#123;</div><div class="line">    	BeanNameAutoProxyCreator proxycreate = new BeanNameAutoProxyCreator();</div><div class="line">    	proxycreate.setProxyTargetClass(true);</div><div class="line">    	proxycreate.setBeanNames("*ServiceImpl");</div><div class="line">    	proxycreate.setInterceptorNames("transactionInterceptor");</div><div class="line">    	return proxycreate;</div><div class="line">    &#125;*/</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>数据库连接信息文件 jdbc.properties 相关内容<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">spring.datasource.type=com.alibaba.druid.pool.DruidDataSource</div><div class="line">spring.datasource.driverClassName=com.mysql.jdbc.Driver</div><div class="line">spring.datasource.url=jdbc:mysql://localhost:3306/blog</div><div class="line">spring.datasource.username=root</div><div class="line">spring.datasource.password=root</div><div class="line"></div><div class="line">#连接池配置</div><div class="line">spring.datasource.initialSize=5</div><div class="line">spring.datasource.minIdle=5</div><div class="line">spring.datasource.maxActive=20</div><div class="line">#连接等待超时时间</div><div class="line">spring.datasource.maxWait=60000</div><div class="line">#配置隔多久进行一次检测(检测可以关闭的空闲连接)</div><div class="line">spring.datasource.timeBetweenEvictionRunsMillis=60000</div><div class="line">#配置连接在池中的最小生存时间</div><div class="line">spring.datasource.minEvictableIdleTimeMillis=300000</div><div class="line">spring.datasource.validationQuery=SELECT 1 FROM DUAL</div><div class="line">spring.datasource.testWhileIdle=true</div><div class="line">spring.datasource.testOnBorrow=false</div><div class="line">spring.datasource.testOnReturn=false</div><div class="line"># 打开PSCache，并且指定每个连接上PSCache的大小</div><div class="line">spring.datasource.poolPreparedStatements=true</div><div class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize=20</div><div class="line"># 配置监控统计拦截的filters，去掉后监控界面sql无法统计，'wall'用于防火墙</div><div class="line">spring.datasource.filters=stat,wall,log4j</div><div class="line"># 通过connectProperties属性来打开mergeSql功能；慢SQL记录</div><div class="line">spring.datasource.connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</div></pre></td></tr></table></figure></p>
<p>这里数据库的事务配置方式有三种：</p>
<ul>
<li>第一种最简单的方式，在 <code>RootConfig</code> 加上 @EnableTransactionManagement 注解，再加上配置 DataSourceTransactionManager 的bean，就可以在service实现层使用 @Transactional 注解为方法手动加上事务，并且指定的传播属性等等，但老是要手动加 @Transactional 注解实在麻烦</li>
<li>第二种就是文中使用的方式，使用 <code>BeanNameAutoProxyCreator</code> 拦截代理方式，先创建一个 <code>TransactionInterceptor</code> bean，配置好事务传播等属性，在由 <code>BeanNameAutoProxyCreator</code> 进行事务代理。这里有个问题就是 <code>BeanNameAutoProxyCreator</code> 放在 <code>RootConfig</code> 中居然会导致 @value注解获取不到配置文件的值，而是键名字，将它直接放到 <code>RootConfig</code> 下就没事了</li>
<li>第三种是采用aop切面事务， @EnableAspectJAutoProxy 开启切面自动代理，这里写一个切面相关类 <code>AspectConfig</code> ，然后在 使用 @Import(AspectConfig.class) 导进配置就行，由于 <code>&lt;tx:</code> 开头的这种标签实在不知如何用java方式表示，在 stackoverflow 看到一个答案讲还是只能写一个xml文件，使用 @ImportResource(“classpath:/aop-config.xml”) 这种方式进行配置，具体实现如下(三种方式根据需要去掉无关代码，免得出冲突)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.config;</div><div class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</div><div class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</div><div class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.ImportResource;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: AspectConfig.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 切面事务&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月12日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@Aspect</span></div><div class="line"><span class="meta">@Component</span></div><div class="line"><span class="meta">@ImportResource</span>(<span class="string">"classpath:/aop-config.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AspectConfig</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="meta">@Pointcut</span>(<span class="string">"execution(* com.open.ssm.service.*.*(..))"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">serviceAnnotatedClass</span><span class="params">()</span> </span>&#123;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>四、Druid监控<br>Druid监控这里使用最简单的方式，就一个servlet和一个filter<br>servlet 继承自 StatViewServlet<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.web;</div><div class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</div><div class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</div><div class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.StatViewServlet;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: DruidServlMonitor.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: Druid Servlet&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年6月14日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@WebServlet</span>(name=<span class="string">"druidMonitor"</span>, urlPatterns=<span class="string">"/druid/*"</span>, initParams=&#123;</div><div class="line">		<span class="meta">@WebInitParam</span>(name=<span class="string">"allow"</span>, value=<span class="string">"127.0.0.1"</span>),</div><div class="line">		<span class="meta">@WebInitParam</span>(name=<span class="string">"loginUsername"</span>, value=<span class="string">"admin"</span>),</div><div class="line">		<span class="meta">@WebInitParam</span>(name=<span class="string">"loginPassword"</span>, value=<span class="string">"123123"</span>),</div><div class="line">		<span class="meta">@WebInitParam</span>(name=<span class="string">"resetEnable"</span>, value=<span class="string">"false"</span>)</div><div class="line">&#125;)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidServletMonitor</span> <span class="keyword">extends</span> <span class="title">StatViewServlet</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * </div><div class="line">	 */</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>filter继承自 WebStatFilter<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.open.ssm.web;</div><div class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</div><div class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</div><div class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.WebStatFilter;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Servlet Filter implementation class DruidStatFilter</div><div class="line"> */</div><div class="line"><span class="meta">@WebFilter</span>(filterName=<span class="string">"druidFilter"</span>, urlPatterns=<span class="string">"/*"</span>, initParams=&#123;</div><div class="line">		<span class="meta">@WebInitParam</span>(name=<span class="string">"exclusions"</span>, value=<span class="string">"*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"</span>)</div><div class="line">&#125;)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidStatFilter</span> <span class="keyword">extends</span> <span class="title">WebStatFilter</span> </span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>浏览器直接输入ip+端口/druid，这里在本地是 <a href="http://localhost:8088/druid" target="_blank" rel="external">http://localhost:8088/druid</a> 进入登录页面，输入配置的用户名密码就可以进入监控页面了。</p>
<p>本文我写了一个demo，放在 <a href="https://github.com/shen28/ssm-demo" target="_blank" rel="external">https://github.com/shen28/ssm-demo</a> ，后续有时间会加上其他的一些东西。</p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boot 普通类调用Bean对象的一种方式]]></title>
      <url>/2017/06/08/Spring%20Boot%20%E6%99%AE%E9%80%9A%E7%B1%BB%E8%B0%83%E7%94%A8Bean%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>有时我们有一些特殊的需要，可能要在一个不被Spring管理的普通类中去调用Spring管理的bean对象的一些方法，比如一般SpringMVC工程在controller中通过<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Autowired</span></div><div class="line"><span class="keyword">private</span> TestService testService;</div></pre></td></tr></table></figure></p>
<p>注入TestService 接口就可以调用此接口实现类的实现的方法。<a id="more"></a><br>但在一般类中显然不可以这么做，注入的 TestService  将会报空指针异常，你无法拿到这个bean，在一般的ssm工程中我们可以通过xml配置把普通类设置成一个bean对象，那么 TestService 就有效了， 或者使用 <code>ApplicationContext</code> 直接读取xml配置中的bean也可以拿到 TestService。`</p>
<p>Spring Boot 已经摒弃了各种繁琐的xml配置，当然就不再使用xml配置的方式，之前在网上看到一种很简便的方式，但现在又找不到链接了，这里做下记录。</p>
<p>在普通类中定义 <code>ApplicationContext</code> 静态变量和set方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext applicationContext;<span class="comment">//启动类set入，调用下面set方法</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext context)</span> </span>&#123;</div><div class="line">	applicationContext = context;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在启动类中，启动时事实已经生成 ConfigurableApplicationContext 对象， ConfigurableApplicationContext 是 ApplicationContext 接口的实现，这里直接传到普通类的 setApplicationContext 方法就行了<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="meta">@ServletComponentScan</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WxApplication</span> <span class="keyword">implements</span> <span class="title">EmbeddedServletContainerCustomizer</span></span>&#123;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		ConfigurableApplicationContext applicationContext = SpringApplication.run(WxApplication.class, args);</div><div class="line">		TestClass.setApplicationContext(applicationContext);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>由于是静态变量，类加载时 applicationContext 已经存在，就可获取到 TestService 了，唯一不好就是静态变量在服务器启动后将一直存在<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext applicationContext;<span class="comment">//启动类set入，调用下面set方法</span></div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext context)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		applicationContext = context;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getBeanTest</span><span class="params">()</span></span>&#123;</div><div class="line">		TestService testService  = (TestService)applicationContext.getBean(TestService.class);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>补充</strong>：<br>在普通 Spring 工程在启动的时候都会通过 <code>org.springframework.web.context.ContextLoaderListener</code> 监听器从加载系统资源并管理bean， Spring 提供的 <code>WebApplicationContextUtils</code> 工具类能在请求时获取到运行时工程的bean，如果看源码就可以知道监听器执行时与 <code>WebApplicationContextUtils</code> 类的关联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//封装一下，类的class和请求request为必要参数</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(Class&lt;? extends Object&gt; cla,HttpServletRequest request)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(request == <span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (T)WebApplicationContextUtils.getRequiredWebApplicationContext(request.getServletContext()).getBean(cla);<span class="comment">//getBean参数可为bean类的.class或直接是bean的Id</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">//这样获取bean</span></div><div class="line">TestService testService= (TestService)getBean(TestService.class, request);</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boot 过滤器、监听器和拦截器使用]]></title>
      <url>/2017/06/07/Spring%20Boot%20%E8%BF%87%E6%BB%A4%E5%99%A8%E3%80%81%E7%9B%91%E5%90%AC%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>1、过滤器和监听器<br>Spring Boot中对于过滤器和监听器的使用跟一般web工程中使用方式没什么不同，使用注解方式就可以快速创建，只是要使用注解方式需要在Application类加上 <code>@ServletComponentScan</code> 注解表明开启servlet的注解<br>创建一个监听器<a id="more"></a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@WebListener</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstListener</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger LOG = LoggerFactory.getLogger(FirstListener.class);</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</div><div class="line">		LOG.info(<span class="string">"FirstListener 初始化..."</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</div><div class="line">		LOG.info(<span class="string">"FirstListener 销毁..."</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>创建一个过滤器，过滤test和hello下文的所有路径<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@WebFilter</span>(filterName=<span class="string">"firstFilter"</span>, urlPatterns = &#123;</div><div class="line">		<span class="string">"/test/*"</span>,</div><div class="line">		<span class="string">"/hello/*"</span></div><div class="line">		&#125;)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirsrtFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger LOG = LoggerFactory.getLogger(FirsrtFilter.class);</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span></div><div class="line">			<span class="keyword">throws</span> IOException, ServletException &#123;</div><div class="line">		HttpServletRequest req = (HttpServletRequest) request;</div><div class="line">		String requestURI = req.getRequestURI();</div><div class="line">		LOG.info(<span class="string">"过滤到的请求---&gt;"</span>+requestURI);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行 application 类可看到日志输出<br><code>2017-06-08 17:14:55.252  INFO 7552 --- [ost-startStop-1] com.fyft.test.web.FirstListener          : FirstListener 初始化...</code></p>
<p>写一个请求路径为 <code>test</code> 的 controller 并访问，可看到<br><code>2017-06-08 17:15:50.799  INFO 7552 --- [nio-8003-exec-1] com.fyft.test.web.FirsrtFilter           : 过滤到的请求---&gt;/test</code></p>
<p>2、拦截器</p>
<p>实现 <code>HandlerInterceptor</code> 接口创建一个拦截器类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, Exception arg3)</span></span></div><div class="line">			<span class="keyword">throws</span> Exception &#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="comment">//在整个请求结束之后被调用，也就是在DispatcherServlet 渲染了对应的视图之后执行，主要是用于进行资源清理工作</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, ModelAndView arg3)</span></span></div><div class="line">			<span class="keyword">throws</span> Exception &#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="comment">//请求处理之后进行调用，但是在视图被渲染之前，即Controller方法调用之后</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object object)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="comment">//controller方法调用之前</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后在初始化配置类中注册拦截器<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWebAppConfigurer</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 添加拦截器</div><div class="line">	 */</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</div><div class="line">		registry.addInterceptor(<span class="keyword">new</span> MyInterceptor()).addPathPatterns(<span class="string">"/*"</span>);</div><div class="line">		<span class="comment">//registry.addInterceptor(new MyInterceptor_copy()).addPathPatterns("/*");//有多个拦截器继续add进去</span></div><div class="line">		<span class="keyword">super</span>.addInterceptors(registry);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里的拦截器只有经过DispatcherServlet 的请求，才会走拦截器链，默认不拦截静态资源，Spring Boot中默认的静态资源路径有 <code>classpath:/META-INF/resources/，classpath:/resources/，classpath:/static/，classpath:/public/</code> ，在拦截器中我们可以处理一些我们需要的业务，比如防xss攻击，在调用controller前对提交内容进行过滤等等。</p>
<p>参考博客 <code>http://blog.csdn.net/catoop/article/details/50501696</code></p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[深圳]]></title>
      <url>/2017/05/28/%E6%B7%B1%E5%9C%B3/</url>
      <content type="html"><![CDATA[<p>深圳北站。<br><img src="\assets\articleImg\shenzhen.jpg" alt="深圳北站"></p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boor配置Druid数据源]]></title>
      <url>/2017/05/18/Spring%20Boor%E9%85%8D%E7%BD%AEDruid%E6%95%B0%E6%8D%AE%E6%BA%90/</url>
      <content type="html"><![CDATA[<p>Druid是阿里巴巴开源平台上的一个项目,整个项目由数据库连接池、插件框架和SQL解析器组成。</p>
<h3 id="添加Druid数据源"><a href="#添加Druid数据源" class="headerlink" title="添加Druid数据源"></a>添加Druid数据源</h3><p>要使用Druid数据源，我们需要在 application.properties 下添加配置信息<a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">#数据库访问配置</div><div class="line">#mysql</div><div class="line">#spring.datasource.type=com.alibaba.druid.pool.DruidDataSource</div><div class="line">#spring.datasource.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">#spring.datasource.url=jdbc:mysql://localhost:3306/blog</div><div class="line">#oracle</div><div class="line">spring.datasource.driverClassName=oracle.jdbc.driver.OracleDriver</div><div class="line">spring.datasource.url=jdbc:oracle:thin:@127.0.0.1:1521:orcl</div><div class="line">spring.datasource.username=system</div><div class="line">spring.datasource.password=123456</div><div class="line"></div><div class="line">#连接池配置</div><div class="line">spring.datasource.initialSize=5</div><div class="line">spring.datasource.minIdle=5</div><div class="line">spring.datasource.maxActive=20</div><div class="line">#连接等待超时时间</div><div class="line">spring.datasource.maxWait=60000</div><div class="line">#配置隔多久进行一次检测(检测可以关闭的空闲连接)</div><div class="line">spring.datasource.timeBetweenEvictionRunsMillis=60000</div><div class="line">#配置连接在池中的最小生存时间</div><div class="line">spring.datasource.minEvictableIdleTimeMillis=300000</div><div class="line">spring.datasource.validationQuery=SELECT 1 FROM DUAL</div><div class="line">spring.datasource.testWhileIdle=true</div><div class="line">spring.datasource.testOnBorrow=false</div><div class="line">spring.datasource.testOnReturn=false</div><div class="line"># 打开PSCache，并且指定每个连接上PSCache的大小</div><div class="line">spring.datasource.poolPreparedStatements=true</div><div class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize=20</div><div class="line"># 配置监控统计拦截的filters，去掉后监控界面sql无法统计，'wall'用于防火墙</div><div class="line">spring.datasource.filters=stat,wall,log4j</div><div class="line"># 通过connectProperties属性来打开mergeSql功能；慢SQL记录</div><div class="line">spring.datasource.connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</div></pre></td></tr></table></figure></p>
<p>上面提供了mysql和oracle两种数据库驱动的配置，由于maven中心仓库不提供oracle驱动，需要到oracle官网自行下载你自己版本需要的oracle数据库驱动，再安装到本地仓库。我这里用的eclipse自带的maven，安装oracle数据库驱动到本地仓库是直接建个文件夹丢进去重命下名的，简单粗暴。</p>
<p>参考：jar包放com/oracle/ojdbc6/10.2.0.1.0 文件夹下，命名ojdbc6-10.2.0.1.0.jar<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;ojdbc6.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>此外，在本版本（1.5.2）的Spring Boot 中，对于上面Druid连接池的配置都不支持，意味着这些配置属性不会生效，所以，需要些一个配置类来读取这些配置并设置到数据源中去</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.fyft.wx.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> javax.sql.DataSource;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Primary;</div><div class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: DruidDataSourceConfig.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: 数据源属性配置&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年5月18日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@Primary</span> <span class="comment">//在同样的DataSource中，首先使用被标注的DataSource</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidDataSourceConfig</span> <span class="keyword">extends</span> <span class="title">DataSourceProperties</span></span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(DruidDataSourceConfig.class);</div><div class="line">	</div><div class="line">	<span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.url&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String dbUrl;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.username&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String username;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.password&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String password;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.driverClassName&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String driverClassName;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.initialSize&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> initialSize;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.minIdle&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> minIdle;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxActive&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxActive;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxWait&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxWait;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.timeBetweenEvictionRunsMillis&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> timeBetweenEvictionRunsMillis;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.minEvictableIdleTimeMillis&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> minEvictableIdleTimeMillis;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.validationQuery&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String validationQuery;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testWhileIdle&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testWhileIdle;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testOnBorrow&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnBorrow;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.testOnReturn&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnReturn;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.poolPreparedStatements&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> poolPreparedStatements;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.maxPoolPreparedStatementPerConnectionSize&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxPoolPreparedStatementPerConnectionSize;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.datasource.filters&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String filters;  </div><div class="line">      </div><div class="line">    <span class="meta">@Value</span>(<span class="string">"&#123;spring.datasource.connectionProperties&#125;"</span>)  </div><div class="line">    <span class="keyword">private</span> String connectionProperties;  </div><div class="line">      </div><div class="line">    <span class="meta">@Bean</span>     <span class="comment">//声明其为Bean实例  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span></span>&#123;  </div><div class="line">        DruidDataSource datasource = <span class="keyword">new</span> DruidDataSource();  </div><div class="line">          </div><div class="line">        datasource.setUrl(<span class="keyword">this</span>.dbUrl);  </div><div class="line">        datasource.setUsername(username);  </div><div class="line">        datasource.setPassword(password);  </div><div class="line">        datasource.setDriverClassName(driverClassName);  </div><div class="line">          </div><div class="line">        <span class="comment">//configuration  </span></div><div class="line">        datasource.setInitialSize(initialSize);  </div><div class="line">        datasource.setMinIdle(minIdle);  </div><div class="line">        datasource.setMaxActive(maxActive);  </div><div class="line">        datasource.setMaxWait(maxWait);  </div><div class="line">        datasource.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);  </div><div class="line">        datasource.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);  </div><div class="line">        datasource.setValidationQuery(validationQuery);  </div><div class="line">        datasource.setTestWhileIdle(testWhileIdle);  </div><div class="line">        datasource.setTestOnBorrow(testOnBorrow);  </div><div class="line">        datasource.setTestOnReturn(testOnReturn);  </div><div class="line">        datasource.setPoolPreparedStatements(poolPreparedStatements);  </div><div class="line">        datasource.setMaxPoolPreparedStatementPerConnectionSize(maxPoolPreparedStatementPerConnectionSize);  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            datasource.setFilters(filters);  </div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;  </div><div class="line">            logger.error(<span class="string">"druid configuration initialization filter"</span>, e);  </div><div class="line">        &#125;  </div><div class="line">        datasource.setConnectionProperties(connectionProperties);  </div><div class="line">          </div><div class="line">        <span class="keyword">return</span> datasource;  </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>本段配置参考自 <a href="http://blog.csdn.net/blueheart20/article/details/52384032" target="_blank" rel="external">http://blog.csdn.net/blueheart20/article/details/52384032</a><br>其中 @Primary 注解需要放在类上，不然本类配置还是不会覆盖默认的数据源配置，原作者是放在 <code>public DataSource dataSource()</code> 方法上，会报存在两个配置的错误，估计是Spring Boot版本的差异问题。</p>
<h3 id="配置监控统计功能"><a href="#配置监控统计功能" class="headerlink" title="配置监控统计功能"></a>配置监控统计功能</h3><p>新建一个配置类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.fyft.wx.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletRegistrationBean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.StatViewServlet;</div><div class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.WebStatFilter;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: DruidConfiguration.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: Druid监控配置&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年5月3日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidMonitorConfig</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="comment">/**</span></div><div class="line">     * 注册ServletRegistrationBean</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">registrationBean</span><span class="params">()</span> </span>&#123;</div><div class="line">        ServletRegistrationBean bean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet(), <span class="string">"/druid/*"</span>);</div><div class="line">        <span class="comment">/** 初始化参数配置，initParams**/</span></div><div class="line">        <span class="comment">//白名单</span></div><div class="line">        bean.addInitParameter(<span class="string">"allow"</span>, <span class="string">"127.0.0.1"</span>);<span class="comment">//多个ip逗号隔开</span></div><div class="line">        <span class="comment">//IP黑名单 (存在共同时，deny优先于allow) : 如果满足deny的话提示:Sorry, you are not permitted to view this page.</span></div><div class="line">        <span class="comment">//bean.addInitParameter("deny", "192.168.1.73");</span></div><div class="line">        <span class="comment">//登录查看信息的账号密码.</span></div><div class="line">        bean.addInitParameter(<span class="string">"loginUsername"</span>, <span class="string">"admin"</span>);</div><div class="line">        bean.addInitParameter(<span class="string">"loginPassword"</span>, <span class="string">"123456"</span>);</div><div class="line">        <span class="comment">//是否能够重置数据.</span></div><div class="line">        bean.addInitParameter(<span class="string">"resetEnable"</span>, <span class="string">"false"</span>);</div><div class="line">        <span class="keyword">return</span> bean;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 注册FilterRegistrationBean</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">druidStatFilter</span><span class="params">()</span> </span>&#123;</div><div class="line">        FilterRegistrationBean bean = <span class="keyword">new</span> FilterRegistrationBean(<span class="keyword">new</span> WebStatFilter());</div><div class="line">        <span class="comment">//添加过滤规则.</span></div><div class="line">        bean.addUrlPatterns(<span class="string">"/*"</span>);</div><div class="line">        <span class="comment">//添加不需要忽略的格式信息.</span></div><div class="line">        bean.addInitParameter(<span class="string">"exclusions"</span>,<span class="string">"*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"</span>);</div><div class="line">        <span class="keyword">return</span> bean;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>启动项目后访问 ip:端口/druid 输入配置类设置的账号密码进入监控后台。我们先执行一个数据库操作，可以在sql监控选项卡看到执行的sql<br><img src="http://img.blog.csdn.net/20170518175834838?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>查看数据源选项卡可以看到配置连接池参数也都生效了<br><img src="http://img.blog.csdn.net/20170518175931672?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boot 热部署与日志配置]]></title>
      <url>/2017/05/11/Spring%20Boot%20%E7%83%AD%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p>热部署和日志是开发中常用的功能，Srping Boot同样集成了相应的工具，可以方便地实现这些功能。</p>
<h3 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h3><p>Spring Boot提供了 <code>spring-boot-devtools</code> 模块用于热部署，直接引入就行。<a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>当修改代码重新编译时，工程就会重新启动加载。</p>
<h3 id="日志功能"><a href="#日志功能" class="headerlink" title="日志功能"></a>日志功能</h3><p>当引入 <code>spring-boot-starter-web</code>  时候，Spring Boot已经自动引入 <code>spring-boot-starter-logging</code> ，这里我们使用Logback来实现日志管理。Logback是log4j框架的作者开发的新一代日志框架，它效率更高、能够适应诸多的运行环境，同时天然支持SLF4J。</p>
<p>在spring-boot-starter-xx.RELEASE.jar （xx为版本号）下    <code>org.springframework.boot.logging.logback</code> 包中可看到一个base.xml文件,这是Spring Boot 的logback的默认配置。内容<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"></div><div class="line"><span class="comment">&lt;!--</span></div><div class="line">Base logback configuration provided for compatibility with Spring Boot 1.1</div><div class="line">--&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">included</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">resource</span>=<span class="string">"org/springframework/boot/logging/logback/defaults.xml"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"LOG_FILE"</span> <span class="attr">value</span>=<span class="string">"$&#123;LOG_FILE:-$&#123;LOG_PATH:-$&#123;LOG_TEMP:-$&#123;java.io.tmpdir:-/tmp&#125;&#125;&#125;/spring.log&#125;"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">resource</span>=<span class="string">"org/springframework/boot/logging/logback/console-appender.xml"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">resource</span>=<span class="string">"org/springframework/boot/logging/logback/file-appender.xml"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"INFO"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"CONSOLE"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">root</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">included</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>可以看到日志的输出级别是INFO，输出到文件需要我们东东配置下路径。在application.properties进行配置如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#日志配置</div><div class="line">logging.file=test.log</div><div class="line">logging.level.com.fyft.wx.controller=warn</div></pre></td></tr></table></figure></p>
<p>运行会在工程根目录看到生成的日志文件，把<code>com.fyft.wx.controller</code> 包的日志级别设置为warn了<br>controller下写个测试类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.fyft.wx.controller;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</div><div class="line"></div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger LOG = LoggerFactory.getLogger(IndexController.class);</div><div class="line">	</div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"test"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span> </span>&#123;</div><div class="line">		LOG.info(<span class="string">"a info logger..."</span>);</div><div class="line">		LOG.error(<span class="string">"a error logger..."</span>);</div><div class="line">		<span class="keyword">return</span> <span class="string">"welcome to the FYFT index page.I'm shen."</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>访问本controller，输出（日志级别ALL &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF，所以只输出error的）<br><img src="http://img.blog.csdn.net/20170511174825740?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>如果我们需要更复杂的日志功能，可以自己写一个xml文件来配置，比如输出到控制台使用Spring Boot的默认配置，而输出到文件使用自定义配置。<br>在resources下新建一个logback.xml配置文件并把刚才logging.file的配置删掉，配置如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 继承默认配置 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">resource</span>=<span class="string">"org/springframework/boot/logging/logback/base.xml"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.springframework.web"</span> <span class="attr">level</span>=<span class="string">"WARN"</span>/&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 日志存储路径 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span> <span class="attr">value</span>=<span class="string">"D:\\logs"</span> /&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 文件输出配置 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"FILE"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">File</span>&gt;</span>$&#123;LOG_HOME&#125;\\fyft-wx.log<span class="tag">&lt;/<span class="name">File</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></div><div class="line">	        <span class="comment">&lt;!-- daily rollover 保存历史记录到这个文件夹一日起为后缀 --&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;\\temp\\fyft-wx.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></div><div class="line">		    <span class="comment">&lt;!-- keep 30 days' worth of history 保存天数--&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></div><div class="line">		    <span class="comment">&lt;!-- 日志大小 --&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>2MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">encoder</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;35&#125; - %msg %n<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></div><div class="line">	    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">appender</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- root节点，配置日志级别，添加输出节点 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"INFO"</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE"</span>&gt;</span><span class="tag">&lt;/<span class="name">appender-ref</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">root</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>如果输出到控制台的日志也需要自定义，就再加上一个 appender 配置，并添加到root节点。需要注意的是继承自 Spring Bootd 配置需要去掉，不然控制台的日志会输出两次（logger输出一次，root输出一次）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </div><div class="line">	<span class="comment">&lt;!-- 去掉继承的配置 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;include resource="org/springframework/boot/logging/logback/base.xml"/&gt;</span></div><div class="line">	&lt;logger name="org.springframework.web" level="WARN"/&gt; --&gt;</div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 日志存储路径 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span> <span class="attr">value</span>=<span class="string">"D:\\logs"</span> /&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 文件输出配置 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"FILE"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">File</span>&gt;</span>$&#123;LOG_HOME&#125;\\fyft-wx.log<span class="tag">&lt;/<span class="name">File</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></div><div class="line">	        <span class="comment">&lt;!-- daily rollover 保存历史记录到这个文件夹一日起为后缀 --&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;\\temp\\fyft-wx.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></div><div class="line">		    <span class="comment">&lt;!-- keep 30 days' worth of history 保存天数--&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></div><div class="line">		    <span class="comment">&lt;!-- 日志大小 --&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>2MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">encoder</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;35&#125; - %msg %n<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></div><div class="line">	    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">appender</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 控制台输出配置 --&gt;</span>   </div><div class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>&gt;</span> </div><div class="line">            <span class="comment">&lt;!--格式化输出：%d表示日期，$&#123;PID&#125; 进程Id， %thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span> </div><div class="line">            <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; $&#123;PID&#125; [%thread] %-5level %logger&#123;35&#125; - %msg %n<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- 此处设置字符集 --&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- root节点，配置日志级别，添加输出节点 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"INFO"</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE"</span>&gt;</span><span class="tag">&lt;/<span class="name">appender-ref</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span>&gt;</span><span class="tag">&lt;/<span class="name">appender-ref</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">root</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
<p>其他更多详细的logback配置可查看官方文档 <a href="https://logback.qos.ch/manual/configuration.html" target="_blank" rel="external">https://logback.qos.ch/manual/configuration.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring Boot入门]]></title>
      <url>/2017/05/10/%E5%88%9B%E5%BB%BASpring%20Boot%E5%B7%A5%E7%A8%8B/</url>
      <content type="html"><![CDATA[<blockquote>
<p>在搭建传统的SpringMVC项目或其他Spring项目的的时候，我们通常都需要写一堆与Spring整合的xml配置文件，过程繁琐复杂不说，而且容易出错。为了简化开发，Spring Boot应运而生。<br>Spring Boot可以创建独立运行的基于Spring的应用，并且大多数时候只需编写少量的配置。能独立运行的原因是Spring Boot项目本身嵌入了Tomcat等其他web容器插件，详细介绍看官网<a href="http://projects.spring.io/spring-boot/。" target="_blank" rel="external">http://projects.spring.io/spring-boot/。</a></p>
</blockquote>
<h3 id="创建一个Spring-Boot-项目"><a href="#创建一个Spring-Boot-项目" class="headerlink" title="创建一个Spring Boot 项目"></a>创建一个Spring Boot 项目</h3><p>1、pom.xml配置<br>(1)基本配置<br>这里使用Maven构建工程，根据官网的推荐，项目可继承于<code>spring-boot-starter-parent</code> 来管理工程。<a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>(2)如果不使用官方依赖<br>实际开发中我们可能想自己创建父工程来管理依赖，例如我们创建聚合工程时有自己的parent工程，那么我们在自己的父工程定义版本号，根据需要引入对应的包。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 版本号 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>1.5.2.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>	</div><div class="line">   		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">	  	  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">		  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">		  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、编写应用入口类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.fyft.test;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> *&lt;p&gt;Title: TestApplication.java&lt;/p&gt;</div><div class="line"> *&lt;p&gt;Description: TODO&lt;/p&gt;</div><div class="line"> *&lt;p&gt;CreateDate: 2017年5月10日&lt;/p&gt;</div><div class="line"> *<span class="doctag">@author</span> shen</div><div class="line"> *<span class="doctag">@version</span> v1.0</div><div class="line"> */</div><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApplication</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		SpringApplication.run(TestApplication.class, args);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>直接执行此主函数项目就启动了，默认的端口是8080，如果需要改变端口可以在此类实现<code>EmbeddedServletContainerCustomizer</code> 接口，这个接口包含内置Servlet容器的一些配置，例如设置访问端口为8003<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApplication</span> <span class="keyword">implements</span> <span class="title">EmbeddedServletContainerCustomizer</span></span>&#123;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		SpringApplication.run(TestApplication.class, args);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(ConfigurableEmbeddedServletContainer config)</span> </span>&#123;</div><div class="line">		config.setPort(<span class="number">8003</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="创建Controller类"><a href="#创建Controller类" class="headerlink" title="创建Controller类"></a>创建Controller类</h3><p>要让Controller被扫描到，必须放在主入口类<code>TestApplication</code> 的同级目录或下级目录，这样才能被扫描到，注解才会生效。<br><img src="http://img.blog.csdn.net/20170510233944665?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>例如这种情况TestController将不会被扫描到，只有controller包的才被扫描到，改下位置就ok了<br><img src="http://img.blog.csdn.net/20170510234440490?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="打包部署启动"><a href="#打包部署启动" class="headerlink" title="打包部署启动"></a>打包部署启动</h3><p>Spring Boot工程直接打成jar包就行了，如果工程是要跑在外部web容器的，也可以打成war包发布，这需要修改一些配置，这里先不做介绍。<br>在eclipse上直接用maven打包就行，输入 <code>clean package</code> 命令，勾上<code>Skip Tests</code> 忽略测试就行。</p>
<p>在dos下cd到jar包目录下执行 <code>java -jar xx.jar</code>  启动工程，出现一个错误<br><img src="http://img.blog.csdn.net/20170510235640048?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>由于maven自身打包生成的目录结构和文件和Spring Boot 需要的有所不同，需要在pom.xml加上一段配置，使用<code>spring-boot-maven-plugin</code> 来打包<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></div><div class="line">	 <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span> </div><div class="line">	 <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>若上面的dos正cd到target目录下，须退出此目录，在打包编译时会删除一次target目录，若不退出将会包无法删除此目录，因为你正打开它。<br>再次执行<code>java -jar</code> 命令启动成功</p>
<p><img src="http://img.blog.csdn.net/20170511003805734?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>Spring Boot的文章是对最近在写一个webapp工程的记录，工程代码放在<a href="https://github.com/shen28/fyft，主要是整合一年来所学的东西，使用Spring" target="_blank" rel="external">https://github.com/shen28/fyft，主要是整合一年来所学的东西，使用Spring</a> Boot构建。刚开坑的，也不知道能写多少东西，刚好最近离职才有时间鼓捣的。</p>
]]></content>
      
        
        <tags>
            
            <tag> web框架 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[eclipse neon版本打开某些javascript文件异常问题]]></title>
      <url>/2017/05/02/eclipse%20neon%E7%89%88%E6%9C%AC%E6%89%93%E5%BC%80%E6%9F%90%E4%BA%9Bjavascript%E6%96%87%E4%BB%B6%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>eclipse neon版本的javascript编辑器无法处理某些异常信息，比如本人在用require js和vue js的时候碰过这种异常<br><code>java.lang.NoSuchMethodError:jdk.nashorn.internal.runtime.ECMAException.getEcmaError()Ljava/lang/Object;</code><br>然后js文件直接就打不开了，最终在stackoverflow找到相关问题，链接<br><a href="http://stackoverflow.com/questions/38089331/eclipse-neon-java-ee-ide-javascript-editor-broken" target="_blank" rel="external">http://stackoverflow.com/questions/38089331/eclipse-neon-java-ee-ide-javascript-editor-broken</a></p>
<p>照回答者意思是javascript开发工具没法解析某些特殊语法的js代码；<br>另一个回答是说新版本的jdk已经解决这个问题，尝试卸了jdk（一直用的1.8.0_05版），装上最新版本的（目前是1.8.0_131版），问题解决。（仅供参考）</p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[多线程]]></title>
      <url>/2017/05/01/%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<blockquote>
<p>在编程中，多线程的意思是某个程序同时多个任务，这样的每一个任务则称为一个线程。线程这部分涉及的知识非常多，在实际开发的应用也是非常重要，这里将介绍基本的部分。</p>
</blockquote>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>线程：操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中实际运作单位。<br>进程：计算机中已运行程序的实体。进程本身不会运行，是线程的容器。<a id="more"></a><br>并行与并发：</p>
<ul>
<li>并行：多个cpu实例或者多台机器同时执行一段处理逻辑，是真正的同时。</li>
<li>并发：通过cpu调度算法，让用户看上去同时执行，实际上从cpu操作层面不是真正的同时。<a href="http://www.cnblogs.com/wxd0108/p/5479442.html" target="_blank">[1]</a></li>
</ul>
<h3 id="实现多线程的几种基本方式"><a href="#实现多线程的几种基本方式" class="headerlink" title="实现多线程的几种基本方式"></a>实现多线程的几种基本方式</h3><p>1、继承Thread类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Test02</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">			System.out.println(name + i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		Test02 test1 = <span class="keyword">new</span> Test02(<span class="string">"one--&gt;"</span>);</div><div class="line">		Test02 test2 = <span class="keyword">new</span> Test02(<span class="string">"two--&gt;"</span>);</div><div class="line">		test1.start();</div><div class="line">		test2.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2、实现Runnable接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test01</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Test01</span><span class="params">(String name)</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">			System.out.println(name+<span class="string">"---&gt;"</span>+i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Test01 test1 = <span class="keyword">new</span> Test01(<span class="string">"one"</span>);</div><div class="line">		Test01 test2 = <span class="keyword">new</span> Test01(<span class="string">"two"</span>);</div><div class="line"></div><div class="line">		Thread thread1 = <span class="keyword">new</span> Thread(test1);<span class="comment">//使用thread类执行start方法</span></div><div class="line">		Thread thread2 = <span class="keyword">new</span> Thread(test2);</div><div class="line">		thread1.start();</div><div class="line">		thread2.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3、使用Callable和Future接口创建线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">Integer</span>&gt;</span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">			System.out.println(Thread.currentThread().getName()+<span class="string">"---&gt;"</span>+i);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		</div><div class="line">		Test03 t1 = <span class="keyword">new</span> Test03();</div><div class="line">		Test03 t2 = <span class="keyword">new</span> Test03();</div><div class="line">		FutureTask&lt;Integer&gt; task1 = <span class="keyword">new</span> FutureTask&lt;&gt;(t1);</div><div class="line">		FutureTask&lt;Integer&gt; task2 = <span class="keyword">new</span> FutureTask&lt;&gt;(t2);</div><div class="line">		<span class="keyword">new</span> Thread(task1, <span class="string">"新建线程1"</span>).start();</div><div class="line">		<span class="keyword">new</span> Thread(task2, <span class="string">"新建线程2"</span>).start();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="线程状态"><a href="#线程状态" class="headerlink" title="线程状态"></a>线程状态</h3><p>使用<code>getState()</code>方法可获取当前线程的状态(枚举类型)，各种状态如下：</p>
<ul>
<li>New（新生)<br>当new一个新的线程时，线程还没开始运行时，状态是new<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Thread thread = <span class="keyword">new</span> Thread();</div><div class="line">		System.out.println(thread.getState());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出<br><code>NEW</code></p>
<ul>
<li>Runnable（可运行）<br>线程调用start执行时<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">		            System.out.println(<span class="string">"i is "</span>+i);</div><div class="line">		        &#125;</div><div class="line">		    &#125;</div><div class="line">		&#125;);</div><div class="line">		thread.start();</div><div class="line">		System.out.println(thread.getState());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出<br><code>RUNNABLE</code><br><code>i is 0</code><br><code>i is 1</code><br>…<br><code>i is 99</code></p>
<ul>
<li>Blocked（被阻塞）<br>当一个线程试图获取一个内部的对象锁（而不是java.util.concurrent库中的锁），而该锁被其他线程持有，则该线程进入阻塞状态。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">    <span class="keyword">final</span> Object lock = <span class="keyword">new</span> Object();</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Example</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</div><div class="line">        <span class="keyword">private</span> String name;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Example</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        	<span class="comment">//同步代码块</span></div><div class="line">            <span class="keyword">synchronized</span> (lock) &#123;</div><div class="line">            	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">                    System.out.println(name+<span class="string">": i is "</span>+i);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Example example1 = <span class="keyword">new</span> Test().new Example(<span class="string">"test1"</span>);</div><div class="line">        Example example2 = <span class="keyword">new</span> Test().new Example(<span class="string">"test2"</span>);</div><div class="line">        Thread thread1 = <span class="keyword">new</span> Thread(example1);</div><div class="line">        Thread thread2 = <span class="keyword">new</span> Thread(example2);</div><div class="line">        thread1.start();</div><div class="line">        thread2.start();</div><div class="line">        System.out.println(thread1.getState());</div><div class="line">        System.out.println(thread2.getState());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出<br><code>RUNNABLE</code><br><code>test1: i is 0</code><br><code>test2: i is 0</code><br><code>test1: i is 1</code><br><code>BLOCKED</code><br><code>test1: i is 2</code><br>…</p>
<ul>
<li>Waiting（等待）<br>等待状态，释放自身的锁进入Waiting状态并加入线程等待队列<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">testMethod</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">this</span>.wait();</div><div class="line">            System.out.println(<span class="string">"waiting closed."</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		Thread thread1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				<span class="keyword">new</span> Test().testMethod();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		thread1.start();</div><div class="line">		Thread.sleep(<span class="number">10</span>);<span class="comment">//主线程休眠，转而去执行子进程</span></div><div class="line">		System.out.println(thread1.getState());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出<br><code>WAITING</code><br>waiting closed并不会输出</p>
<ul>
<li><p>Timed waiting（计时等待）<br>在<code>this.wait();</code>加上等待时间就会进入计时等待状态，例如<code>this.wait(3000);</code>等待三秒输出内容<br><code>TIMED_WAITING</code><br><code>waiting closed.</code></p>
</li>
<li><p>Terminated（被终止）<br>run方法执行结束线程终止</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		        System.out.println(<span class="string">"run success"</span>);</div><div class="line">		    &#125;</div><div class="line">		&#125;);</div><div class="line">		thread.start();</div><div class="line">		Thread.sleep(<span class="number">100</span>);</div><div class="line">		System.out.println(thread.getState());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="线程管理"><a href="#线程管理" class="headerlink" title="线程管理"></a>线程管理</h3><ol>
<li><p>sleep方法<br><code>static void sleep(long millis)</code><br>让当前正在运行的线程休眠一段时间<br>sleep是一个静态方法，不要用实例化的线程对象调用，其作用的是当前正在运行的线程。<br><code>Thread.sleep(2000);</code>表示让当前线程休眠2秒，这里的2秒并不是准确的时间段，因为线程是由系统控制，实际时间可能大于2秒。</p>
</li>
<li><p>yield方法<br><code>static void yield()</code><br>暂停当前正在执行的线程，重新进入就绪状态，这也是和sleep方法的区别的地方。如果有其他的可运行线程具有至少与此线程同样高的优先级，那么这些线程接下来会被调度。</p>
</li>
<li><p>join方法<br>合并线程。等待终止指定的线程，让主线程等待子线程结束之后再执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		Thread thread1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">					System.out.println(<span class="string">"one--"</span>+i);</div><div class="line">				&#125;</div><div class="line">		    &#125;</div><div class="line">		&#125;);</div><div class="line">		Thread thread2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				thread1.start();</div><div class="line">				<span class="keyword">try</span> &#123;</div><div class="line">					thread1.join();</div><div class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">					e.printStackTrace();</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</div><div class="line">					System.out.println(<span class="string">"two--"</span>+i);</div><div class="line">				&#125;</div><div class="line">		    &#125;</div><div class="line">		&#125;);</div><div class="line">		thread2.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>thread1在thread2中启动，为thread2子线程，调用join，等待thread1执行结束再执行thread2，相当于把两线程合并了。<br><code>void join(long millis)</code><br>join重载方法带参数，在指定时间段子线程未执行完将重新进入就绪状态，等待cpu调度。</p>
<ol>
<li>notify和notifyAll方法<br>notify方法只唤醒一个等待（对象的）线程并使该线程开始执行。所以如果有多个线程等待一个对象，这个方法只会唤醒其中一个线程，选择哪个线程取决于操作系统对多线程管理的实现。<br>notifyAll 会唤醒所有等待(对象的)线程。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">testMethod</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			System.out.println(<span class="string">"thread start."</span>);</div><div class="line">            <span class="keyword">this</span>.wait();</div><div class="line">            System.out.println(<span class="string">"waiting closed."</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">notifyMethod</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.notifyAll();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		Test test = <span class="keyword">new</span> Test();</div><div class="line">		Thread thread1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				test.testMethod();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line"></div><div class="line">		Thread thread2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				test.notifyMethod();</div><div class="line">				System.out.println(<span class="string">"唤醒线程....."</span>);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		thread1.start();</div><div class="line">		Thread.sleep(<span class="number">1000</span>);</div><div class="line">		System.out.println(thread1.getState());</div><div class="line">		thread2.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>输出<br><code>thread start.</code><br><code>WAITING</code><br><code>唤醒线程.....</code><br><code>waiting closed.</code></p>
<ol>
<li><p>interrupted和isInterrupted<br>Interrupted方法是一个静态方法，它检测当前的线程是否被中断。而且，调用interrupted方法会清除该线程的中断状态。<br>另一方面，isInterrupted方法是一个实例方法，可用来检验是否有线程被中断。调用这个方法不会改变中断状态。</p>
</li>
<li><p>setPriority和getPriority<br><code>void setPriority(int newPriority)</code><br>设置线程的优先级。优先级必须在Thread.MIN_PRIORITY 与Thread.MAX_PRIORITY之<br>间。一般使用Thread.NORM_PRIORITY 优先级。<br><code>final int getPriority()</code><br>获取线程的优先级</p>
</li>
<li><p>结束线程<br>Tread中有stop方法，但改方法已经过时，不推荐使用。要结束线程，可设置标志来实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TestTread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</div><div class="line">		<span class="keyword">private</span> <span class="keyword">boolean</span> flag;</div><div class="line">		<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stopThread</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">this</span>.flag=<span class="keyword">true</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000</span> &amp;&amp; !flag; i++)&#123;</div><div class="line">				System.out.println(<span class="string">"i is "</span>+i);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</div><div class="line">		TestTread test = <span class="keyword">new</span> Test().new TestTread();</div><div class="line">		Thread thread1 = <span class="keyword">new</span> Thread(test);</div><div class="line">		thread1.start();</div><div class="line">		Thread.sleep(<span class="number">3</span>);<span class="comment">//休眠延时</span></div><div class="line">		test.stopThread();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>输出一段i的值之后当执行stopThread方法线程就结束了。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linux下安装Nginx并配置一个图片服务器]]></title>
      <url>/2017/04/21/Linux%E4%B8%8B%E5%AE%89%E8%A3%85Nginx%E5%B9%B6%E9%85%8D%E7%BD%AE%E4%B8%80%E4%B8%AA%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      <content type="html"><![CDATA[<p>首先到Nginx官网下载tar.gz格式的安装包，这里下载的是nginx-1.10.3版本，环境使用centos6的虚拟机</p>
<p>1、将安装包上传，解压，命令tar -xvf nginx-1.10.3.tar.gz；</p>
<p>2、自定义创建一个文件夹作为Nginx安装目录，这里在home下创建nginx文件夹；<br><a id="more"></a><br><img src="http://img.blog.csdn.net/20170421004011580?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>3、在解压的文件夹（nginx-1.10.3）下执行<code>./configure --prefix=/home/nginx</code> 命令。<br>意思即配置安装环境，将会把Nginx安装到/home/nginx下；</p>
<p>若没有gcc，先安装<br><code>yum -y install gcc gcc-c++ autoconf automake make</code></p>
<p>若出现缺少依赖包则先安装依赖包，以下纯净centos mini版碰到的两个依赖包问题<br><img src="http://img.blog.csdn.net/20170421004354876?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>出现上面这个执行 yum -y install pcre-devel 安装依赖，</p>
<p><img src="http://img.blog.csdn.net/20170421004425814?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>出现这个yum install -y zlib-devel 安装依赖，</p>
<p>若还有其他依赖问题，根据缺少的文件提示安装相应的东西；</p>
<p>4、编译：在解压的文件夹下先后执行make 和 make install 命令</p>
<p>5、Nginx默认使用端口是80，这里直接先把Nginx端口改为8088，vi /home/nginx/conf/nginx.conf，修改server的端口，并配置一个图片服务器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#user  nobody;</div><div class="line">worker_processes  1;</div><div class="line"></div><div class="line">#error_log  logs/error.log;</div><div class="line">#error_log  logs/error.log  notice;</div><div class="line">#error_log  logs/error.log  info;</div><div class="line"></div><div class="line">#pid        logs/nginx.pid;</div><div class="line"></div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections  1024;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">http &#123;</div><div class="line">    include       mime.types;</div><div class="line">    default_type  application/octet-stream;</div><div class="line"></div><div class="line">    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</div><div class="line">    #                  '$status $body_bytes_sent "$http_referer" '</div><div class="line">    #                  '"$http_user_agent" "$http_x_forwarded_for"';</div><div class="line"></div><div class="line">    #access_log  logs/access.log  main;</div><div class="line"></div><div class="line">    sendfile        on;</div><div class="line">    #tcp_nopush     on;</div><div class="line"></div><div class="line">    #keepalive_timeout  0;</div><div class="line">    keepalive_timeout  65;</div><div class="line"></div><div class="line">    #gzip  on;</div><div class="line"></div><div class="line">    server &#123;</div><div class="line">        listen       8088;</div><div class="line">        server_name  localhost;</div><div class="line"></div><div class="line">        #charset koi8-r;</div><div class="line"></div><div class="line">        #access_log  logs/host.access.log  main;</div><div class="line">	</div><div class="line">		location ~ .*\.(gif|jpg|jpeg|png)$ &#123;  </div><div class="line">            expires 24h;  </div><div class="line">            root /home/images/;#指定图片存放路径  </div><div class="line">            access_log /home/nginx/logs/images.log;#图片 日志路径  </div><div class="line">            proxy_store on;  </div><div class="line">            proxy_store_access user:rw group:rw all:rw;  </div><div class="line">            proxy_temp_path         /home/images/;#代理临时路径</div><div class="line">            proxy_redirect          off;  </div><div class="line"></div><div class="line">            proxy_set_header        Host 127.0.0.1;  </div><div class="line">            proxy_set_header        X-Real-IP $remote_addr;  </div><div class="line">            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;  </div><div class="line">            client_max_body_size    10m;  </div><div class="line">            client_body_buffer_size 1280k;  </div><div class="line">            proxy_connect_timeout   900;  </div><div class="line">            proxy_send_timeout      900;  </div><div class="line">            proxy_read_timeout      900;  </div><div class="line">            proxy_buffer_size       40k;  </div><div class="line">            proxy_buffers           40 320k;  </div><div class="line">            proxy_busy_buffers_size 640k;  </div><div class="line">            proxy_temp_file_write_size 640k;  </div><div class="line">            if ( !-e $request_filename)  </div><div class="line">            &#123;  </div><div class="line">                 proxy_pass  http://127.0.0.1:8088;#代理访问地址  </div><div class="line">            &#125;  </div><div class="line">        &#125;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">            root   html;</div><div class="line">            index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        #error_page  404              /404.html;</div><div class="line"></div><div class="line">        # redirect server error pages to the static page /50x.html</div><div class="line">        #</div><div class="line">        error_page   500 502 503 504  /50x.html;</div><div class="line">        location = /50x.html &#123;</div><div class="line">            root   html;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</div><div class="line">        #</div><div class="line">        #location ~ \.php$ &#123;</div><div class="line">        #    proxy_pass   http://127.0.0.1;</div><div class="line">        #&#125;</div><div class="line"></div><div class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</div><div class="line">        #</div><div class="line">        #location ~ \.php$ &#123;</div><div class="line">        #    root           html;</div><div class="line">        #    fastcgi_pass   127.0.0.1:9000;</div><div class="line">        #    fastcgi_index  index.php;</div><div class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</div><div class="line">        #    include        fastcgi_params;</div><div class="line">        #&#125;</div><div class="line"></div><div class="line">        # deny access to .htaccess files, if Apache's document root</div><div class="line">        # concurs with nginx's one</div><div class="line">        #</div><div class="line">        #location ~ /\.ht &#123;</div><div class="line">        #    deny  all;</div><div class="line">        #&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</div><div class="line">    #</div><div class="line">    #server &#123;</div><div class="line">    #    listen       8000;</div><div class="line">    #    listen       somename:8080;</div><div class="line">    #    server_name  somename  alias  another.alias;</div><div class="line"></div><div class="line">    #    location / &#123;</div><div class="line">    #        root   html;</div><div class="line">    #        index  index.html index.htm;</div><div class="line">    #    &#125;</div><div class="line">    #&#125;</div><div class="line"></div><div class="line"></div><div class="line">    # HTTPS server</div><div class="line">    #</div><div class="line">    #server &#123;</div><div class="line">    #    listen       443 ssl;</div><div class="line">    #    server_name  localhost;</div><div class="line"></div><div class="line">    #    ssl_certificate      cert.pem;</div><div class="line">    #    ssl_certificate_key  cert.key;</div><div class="line"></div><div class="line">    #    ssl_session_cache    shared:SSL:1m;</div><div class="line">    #    ssl_session_timeout  5m;</div><div class="line"></div><div class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class="line">    #    ssl_prefer_server_ciphers  on;</div><div class="line"></div><div class="line">    #    location / &#123;</div><div class="line">    #        root   html;</div><div class="line">    #        index  index.html index.htm;</div><div class="line">    #    &#125;</div><div class="line">    #&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>server下listen的端口改为8088，并增加一个location配置，用于访问图片文件，这一串配置有#号在前面的注释掉的都可以删掉，免得看起来又长又乱。</p>
<p>6、启动命令： /home/nginx/sbin/nginx -c /home/nginx/conf/nginx.conf。<br>打开防火墙对应端口供访问，8088，当然也可以直接关了防火墙。<br>若修改了nginx.conf配置，则需要重启才生效，命令：/home/nginx/sbin/nginx -s reload</p>
<p>7、访问。<br>输入ifconfig命令查看虚拟机ip，测试：</p>
<p><img src="http://img.blog.csdn.net/20170421010243601?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" width="400px" height="200px"></p>
<p>在/home/images下放张图片，测试访问：<br><img src="http://img.blog.csdn.net/20170421005903034?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="doge" title="" width="300px" height="250px"></p>
]]></content>
      
        
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[eclipse neon git 提交窗口太小问题]]></title>
      <url>/2017/04/16/eclipse%20neon%20git%20%E6%8F%90%E4%BA%A4%E7%AA%97%E5%8F%A3%E5%A4%AA%E5%B0%8F%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>eclipse neon版本的javascript编辑器无法处理某些异常信息，比如本人在用require js和vue js的时候碰过这种异常<br><code>java.lang.NoSuchMethodError:jdk.nashorn.internal.runtime.ECMAException.getEcmaError()Ljava/lang/Object;</code><br>然后js文件直接就打不开了，最终在stackoverflow找到相关问题，链接<br><a href="http://stackoverflow.com/questions/38089331/eclipse-neon-java-ee-ide-javascript-editor-broken" target="_blank" rel="external">http://stackoverflow.com/questions/38089331/eclipse-neon-java-ee-ide-javascript-editor-broken</a></p>
<p>照回答者意思是javascript开发工具没法解析某些特殊语法的js代码；<br>另一个回答是说新版本的jdk已经解决这个问题，尝试卸了jdk（一直用的1.8.0_05版），装上最新版本的（目前是1.8.0_131版），问题解决。（仅供参考）</p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[反射]]></title>
      <url>/2017/04/04/%E5%8F%8D%E5%B0%84/</url>
      <content type="html"><![CDATA[<blockquote>
<p>相信大家经常听说某些框架设计用到了反射机制啥啥，但自己对此概念却了解甚少，虽然一般开发不会用到，但还是有必要知道反射的基本原理和操作。</p>
</blockquote>
<p>  使用反射，可以做到：</p>
<ul>
<li>在运行中分析类的能力。</li>
<li>在运行中查看对象，例如，编写一个toString方法供所有类使用。</li>
<li>实现数组的操作代码。</li>
<li>利用Method对象，这个对象很像C++中的函数指针。</li>
</ul>
<p>反射操作主要用到的类有Class（类）、Field（属性）、Method（成员函数）、Constructor（构造）和Modifier（修饰符）<br><a id="more"></a><br>一、反射获取类</p>
<p>新建一个Student类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	</div><div class="line">	<span class="comment">//无参构造</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">//有参构造</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> age, String name)</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.age = age;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		System.out.println(<span class="string">"My name is "</span>+name+<span class="string">",I'm "</span>+age+<span class="string">" years old."</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.age = age;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> age;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">learning</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"learning..."</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>测试类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">public class ReflexTest &#123;</div><div class="line">	public static void main(String[] args) throws ClassNotFoundException &#123;</div><div class="line">		Student student = new Student(20, &quot;shen&quot;);//一般创建对象</div><div class="line">		</div><div class="line">		Class stu = Class.forName(&quot;com.test.reflex.Student&quot;);//通过Class获取指定类的完整结构</div><div class="line">		System.out.println(&quot;getName---&gt;&quot;+stu.getName());</div><div class="line">		</div><div class="line">		Student s = null;</div><div class="line">		Student s1 = null; </div><div class="line">		try &#123;</div><div class="line">			s = (Student)stu.newInstance();//默认构造的是无参构造，若存在有参构造，这里将报错</div><div class="line">			</div><div class="line">			Constructor constructor = stu.getConstructor(int.class, String.class);//获取有参构造,已知确定参数</div><div class="line">			s1 = (Student)constructor.newInstance(23, &quot;shen&quot;);//有参构造</div><div class="line">			</div><div class="line">			Constructor[] constructors = stu.getConstructors();//所有构造</div><div class="line">			s1 = (Student)constructors[0].newInstance();//第一个构造(无参那个)</div><div class="line">		&#125; catch (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>输出：<br><img src="http://img.blog.csdn.net/20170403212710052?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>Class类forName方法通过完整包路径类型来实例化Class对象，再通过Class对象获取Student类实例；<br>再使用newInstance()创建对象，这里要注意Student的构造方法，默认使用的试试无参构造，可使用Constructor类操作构造方法。</p>
<p>二、获取类的基本结构</p>
<p>1、使用反射操作对象属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">public class Test01 &#123;</div><div class="line">	public static void main(String[] args) throws Exception, Exception &#123;</div><div class="line">		try &#123;</div><div class="line">			Class stu = Class.forName(&quot;com.test.reflex.Student&quot;);</div><div class="line">			</div><div class="line">			Constructor constructor = stu.getConstructor(int.class, String.class);//获取有参构造,已知确定参数</div><div class="line">			Student s = (Student)constructor.newInstance(23, &quot;shen&quot;);//有参构造</div><div class="line">			</div><div class="line">			//Field[] fields = stu.getFields();//获取public的属性</div><div class="line">			Field[] fields = stu.getDeclaredFields();//获取所有属性</div><div class="line">			for(Field field : fields)&#123;</div><div class="line">				System.out.println(&quot;属性--&gt;&quot;+field);</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			Field fieldName = stu.getDeclaredField(&quot;name&quot;);//获取私有变量name</div><div class="line">			fieldName.setAccessible(true);</div><div class="line">			System.out.println(fieldName.getName());//私有属性名称</div><div class="line">			System.out.println(fieldName.get(s));//私有属性值</div><div class="line">			</div><div class="line">			fieldName.set(s, &quot;a-shen&quot;);</div><div class="line">			System.out.println(fieldName.get(s));//改变私有属性值</div><div class="line">			</div><div class="line">		&#125; catch (ClassNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>结果输出<br><img src="http://img.blog.csdn.net/20170403212205519?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>其中对于fieldName.setAccessible(true);使用java反射获取类的属性值时，如果该属性被声明为private 的，需要将setAccessible设置为true. 默认的值为false</p>
<p>2、使用反射访问成员函数<br>通过反射调用方法，使用invoke方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">public class Test02 &#123;</div><div class="line">	public static void main(String[] args) throws Exception, Exception &#123;</div><div class="line">		try &#123;</div><div class="line">			Class stu = Class.forName(&quot;com.test.reflex.Student&quot;);</div><div class="line">			</div><div class="line">			Constructor constructor = stu.getConstructor(int.class, String.class);//获取有参构造,已知确定参数</div><div class="line">			Constructor[] constructors = stu.getConstructors();</div><div class="line">			Student s = (Student)constructors[0].newInstance();//无参构造对象</div><div class="line">			</div><div class="line">			//Method[] methods = stu.getMethods();//获取类所有方法，包括继承自父类和实现接口的方法</div><div class="line">			Method[] methods = stu.getDeclaredMethods();//获取类本身各类方法和实现接口的方法及重写的方法，不包括继承的方法</div><div class="line">			for(Method method : methods)&#123;</div><div class="line">				System.out.println(&quot;成员函数---&gt;&quot;+method);</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			Method m1 = s.getClass().getMethod(&quot;setName&quot;, String.class);</div><div class="line">			m1.invoke(s, &quot;ashen&quot;);//设置name值为&quot;ashen&quot;</div><div class="line">			</div><div class="line">			Method m2 = s.getClass().getMethod(&quot;getName&quot;);</div><div class="line">			String name = (String) m2.invoke(s);</div><div class="line">			System.out.println(&quot;getName---&gt;&quot;+name);//输出name值</div><div class="line">			</div><div class="line">		&#125;catch (ClassNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果输出<br><img src="http://img.blog.csdn.net/20170404015222950?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mysql存储过程]]></title>
      <url>/2017/02/26/Mysql%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<blockquote>
<p>当需要实现复杂的逻辑，需要写多条sql语句或写的sql比较复杂时，可以考虑使用存储过程来处理，最终返回需要的结果集。存储过程即一组SQL语句集。</p>
</blockquote>
<p>存储过程的基本语法也不算复杂，以下为创建一个存储过程的模板<br><a id="more"></a><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> TEST_FUNCTION;</div><div class="line"><span class="comment">/*定义存储过程名称，设置入参，指定类型和大小*/</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> TEST_FUNCTION(<span class="keyword">in</span> DATA_A <span class="built_in">INT</span>(<span class="number">20</span>),<span class="keyword">in</span> DATA_B <span class="built_in">INT</span>(<span class="number">20</span>),<span class="keyword">in</span> B_TYPE <span class="built_in">varchar</span>(<span class="number">20</span>))</div><div class="line"><span class="keyword">BEGIN</span></div><div class="line">     <span class="comment">/*DECLARE 关键字用于定义变量*/</span></div><div class="line">    <span class="keyword">DECLARE</span> <span class="keyword">SUM</span> <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">DECLARE</span> t_error <span class="built_in">INTEGER</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">DECLARE</span> CONTINUE <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> SQLEXCEPTION <span class="keyword">SET</span> t_error=<span class="number">1</span>;<span class="comment">/*异常标志*/</span></div><div class="line">    </div><div class="line">    <span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;<span class="comment">/*启动事务*/</span></div><div class="line">    <span class="comment">/*字符串的判断，STRCMP用法类似于C++*/</span></div><div class="line">    if STRCMP(B_TYPE,'SUM')=0 then</div><div class="line">    <span class="keyword">begin</span></div><div class="line">         <span class="keyword">SELECT</span>  DATA_A+DATA_B <span class="keyword">INTO</span> <span class="keyword">SUM</span>;<span class="comment">/*INTO 把值放到变量中*/</span></div><div class="line">         <span class="keyword">SELECT</span> <span class="keyword">SUM</span>;</div><div class="line">    <span class="keyword">end</span>;<span class="comment">/*一个begin对应一个end*/</span></div><div class="line">    <span class="keyword">end</span> <span class="keyword">if</span>;<span class="comment">/*一个if对应一个end if*/</span></div><div class="line">    </div><div class="line">    IF t_error = 1 THEN  </div><div class="line">    <span class="keyword">ROLLBACK</span>;<span class="comment">/*异常回滚*/</span></div><div class="line">    ELSE</div><div class="line">    <span class="keyword">COMMIT</span>;<span class="comment">/*正常提交*/</span></div><div class="line">    <span class="keyword">END</span> <span class="keyword">IF</span>;</div><div class="line"><span class="keyword">END</span>;</div></pre></td></tr></table></figure></p>
<p>创建生成的样子</p>
<p><img src="http://img.blog.csdn.net/20170226161939611?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/200/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>DEFINER的信息是’用户名’@’host’</p>
<p>输入参数值测试<br><img src="http://img.blog.csdn.net/20170226162314021?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/200/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>调用存储使用call命令<br><img src="http://img.blog.csdn.net/20170226162538526?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/200/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
]]></content>
      
        
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[内部类相关——定义、匿名内部类、回调实现及静态内部类]]></title>
      <url>/2017/02/23/%E5%86%85%E9%83%A8%E7%B1%BB%E7%9B%B8%E5%85%B3%E2%80%94%E2%80%94%E5%AE%9A%E4%B9%89%E3%80%81%E5%8C%BF%E5%90%8D%E5%86%85%E9%83%A8%E7%B1%BB%E3%80%81%E5%9B%9E%E8%B0%83%E5%AE%9E%E7%8E%B0%E5%8F%8A%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB/</url>
      <content type="html"><![CDATA[<blockquote>
<p>内部类，顾名思义就是在一个类中的类。内部类可以访问所在类的数据，包括私有数据，而又可以对其他类隐藏，在快速实现回调函数时可以使用匿名内部类，比较便捷。</p>
</blockquote>
<p>1、以下为一个简单的内部类例子，内部类可以定义为私有以对其他类隐藏起来；可以用内部类来达到实现多继承的效果。需要注意的是，通过成员函数传入内部类的变量必须定义为final类型，以保证数据的一致性。<a id="more"></a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Walk</span></span>&#123;</div><div class="line">	<span class="comment">//private私有类，继承Walk和Eat</span></div><div class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">LittleCat</span> <span class="keyword">extends</span> <span class="title">Eat</span> </span>&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span> </span>&#123;</div><div class="line">			System.out.println(<span class="string">"Walking....Eating...."</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		LittleCat lCat = <span class="keyword">new</span> Cat().new LittleCat();<span class="comment">//创建内部类对象方式，通过先创建所在外围类对象再创建内部类对象</span></div><div class="line">		lCat.doSomething();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">event</span><span class="params">(<span class="keyword">final</span> String name)</span> </span>&#123;</div><div class="line">		<span class="class"><span class="keyword">class</span> <span class="title">EatFish</span></span>&#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</div><div class="line">				<span class="comment">//name = "Tom";//在这里修改会报错，name 必须为final类型，保证数据一致</span></div><div class="line">				System.out.println(name);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		EatFish test = <span class="keyword">new</span> EatFish();</div><div class="line">		test.eat();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>两个父类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public class Walk &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public class Eat &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2、匿名内部类<br>从名称可以知道匿名就是没有类名的类，匿名内部类用于快速调用接口或抽象类等等中的方法，不需要多写一个实现类来实现调用。</p>
<p>抽象类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public abstract class Dog &#123;</div><div class="line">	abstract void eat();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>接口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public interface Animal &#123;</div><div class="line">	void eat();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>测试类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">public class AnonymousDemo &#123;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		 </div><div class="line">		/**</div><div class="line">		 * 通过创建的一个接口或抽象类分引用，快速便捷重写需要实现的方法，不需要先写一个实现类再实例化以调用方法</div><div class="line">		 */</div><div class="line">		</div><div class="line">		//实现接口方式</div><div class="line">		Animal dog = new Animal() &#123;</div><div class="line">			@Override</div><div class="line">			public void eat() &#123;</div><div class="line">				System.out.println(&quot;like bone.&quot;);</div><div class="line">			&#125;</div><div class="line">		&#125;;</div><div class="line">		dog.eat();//向上转型的实例，直接调用重写的eat方法</div><div class="line">		</div><div class="line">		//继承抽象类的方式</div><div class="line">		Dog littleDog = new Dog() &#123;</div><div class="line">			@Override</div><div class="line">			void eat() &#123;</div><div class="line">				System.out.println(&quot;I like bone.&quot;);</div><div class="line">			&#125;</div><div class="line">		&#125;;</div><div class="line">		littleDog.eat();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>此外，Java的回调函数式可以通过匿名内部类来实现，比如以下例子</p>
<p>(1)封装的类和提供的接口<br>封装给别人调用的类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;</div><div class="line">	</div><div class="line">	private EatFood eatFood;</div><div class="line">	</div><div class="line">	/**</div><div class="line">	 * 普通方式，构造传递引用</div><div class="line">	 */</div><div class="line">	public Person(EatFood eatSomething)&#123;</div><div class="line">		this.eatFood = eatSomething;//构造时传入引用</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">	/**</div><div class="line">	 * 普通方式，成员函数传递引用</div><div class="line">	 */</div><div class="line">	public Person()&#123;</div><div class="line">	&#125;</div><div class="line">	public void setCallBack(EatFood eatSomething) &#123;</div><div class="line">		this.eatFood = eatSomething;//用成员函数传入引用</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//需要调用的方法</div><div class="line">	public void eatFood() &#123;</div><div class="line">		eatFood.eat();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>调用类需要的接口定义<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public interface EatFood &#123;</div><div class="line">	void eat();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>(2)实际调用<br>一般做法都会写一个类实现接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public class EatRice implements EatFood &#123;</div><div class="line">	@Override</div><div class="line">	public void eat() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line">		System.out.println(&quot;It&apos;s time to eat rice.&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后是实际使用的类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class PeronEatTest &#123;</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		//普通方式，构造传递引用</div><div class="line">		Person personOne = new Person(new EatRice());//EatRice实现类方式。多写一个方法传入也可</div><div class="line">		personOne.eatFood();</div><div class="line"></div><div class="line">		//普通方式，成员函数传递引用</div><div class="line">		Person personOne = new Person();</div><div class="line">		EatRice eatRice = new EatRice();</div><div class="line">		personOne.setCallBack(eatRice);</div><div class="line">		personOne.eatFood();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果使用匿名内部类就便捷了许多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class PeronEatTest &#123;</div><div class="line">	public static void main(String[] args) &#123;	</div><div class="line">		Person personTwo = new Person(new EatFood() &#123;</div><div class="line">			@Override</div><div class="line">			public void eat() &#123;</div><div class="line">				// TODO Auto-generated method stub</div><div class="line">				System.out.println(&quot;It&apos;s time to eat rice.&quot;);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		personTwo.eatFood();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3、静态内部类<br>创建是不需要依赖于外围类，但也不能使用任何外围类的非static成员变量和方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">public class Cat&#123;</div><div class="line">	</div><div class="line">	private String str = &quot;cat&quot;;</div><div class="line">	private static String str_static = &quot;cat&quot;;</div><div class="line">	</div><div class="line">	private class LittleCat&#123;</div><div class="line">		//public static String str_test = &quot;test&quot;;//错误，非静态内部类变量不能为静态</div><div class="line">		public static final String str_test = &quot;test&quot;;//但加上final就可以</div><div class="line">		public void doSomething() &#123;</div><div class="line">			str = &quot;little cat&quot;;</div><div class="line">			System.out.println(&quot;Walking....Eating....&quot;);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	static class BigCat&#123;</div><div class="line">		public void doSomething() &#123;</div><div class="line">			//str = &quot;little cat&quot;;//错误，静态内部类反问外围非静态变量和方法</div><div class="line">			str_static = &quot;big cat&quot;;</div><div class="line">			System.out.println(&quot;I am a big cat.&quot;);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		LittleCat lCat = new Cat().new LittleCat();//依赖外围类</div><div class="line">		lCat.doSomething();</div><div class="line">		</div><div class="line">		BigCat bigCat = new BigCat();//不依赖外围类</div><div class="line">		bigCat.doSomething();</div><div class="line">	&#125;</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[无题]]></title>
      <url>/2017/02/14/0214%E5%B9%BF%E5%B7%9E/</url>
      <content type="html"><![CDATA[<h1 id="本命年"><a href="#本命年" class="headerlink" title="本命年"></a>本命年</h1><p>暂且不用去想太多破事，认真过好今年</p>
<p>E时光上的广州<br><img src="\assets\articleImg\fyetime.jpg" alt="方圆E时光上的广州"></p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[鸡年大吉]]></title>
      <url>/2017/01/27/%E9%99%A4%E5%A4%95/</url>
      <content type="html"><![CDATA[<h1 id="2017"><a href="#2017" class="headerlink" title="2017"></a>2017</h1><p>除夕<br>辞旧迎新<br>新年快乐<br><img src="\assets\articleImg\chuxi.png" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[给博客换个主题]]></title>
      <url>/2016/12/29/%E7%BB%99%E5%8D%9A%E5%AE%A2%E6%8D%A2%E4%B8%AA%E4%B8%BB%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>搭好了博客之后，想把博客换了个hexo主题，挑来挑去最后选了Litten的Yilia主题。事实好多主题都做得很棒，现在不管是网站和移动端的应用，都很注重页面展示和交互体验，由此前端的技术也是日新月异，作为一个后端，看得真是眼花缭乱。</p>
<p>转眼间2016也即将过去了，这年毕业了，开始工作，真正地靠自己生活着，做了许多事情，也学会很多东西。整体上马马虎虎，但事实还有许多事情没有做好，找个时间再写个年终总结吧。</p>
<ul>
<li>加首歌试试</li>
</ul>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=848867&auto=0&height=66"></iframe>

<hr>
<p>markdown真是好用啊。顺便加上多说评论。</p>
<p><strong>以下测试</strong>    <a id="more"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	 System.out.println(<span class="string">"欢迎来到啊深的博客。"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>故人西辞黄鹤楼，烟花三月下扬州。孤帆远影碧空尽，惟见长江天际流。</p>
</blockquote>
<p>16/12/29</p>
]]></content>
      
        
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[欢迎来到我的博客]]></title>
      <url>/2016/12/20/hello-world/</url>
      <content type="html"><![CDATA[<p>之前鼓捣服务器的时候买了个域名耍耍，空间到期之后域名一直放着，不久前才想起github上能搭个博客能用自定义域名，而且刚好又不需要备案，就鼓捣了这个博客。顺便把CSDN的博文同步过来试试，CSDN博客地址 <a href="http://blog.csdn.net/u012809062" target="_blank" rel="external">http://blog.csdn.net/u012809062</a> 。</p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(6)——单点登录、集群及总结]]></title>
      <url>/2016/11/29/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E%E7%9A%84%E5%AE%9E%E8%B7%B5(6)%E2%80%94%E2%80%94%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E3%80%81%E9%9B%86%E7%BE%A4%E5%8F%8A%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>最后一篇，简单记录下剩下主要的内容和写个总结。整个项目基于各类技术的入门使用，展现开发中对于不同业务需要用到的技术和技术的整合，实际意义虽不大，但至少对当下流行的技术的初步了解还是有用的。</p>
<p>一、单点登录</p>
<p>SSO(Single Sign On)单点登录是在多个应用系统中，用户只需要登录一次就可以访问所有相互信任的应用系统。它包括可以将这次主要的登录映射到其他应用中用于同一个用户的登录的机制。它是目前比较流行的企业业务整合的解决方案之一。</p>
<p>1、tomcat的session复制方式<br>tomcat实现单点登录是采用全局session复制方式，集群内每个tomcat的session完全同步。<br><a id="more"></a><br>2、redis<br>验证登录之后将session存放在redis服务器中，token作为键值，设置过期时间(比如半个小时)，客户端存放token，每当访问页面时先验证token是否过期。若token不存在或者过期则跳转到登录页面，若存在且有效则通过。<br>创建taotao-sso工程，配置跟之前普通war工程一样。所有工程的登录都跳转到本工程进行登录，并获取验证token凭证。</p>
<p>二、集群及其他<br>1、订单和购物车这些纯业务的东西没什么好讲的，看看就好；<br>2、集群功能方面，redis和solr还有tomcat等等大部分内容都是配置文件配置，模拟集群环境需要多个虚拟机，电脑跑不起来的也看看就好；<br>3、域名规划、项目部署和nginx的配置使用涉及内容琐碎繁多，在实际开发中整理学习比较实际。</p>
<p>三、总结<br>实际中一个项目从确定需求到选择框架，再到实际开发，解决各类各样的技术问题，最后项目上线，部署工程和服务器的配置等等，涉及许许多多的东西，不是一个培训班小项目就能看到多少东西。最后的单点登录和集群等功能扩展开来写的东西太多，干脆一笔带过，等学到时再做记录。到此，商城就酱紫。</p>
<p><a href="http://download.csdn.net/detail/u012809062/9759182" target="_blank" rel="external">最后整理的工程文件下载(仅参考)</a></p>
]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(5)——Solr全文检索]]></title>
      <url>/2016/11/28/solr%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/</url>
      <content type="html"><![CDATA[<blockquote>
<p> 时间又过去了好久，最近在鼓捣微信开发停不来下…..在上一篇博文记录了使用redis为商城系统添加缓存服务，以提高网站的访问速度和性能。另外，我们很容易注意到搜索服务在商城网站中是必不可少的，事实上，在内容繁多的一般网站业也会有搜索功能，而这里很多人就想到Lucene或Solr。</p>
</blockquote>
<h5 id="一、Lucene和Solr"><a href="#一、Lucene和Solr" class="headerlink" title="一、Lucene和Solr"></a>一、Lucene和Solr</h5><p>一说到全文检索总会提到Lucene和Solr，但这两者有什么区别，<a href="http://lucene.apache.org/" target="_blank">官网</a>上已经解释了很清楚：</p>
<blockquote>
<ul>
<li>Lucene Core, our flagship sub-project, provides Java-based indexing and search technology, as well as spellchecking, hit highlighting and advanced analysis/tokenization capabilities.</li>
<li>Solr<sup>TM</sup> is a high performance search server built using Lucene Core, with XML/HTTP and JSON/Python/Ruby APIs, hit highlighting, faceted search, caching, replication, and a web admin interface.</li>
</ul>
</blockquote>
<p>说白了Lucene是个Java Library，而Solr是一个基于Lucene的全文搜索服务器。如果使用Lucene需要自行实现一堆东西，但更灵活；Solr作为企业级的搜索引擎系统，使用方便。商城这里用solr练手，实际的商城网站如京东或淘宝，当然，肯定是其他高大上的东西了。<a id="more"></a></p>
<h5 id="二、安装Solr"><a href="#二、安装Solr" class="headerlink" title="二、安装Solr"></a>二、安装Solr</h5><ol>
<li><p>先到Solr官网<a href="http://lucene.apache.org/solr/" target="_blank">下载</a>,Solr的版本基本是和Lucene一起更新的，不就前看到的时候5.5.0版，现在都到6.3.0版了。<br>商城教程使用的tomcat和solr版本都比较老，这里直接用tomcat8和solr6.3.0。在高版本solr中原商城教程有些方法已经过时，不推荐使用，这里会重新实现一遍。</p>
</li>
<li><p>解压solr压缩包，可以看到几个文件夹，有常规的docs文档、licenses版本信息和example例子。bin目录下是命令操作区，dos下在本目录执行 <strong>solr start</strong> 快速启动solr，在浏览器输入 localhost:8983 可看到solr的基本操作页面，这里我们不直接启动，而是将solr发布到tomcat。contrib文件包含了一些扩展工具包，dist是solr编译之后的目标文件夹，包含各类jar包，server文件夹即应用文件夹。</p>
</li>
<li><p>将solr-6.3.0\server\solr-webapp下的webapp文件复制到tomcat的webapps下并重命名为solr，即当成一个发布的工程。</p>
</li>
<li><p>将solr-6.3.0\server\lib\ext下的文件复制到刚重命名的solr工程中 WEB-INF\lib 目录下，在WEB-INF创建classes文件夹，将solr-6.3.0\server\resources下的log4j.properties复制到classes文件夹中，这些都是一些日志相关的东西。</p>
</li>
<li><p>接着需要创建一个solr home，随意在某个目录下创建一个文件夹并命名为solr_home，例如D盘下D:\solr_home，然后将solr-6.3.0\server\solr文件夹复制过来。编辑solr工程web.xml文件，指定solr home的路径为D:\solr_home。索引库默认存放在这个文件夹，并包含刚复制过来分配置文件。</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">env-entry</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">env-entry-name</span>&gt;</span>solr/home<span class="tag">&lt;/<span class="name">env-entry-name</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">env-entry-value</span>&gt;</span>D:/solr_home/solr<span class="tag">&lt;/<span class="name">env-entry-value</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">env-entry-type</span>&gt;</span>java.lang.String<span class="tag">&lt;/<span class="name">env-entry-type</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">env-entry</span>&gt;</span></div></pre></td></tr></table></figure>
<ol>
<li>尝试访问<a href="http://localhost:8080/solr/index.html" target="_blank">http://localhost:8080/solr/index.html</a>报错403，资源拒绝访问，回到solr工程的web.xml文件，可以看到有这么一段配置</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Get rid of error message --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>Disable TRACE<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">http-method</span>&gt;</span>TRACE<span class="tag">&lt;/<span class="name">http-method</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">auth-constraint</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>Enable everything but TRACE<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">http-method-omission</span>&gt;</span>TRACE<span class="tag">&lt;/<span class="name">http-method-omission</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></div></pre></td></tr></table></figure>
<p>注释掉本段配置，开放访问权限就能正常访问。</p>
<h5 id="三、创建core"><a href="#三、创建core" class="headerlink" title="三、创建core"></a>三、创建core</h5><ol>
<li><p>将solr-6.3.0/dist中的solr-dataimporthandler、solr-dataimporthandler-extras的jar包复制到tomcat\webapps\solr\WEB-INF\lib目录下；</p>
</li>
<li><p>在D:\solr_home\solr下创建taotao_core文件夹，并在taotao_core下创建data和conf文件夹。将solr-6.3.0\example\example-DIH\solr\solr\conf所有文件和文件夹复制到D:\solr_home\solr\taotao_core\conf目录下；</p>
</li>
<li><p>访问solr工程，创建core，instanceDir和name填core文件夹的名字，即taotao_core。</p>
</li>
</ol>
<h5 id="四、配置IK中文分词器"><a href="#四、配置IK中文分词器" class="headerlink" title="四、配置IK中文分词器"></a>四、配置IK中文分词器</h5><ol>
<li><p>下载跟solr对应版本的IK分词器<a href="http://download.csdn.net/detail/u012809062/9730367" target="_blank" rel="external">IK-analyze-solr6.3</a>，解压后将jar包复制到solr工程WEB-INF\lib目录下，将IKAnalyzer.cfg.xml配置文件和mydict.dic、stopword.dic两个词典复制到到solr工程WEB-INF\classes目录下。</p>
</li>
<li><p>配置业务字段：修改D:\solr_home\solr\taotao_core\conf下的managed-schema文件<br>在底部<strong>&lt; /schema&gt;</strong>线加上</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_ik"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_title"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_sell_point"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_price"</span>  <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_image"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"false"</span> <span class="attr">stored</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_category_name"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_desc"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"item_keywords"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"item_title"</span> <span class="attr">dest</span>=<span class="string">"item_keywords"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"item_sell_point"</span> <span class="attr">dest</span>=<span class="string">"item_keywords"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"item_category_name"</span> <span class="attr">dest</span>=<span class="string">"item_keywords"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"item_desc"</span> <span class="attr">dest</span>=<span class="string">"item_keywords"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>重启服务器，选择taotao_core点击分词器 analysis，FieldType选择item_desc,贴上一段文本分析测试<br><img src="http://img.blog.csdn.net/20170111091018269?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
</li>
</ol>
<h5 id="五、在taotao-search整合并使用solr"><a href="#五、在taotao-search整合并使用solr" class="headerlink" title="五、在taotao-search整合并使用solr"></a>五、在taotao-search整合并使用solr</h5><ol>
<li>创建taotao-search工程，同样数据库、SpringMvc照着配置，没什么好说的，applicationContext-solr.xml需要修改一下，因为httpSolrServer在6.3版本已经过时了，换成HttpSolrClient连接solr服务。从原来的HttpSolrServer可以看到,类已经deprecated了，改为使用HttpSolrClient<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@deprecated</span> Use &#123;<span class="doctag">@link</span> org.apache.solr.client.solrj.impl.HttpSolrClient&#125;</div><div class="line"> */</div><div class="line"><span class="meta">@Deprecated</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpSolrServer</span> <span class="keyword">extends</span> <span class="title">HttpSolrClient</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttpSolrServer</span><span class="params">(String baseURL)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(baseURL);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HttpSolrServer</span><span class="params">(String baseURL, HttpClient client)</span> </span>&#123;</div><div class="line">	<span class="keyword">super</span>(baseURL, client);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HttpSolrServer</span><span class="params">(String baseURL, HttpClient client, ResponseParser parser)</span> </span>&#123;</div><div class="line">	<span class="keyword">super</span>(baseURL, client, parser);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>再看下HttpSolrClient类中一个地方，baseURL参数依旧，注释给了个例子，如果是标准的solr玩意，照着这个规则配，当我们的solr是发布到tomcat的，一会配的url不行就改下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">   * <span class="doctag">@param</span> baseURL</div><div class="line">   *          The URL of the Solr server. For example, "</div><div class="line">   *          &lt;code&gt;http://localhost:8983/solr/&lt;/code&gt;" if you are using the</div><div class="line">   *          standard distribution Solr webapp on your local machine.</div><div class="line">   */</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">HttpSolrClient</span><span class="params">(String baseURL)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>(baseURL, <span class="keyword">null</span>, <span class="keyword">new</span> BinaryResponseParser());</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>applicationContext-solr.xml中bean的配置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置SolrServer对象 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 单机版 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;bean id="HttpSolrClient" class="org.apache.solr.client.solrj.impl.HttpSolrServer"&gt; --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"HttpSolrClient"</span> <span class="attr">class</span>=<span class="string">"org.apache.solr.client.solrj.impl.HttpSolrClient"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"baseURL"</span> <span class="attr">value</span>=<span class="string">"$&#123;SOLR.SERVER.URL&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 集群版 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;bean id="cloudSolrServer" class="org.apache.solr.client.solrj.impl.CloudSolrServer"&gt;</span></div><div class="line">		&lt;constructor-arg name="zkHost" value="192.168.25.154:2181,192.168.25.154:2182,192.168.25.154:2183"&gt;&lt;/constructor-arg&gt;</div><div class="line">		&lt;property name="defaultCollection" value="collection2"&gt;&lt;/property&gt;</div><div class="line">	&lt;/bean&gt; --&gt;</div></pre></td></tr></table></figure></p>
<p>其中SOLR.SERVER.URL变量的配置在resource.properties中配置,指向solr下的core就是了，正常连接<a href="http://localhost:8080/solr/index.html#/taotao_core" target="_blank" rel="external">http://localhost:8080/solr/index.html#/taotao_core</a> 的<strong>index.html#</strong>去掉，如果在tomcat的server xml配了根路径，没有index.html，中间的#/同样需要去掉<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SOLR.SERVER.URL=http://localhost:8080/solr/taotao_core</div></pre></td></tr></table></figure></p>
<p>ItemServiceImpl改为注入HttpSolrClient<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//private SolrServer solrServer;//过时方法，废弃不用</span></div><div class="line"><span class="meta">@Autowired</span></div><div class="line"><span class="keyword">private</span> HttpSolrClient solrServer;<span class="comment">//使用HttpSolrClient，实例化名称solrServer懒得改，注意</span></div></pre></td></tr></table></figure></p>
<p>SearchDaoImpl搜索服务同理换下HttpSolrClient<br>访问<a href="http://localhost:8083/search/manager/importall" target="_blank" rel="external">http://localhost:8083/search/manager/importall</a> 导入数据，成功状态200，数据多可能比较慢<br><img src="http://img.blog.csdn.net/20170111091433612?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>query一下看看导进来那些东东，可以看到查到商品了<br><img src="http://img.blog.csdn.net/20170111091519159?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>搜下“移动电源试试” <a href="http://localhost:8083/search/query?q=移动电源&amp;page=3&amp;rows=15" target="_blank" rel="external">http://localhost:8083/search/query?q=移动电源&amp;page=3&amp;rows=15</a><br><img src="http://img.blog.csdn.net/20170111091549666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h5 id="六、发布搜索服务到taotao-portal"><a href="#六、发布搜索服务到taotao-portal" class="headerlink" title="六、发布搜索服务到taotao-portal"></a>六、发布搜索服务到taotao-portal</h5><ol>
<li><p>在taotao-portal资源文件resource.properties配置搜索服务连接</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SEARCH_BASE_URL=http://localhost:8083/search/query</div></pre></td></tr></table></figure>
</li>
<li><p>业务照搬，或根据自己的需要修改。感觉事实上非要建个search工程实在是…封装个类足以。测试搜索如下<br><img src="http://img.blog.csdn.net/20170111093524121?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMjgwOTA2Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
</li>
</ol>
]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(4)——redis的使用]]></title>
      <url>/2016/10/21/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E%E7%9A%84%E5%AE%9E%E8%B7%B5(4)%E2%80%94%E2%80%94redis%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<blockquote>
<p>一忙起来就不动博客了，这样不好，接着上个月的商城小项目。上次商城系统从后台发布商品到前台工程的展示都已经实现了，但实际上线系统由于用户数量增多，为了应付网站的大访问量，降低数据库及整个系统的压力，一般都会选择缓存功能。</p>
</blockquote>
<h4 id="一、缓存工具的选择——redis"><a href="#一、缓存工具的选择——redis" class="headerlink" title="一、缓存工具的选择——redis"></a>一、缓存工具的选择——redis</h4><blockquote>
<p>Redis是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。<br><a id="more"></a></p>
<h5 id="1、安装启动"><a href="#1、安装启动" class="headerlink" title="1、安装启动"></a>1、安装启动</h5><p>先到<a href="http://redis.io/download" target="_blank">官网</a>下载需要的对应版本的redis。redis是用C语言写的，下载有编译版和直接安装的。<br>我这里直接用win版，解压，cd到根目录，执行redis-server.exe就可以启动redis了，默认端口6379:<br><img src="http://img.blog.csdn.net/20161125005932896" width="98%"><br>再新开dos，cd到redis根目录，redis-cli打开客户端，输入ping测试，响应返回pong，表示客户服务两端连接正常：<br><img src="http://img.blog.csdn.net/20161125010853204" alt="这里写图片描述"><br>然后就可以愉快进行操作了。之前公司有简单用到redis，试着放在win下，然后，貌似不怎么稳定，这东西还是放Linux下吧。</p>
<h5 id="2、可视化工具"><a href="#2、可视化工具" class="headerlink" title="2、可视化工具"></a>2、可视化工具</h5><p>在Windows下redis提供了一个可视化工具，可以链接和查看redis的各种信息。<a href="http://download.csdn.net/detail/u012809062/9499207" target="_blank">[RedisDesktopManager]</a></p>
</blockquote>
<h4 id="二、redis和spring的整合"><a href="#二、redis和spring的整合" class="headerlink" title="二、redis和spring的整合"></a>二、redis和spring的整合</h4><p>这里只看单机版的。根据系统的架构，所有与redis的数据交互都在taotao-rest工程完成，在本工程的操作直接注入调用redis相应的实现类即可，对于其他工程则需提供另外接口服务以供调用。</p>
<h5 id="1、xml的配置"><a href="#1、xml的配置" class="headerlink" title="1、xml的配置"></a>1、xml的配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 连接池配置 --&gt;</div><div class="line">	&lt;bean id=&quot;jedisPoolConfig&quot; class=&quot;redis.clients.jedis.JedisPoolConfig&quot;&gt;</div><div class="line">		&lt;!-- 最大连接数 --&gt;</div><div class="line">		&lt;property name=&quot;maxTotal&quot; value=&quot;30&quot; /&gt;</div><div class="line">		&lt;!-- 最大空闲连接数 --&gt;</div><div class="line">		&lt;property name=&quot;maxIdle&quot; value=&quot;10&quot; /&gt;</div><div class="line">		&lt;!-- 每次释放连接的最大数目 --&gt;</div><div class="line">		&lt;property name=&quot;numTestsPerEvictionRun&quot; value=&quot;1024&quot; /&gt;</div><div class="line">		&lt;!-- 释放连接的扫描间隔（毫秒） --&gt;</div><div class="line">		&lt;property name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;30000&quot; /&gt;</div><div class="line">		&lt;!-- 连接最小空闲时间 --&gt;</div><div class="line">		&lt;property name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;1800000&quot; /&gt;</div><div class="line">		&lt;!-- 连接空闲多久后释放, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲连接数 时直接释放 --&gt;</div><div class="line">		&lt;property name=&quot;softMinEvictableIdleTimeMillis&quot; value=&quot;10000&quot; /&gt;</div><div class="line">		&lt;!-- 获取连接时的最大等待毫秒数,小于零:阻塞不确定的时间,默认-1 --&gt;</div><div class="line">		&lt;property name=&quot;maxWaitMillis&quot; value=&quot;1500&quot; /&gt;</div><div class="line">		&lt;!-- 在获取连接的时候检查有效性, 默认false --&gt;</div><div class="line">		&lt;property name=&quot;testOnBorrow&quot; value=&quot;true&quot; /&gt;</div><div class="line">		&lt;!-- 在空闲时检查有效性, 默认false --&gt;</div><div class="line">		&lt;property name=&quot;testWhileIdle&quot; value=&quot;true&quot; /&gt;</div><div class="line">		&lt;!-- 连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true --&gt;</div><div class="line">		&lt;property name=&quot;blockWhenExhausted&quot; value=&quot;false&quot; /&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line">	</div><div class="line">	&lt;!-- redis连接池 --&gt;</div><div class="line">	&lt;bean id=&quot;redisClient&quot; class=&quot;redis.clients.jedis.JedisPool&quot;&gt;</div><div class="line">		&lt;constructor-arg name=&quot;host&quot; value=&quot;127.0.0.1&quot;&gt;&lt;/constructor-arg&gt;</div><div class="line">		&lt;constructor-arg name=&quot;port&quot; value=&quot;6379&quot;&gt;&lt;/constructor-arg&gt;</div><div class="line">		&lt;constructor-arg name=&quot;poolConfig&quot; ref=&quot;jedisPoolConfig&quot;&gt;&lt;/constructor-arg&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line">	&lt;bean id=&quot;jedisClient&quot; class=&quot;com.taotao.rest.dao.impl.JedisClientSingle&quot;&gt;&lt;/bean&gt;</div></pre></td></tr></table></figure>
<h5 id="2、接口及实现"><a href="#2、接口及实现" class="headerlink" title="2、接口及实现"></a>2、接口及实现</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">package com.taotao.rest.dao;</div><div class="line">public interface JedisClient &#123;</div><div class="line">	String get(String key);</div><div class="line">	String set(String key, String value);</div><div class="line">	String hget(String hkey, String key);</div><div class="line">	long hset(String hkey, String key, String value);//hash</div><div class="line">	long incr(String key);//自增</div><div class="line">	long expire(String key, int second);//设置过期时间,单位秒</div><div class="line">	long ttl(String key);//生存时间</div><div class="line">	long del(String key);//删除</div><div class="line">	long hdel(String hkey, String key);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>JedisClientSingle再实现JedisClient 接口，完成redis的基本功能。<br>系统的缓存逻辑是从redis获取数据，若redis对应数据不存在，就从mysql数据库取数据存储到redis中，返回。下次即能直接从redis获得数据，若数据发生变更，在变更操作后删除对应键值在redis中的数据，重复上述方法。</p>
<h5 id="3、为其他工程提供服务接口"><a href="#3、为其他工程提供服务接口" class="headerlink" title="3、为其他工程提供服务接口"></a>3、为其他工程提供服务接口</h5><p>以taotao-manager-service内容管理更新redis为例。dao接口仍然是JedisClient ,基础操作功能一样。<br>实现类为一个Service。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">@Service</div><div class="line">public class RedisServiceImpl implements RedisService </div><div class="line">	@Autowired</div><div class="line">	private JedisClient jedisClient;</div><div class="line">	@Value(&quot;$&#123;INDEX_CONTENT_REDIS_KEY&#125;&quot;)</div><div class="line">	private String INDEX_CONTENT_REDIS_KEY;</div><div class="line">	@Override</div><div class="line">	public TaotaoResult syncContent(long contentCid) &#123;</div><div class="line">		try &#123;</div><div class="line">			jedisClient.hdel(INDEX_CONTENT_REDIS_KEY, contentCid + &quot;&quot;);</div><div class="line">		&#125; catch (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">			return TaotaoResult.build(500, ExceptionUtil.getStackTrace(e));</div><div class="line">		&#125;</div><div class="line">		return TaotaoResult.ok();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>controller发布service,需要时直接根据http调此controller即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@Controller</div><div class="line">@RequestMapping(&quot;/cache/sync&quot;)</div><div class="line">public class RedisController &#123;</div><div class="line">	@Autowired</div><div class="line">	private RedisService redisService;</div><div class="line">	@RequestMapping(&quot;/content/&#123;contentCid&#125;&quot;)</div><div class="line">	@ResponseBody</div><div class="line">	public TaotaoResult contentCacheSync(@PathVariable Long contentCid) &#123;</div><div class="line">		TaotaoResult result = redisService.syncContent(contentCid);</div><div class="line">		return result;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="redis看似上手简单，但真正要应用起来就不是这么回事了，需要用到redis应该都死初具规模或有特殊要求的系统，要用好不容易。作为一个广泛使用的nosql数据库，值得去学习了解。"><a href="#redis看似上手简单，但真正要应用起来就不是这么回事了，需要用到redis应该都死初具规模或有特殊要求的系统，要用好不容易。作为一个广泛使用的nosql数据库，值得去学习了解。" class="headerlink" title="redis看似上手简单，但真正要应用起来就不是这么回事了，需要用到redis应该都死初具规模或有特殊要求的系统，要用好不容易。作为一个广泛使用的nosql数据库，值得去学习了解。"></a>redis看似上手简单，但真正要应用起来就不是这么回事了，需要用到redis应该都死初具规模或有特殊要求的系统，要用好不容易。作为一个广泛使用的nosql数据库，值得去学习了解。</h4><h4 id="商城剩下比较主要的内容包括全文检索、单点登录、nginx及系统架构分析，只是作为一个培训练习的项目也没太多可以看了。"><a href="#商城剩下比较主要的内容包括全文检索、单点登录、nginx及系统架构分析，只是作为一个培训练习的项目也没太多可以看了。" class="headerlink" title="商城剩下比较主要的内容包括全文检索、单点登录、nginx及系统架构分析，只是作为一个培训练习的项目也没太多可以看了。"></a>商城剩下比较主要的内容包括全文检索、单点登录、nginx及系统架构分析，只是作为一个培训练习的项目也没太多可以看了。</h4>]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(3)——图片服务器部署和前台工程]]></title>
      <url>/2016/10/02/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E%E7%9A%84%E5%AE%9E%E8%B7%B5(3)%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E5%92%8C%E5%89%8D%E5%8F%B0%E5%B7%A5%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>前言：之前后台系统的框架基本搭建完毕，后台剩下的就是一些增删改查业务操作。文本操作一般没什么问题，比较重要的是后台新增发布信息时涉及的图片的上传、存储和读取。教程里使用了ftp服务器来上传图片，使用nginx作为访问静态资源服务器。后台搞定之后接下来搭建前台系统。<br>一、图片服务器相关<br>商城系统中，新增商品经常需要编辑介绍和上传图片，后台系统的编辑页面使用了kindedit富文本编辑器，图片的上传需要我们自己配置。<br>1、图片上传服务器<br>使用ftp服务器作为图片上传的服务器，教程中的ftp服务器是部署在Linux系统下，跟着操作就行，没必要说，所以自己尝试在Windows下搭建ftp服务器。<br>Windows下搭建ftp比较简单，参考链接：<a href="https://www.baidu.com/link?url=OlyREktg1bWh0TNWcRIDi_sIrx7e-EDHEZ3ENmm_n9ZzA_W4ymN7S5ZKXqtTD3PrB93tnwkG98f5l0humIxG9uMQG_cQGDNPn3nxZ9fYETa&wd=&eqid=a272a68300069f720000000657f1d0f2" target="_blank">win10搭建ftp服务器</a><br><a id="more"></a><br>设置服务器指向的物理地址，我这里设置的是C盘的images目录，并为服务器指定用户访问，在浏览器输入 ftp:// + 设置的ip访问，输入用户名密码<br><img src="http://img.blog.csdn.net/20161003114039186" alt="这里写图片描述"></p>
<p>对应物理路径的文件<br><img src="http://img.blog.csdn.net/20161003114117952" alt="这里写图片描述"></p>
<p>2、nginx静态资源访问服务器<br>同样教程里nginx是搭建在Linux系统下，这里在尝试Windows下搭建一个。先到官网下载for Windows版本的Stable version版本，链接：<a href="http://nginx.org/en/download.html" target="_blank">nginx下载</a></p>
<p>下载完解压，编辑conf文件夹下的nginx.conf配置文件。默认pid日志是注释的，删掉前面”#”号就行。pid日志实在nginx运行时才生成的文件，在关闭nginx之后会被自动删掉，在dos下的一些操作命令依赖于此文件，比如reload、quit和stop等命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pid        logs/nginx.pid;</div></pre></td></tr></table></figure>
<p> 我自己的nginx部分配置，参考<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">server &#123;  </div><div class="line">        listen       8089;#端口号  </div><div class="line">        server_name  localhost;#本机  </div><div class="line">        charset utf-8;  </div><div class="line">        #access_log  logs/host.access.log  main;  </div><div class="line">  </div><div class="line">		location ~ .*\.(gif|jpg|jpeg|png)$ &#123;  </div><div class="line">			expires 24h;  </div><div class="line">            root C:/images/;#指定图片存放路径  </div><div class="line">            access_log D:/nginx-1.10.1/logs/images.log;#图片 日志路径  </div><div class="line">            proxy_store on;  </div><div class="line">            proxy_store_access user:rw group:rw all:rw;  </div><div class="line">            proxy_temp_path         C:/images/;#图片路径  </div><div class="line">            proxy_redirect          off;  </div><div class="line">  </div><div class="line">            proxy_set_header        Host 127.0.0.1;  </div><div class="line">            proxy_set_header        X-Real-IP $remote_addr;  </div><div class="line">            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;  </div><div class="line">            client_max_body_size    10m;  </div><div class="line">            client_body_buffer_size 1280k;  </div><div class="line">            proxy_connect_timeout   900;  </div><div class="line">            proxy_send_timeout      900;  </div><div class="line">            proxy_read_timeout      900;  </div><div class="line">            proxy_buffer_size       40k;  </div><div class="line">            proxy_buffers           40 320k;  </div><div class="line">            proxy_busy_buffers_size 640k;  </div><div class="line">            proxy_temp_file_write_size 640k;  </div><div class="line">            if ( !-e $request_filename)  </div><div class="line">            &#123;  </div><div class="line">                 proxy_pass  http://127.0.0.1:8089;#代理访问地址  </div><div class="line">            &#125;  </div><div class="line">		&#125;</div><div class="line">		location / &#123;  </div><div class="line">            root   html;  </div><div class="line">            index  index.html index.htm;  </div><div class="line">  </div><div class="line">        &#125;  </div><div class="line">        error_page  404              /404.html;  </div><div class="line">        # redirect server error pages to the static page /50x.html  </div><div class="line">        #  </div><div class="line">        error_page   500 502 503 504  /50x.html;  </div><div class="line">        location = /50x.html &#123;  </div><div class="line">            root   html;  </div><div class="line">        &#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>在dos下cd到nginx的目录,启动</p>
<p><img src="http://img.blog.csdn.net/20161003120027534" alt="这里写图片描述"></p>
<p>测试访问 C:/images/temp下图片<br><img src="http://img.blog.csdn.net/20161003120336601" alt="这里写图片描述"><br>其他一些nginx 命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nginx -s stop 强制关闭 </div><div class="line">nginx -s quit 安全关闭 </div><div class="line">nginx -s reload 改变配置文件的时候，重启nginx工作进程，来时配置文件生效</div></pre></td></tr></table></figure></p>
<p>3、上传和访问的服务器搭建完毕之后，在taotao-manager-web的resource.properties文件配置路径，上传的图片保存在 C:/images/ftp下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#搭建ftp配置的地址</div><div class="line">FTP_ADDRESS=192.168.1.108</div><div class="line">FTP_PORT=21</div><div class="line">FTP_USERNAME=shenImg</div><div class="line">FTP_PASSWORD=123456</div><div class="line">FTP_BASE_PATH=/ftp</div><div class="line">IMAGE_BASE_URL=http://127.0.0.1:8089/ftp</div></pre></td></tr></table></figure></p>
<p>打开新增商品页面，测试结果<br><img src="http://img.blog.csdn.net/20161003135637580" alt="这里写图片描述"><br>在图片服务器根据规则生成的文件路径和图片文件<br><img src="http://img.blog.csdn.net/20161003135754701" alt="这里写图片描述"><br>后台系统其他业务纯增删改构造数据的东西没什么好看的，根据视频教程和文档跑一遍就行。<br>二、前台工程的搭建<br>教程里采用的是前台系统和服务层分开，以降低系统的耦合度。<br><img src="http://img.blog.csdn.net/20161003165655264" alt="这里写图片描述"><br>1、首先搭建服务层taotao-rest，在webservice框架方面，还是直接使用springMvc，此工程依赖于taotao-manager-pojo和taotao-manager-mapper，根据依赖关系，先将taotao-manager安装到本地仓库方便依赖。<br>同样配置tomcat插件，使用不同端口模拟，与manager工程区别开来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;build&gt;</div><div class="line">	&lt;!-- 配置插件 --&gt;</div><div class="line">	&lt;plugins&gt;</div><div class="line">		&lt;plugin&gt;</div><div class="line">			&lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;</div><div class="line">			&lt;configuration&gt;</div><div class="line">				&lt;port&gt;8081&lt;/port&gt;</div><div class="line">				&lt;path&gt;/&lt;/path&gt;</div><div class="line">			&lt;/configuration&gt;</div><div class="line">		&lt;/plugin&gt;</div><div class="line">	&lt;/plugins&gt;</div><div class="line">&lt;/build&gt;</div></pre></td></tr></table></figure></p>
<p>2、搭建taotao-portal前台门户工程，同样配置tomcat插件，端口设为8082。前台工程的所有数据都是从服务层工程taotao-rest获取的，既有ajax动态请求，又使用httpclient从服务层获取数据。<br>(1)教程中taotao-portal和taotao-rest工程端口不同，进行ajax请求存在跨域问题，使用$.getJSONP()可解决问题。如下测试方法，获取的数据是商品的分类，请求url是<span>htt p://localhost:8081/rest/itemcat/list?callback=getData </span><br>回调方法为getData，参数data则为获取到的数据对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(function()&#123;</div><div class="line">	$.getJSONP(&quot;http://localhost:8081/rest/itemcat/list?callback=getData&quot;);</div><div class="line">&#125;);</div><div class="line">function getData(data)&#123;</div><div class="line">	alert(data);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在浏览器输入地址测试<br><img src="http://img.blog.csdn.net/20161005002553824" alt="这里写图片描述"></p>
<p>(2)若是需要在进入页面就获取到数据渲染，而不是通过ajax动态请求，则需要在进入页面就获取到需要的数据。这时可在portal工程controller层通过httpclient请求服务层数据。<br>httpclient以其易用性和灵活性，使得客户端发送Http请求变得容易，而且也方便了开发人员测试接口（基于Http协议的），即提高了开发的效率，也方便提高代码的健壮性。<br>测试请求可使用谷歌浏览器商店的postman，比较好用。<br>测试请求大广告的数据示例<br><img src="http://img.blog.csdn.net/20161005004026876" alt="这里写图片描述"></p>
<p>这部分主要是分析系统，如何将大的系统工程进行分割简化，各个工程之间如何进行通讯，使用接口的方式进行数据调用，让各个工程互不干扰，可同时进行开发。主要知识：搭建图片服务器，$.getJSONP()和httpclient两种数据请求方式。</p>
<p>centos虚拟机下安装Nginx <a href="http://blog.csdn.net/u012809062/article/details/70307130" target="_blank" rel="external">http://blog.csdn.net/u012809062/article/details/70307130</a></p>
]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(2)——后台系统搭建]]></title>
      <url>/2016/09/29/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E%E7%9A%84%E5%AE%9E%E8%B7%B5(2)%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/</url>
      <content type="html"><![CDATA[<p>前言：在这里记录在项目开发中的要点，对原网上的源码进一步优化和修改一些错误，对于开发过程中的一些冗长讲解不进行详细的分析，比如接下来的工程创建等等。<br>一、工程创建<br>1、系统工程使用Maven构建工具创建，工程之间的依赖关系如下<br><a id="more"></a><br><img src="http://img.blog.csdn.net/20160929110316423" alt="这里写图片描述"></p>
<p>跟着视频教程和源码资料创建工程，视频已经讲得非常详细这里就不多说。<br>如上图taotao-parent是一个pom类型父工程，用来管理依赖的jar包的版本，全局级别。<br>原网上的源码pom.xml中有些jar包配置存在错误，如果在构建完工程报jar包相关错误请检查配置。<br>例如原先commons-io的groupId就错了，应该是commons-io，在运行打包时就会报错。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">错误</div><div class="line">&lt;dependency&gt;</div><div class="line">	&lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</div><div class="line">	&lt;artifactId&gt;commons-io&lt;/artifactId&gt;</div><div class="line">	&lt;version&gt;$&#123;commons-io.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">正确</div><div class="line">&lt;dependency&gt;</div><div class="line">	&lt;groupId&gt;commons-io&lt;/groupId&gt;</div><div class="line">	&lt;artifactId&gt;commons-io&lt;/artifactId&gt;</div><div class="line">	&lt;version&gt;$&#123;commons-io.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>
<p>各种jar包的maven配置可以去<a href="http://mvnrepository.com/" target="_blank">maven repository</a> 网站查找，搜素需要的jar包，选择对应的版本就有相应的maven配置。例：<br><img src="http://img.blog.csdn.net/20160929113145796" alt="这里写图片描述"><br>自己重新排查了一遍，有些jar包因为本地仓库已经有了别的版本号文件，所以改了版本号不必重新下载。Spring用了4.3.0-release版，mybatis用了3.3.0版。</p>
<p> 2、taotao-common工程是用来存放各种自封装或其他来源的工具类，jar工程，最终打包成jar文件，给其他工程调用，需要调用的工程要依赖此工程。<br> 3、 创建聚合工程taotao-manager，pom类型，然后在工程下创建pojo实体类、mapper接口、service层， controller层对应的module模块工程。所有模块均依赖taotao-common工程，其中taotao-manager-mapper还依赖taotao-manager-pojo；taotao-manager-service还依赖taotao-manager-mapper和taotao-manager-pojo；taotao-manager-controller则manager其他模块都依赖。<br> 在Maven Dependencies目录下可以看到工程或模块依赖的jar包和工程。<br> <img src="http://img.blog.csdn.net/20160929115928354" alt="这里写图片描述"><br>  &nbsp;&nbsp;&nbsp;<img src="http://img.blog.csdn.net/20160929115946776" alt="taotao-manager-web依赖的jar包和工程模块"></p>
<p>3、在generatorSqlmapCustom工程配置数据库链接，使用mybatis逆向工程自动生成pojo类和mapper文件（逆向工程在度盘资源，第二天：框架整合，框架系统搭建文件夹中的参考资料压缩包中，包括数据库的sql，直接导入到本地数据库就行），生成的pojo类和mapper接口和xml复制到对应的工程下面。<br><img src="http://img.blog.csdn.net/20160929120908733" alt="这里写图片描述"></p>
<p>4、Spring、Mybatis和SpringMvc整合<br>框架整合配置xml文件和web.xml都在taotao-manager-web模块下进行配置，照着资料就行，不啰嗦<br><img src="http://img.blog.csdn.net/20160929164720171" alt="这里写图片描述"><br>事实Spring的三个applicationContext没必要分开，直接一个就行，当然，分开找起来比较容易，目的明确。</p>
<p>5、运行及简单测试工程。<br>(1)安装tomcat插件和依赖工程到maven仓库<br>    工程运行采用的是maven的tomcat插件，需要在taotao-parent工程的pom.xml进行配置，顺便指定jdk版本等其他配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;build&gt;</div><div class="line">	&lt;finalName&gt;$&#123;project.artifactId&#125;&lt;/finalName&gt;</div><div class="line">	&lt;plugins&gt;</div><div class="line">		&lt;!-- 资源文件拷贝插件 --&gt;</div><div class="line">		&lt;plugin&gt;</div><div class="line">			&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;2.7&lt;/version&gt;</div><div class="line">			&lt;configuration&gt;</div><div class="line">				&lt;encoding&gt;UTF-8&lt;/encoding&gt;</div><div class="line">			&lt;/configuration&gt;</div><div class="line">		&lt;/plugin&gt;</div><div class="line">		&lt;!-- java编译插件 --&gt;</div><div class="line">		&lt;plugin&gt;</div><div class="line">			&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;3.1&lt;/version&gt;</div><div class="line">			&lt;configuration&gt;</div><div class="line">				&lt;source&gt;1.8&lt;/source&gt;</div><div class="line">				&lt;target&gt;1.8&lt;/target&gt;</div><div class="line">				&lt;encoding&gt;UTF-8&lt;/encoding&gt;</div><div class="line">			&lt;/configuration&gt;</div><div class="line">		&lt;/plugin&gt;</div><div class="line">	&lt;/plugins&gt;</div><div class="line">	&lt;pluginManagement&gt;</div><div class="line">		&lt;plugins&gt;</div><div class="line">			&lt;!-- 配置Tomcat插件 --&gt;</div><div class="line">			&lt;plugin&gt;</div><div class="line">				&lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;</div><div class="line">				&lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;</div><div class="line">				&lt;version&gt;2.2&lt;/version&gt;</div><div class="line">			&lt;/plugin&gt;</div><div class="line">		&lt;/plugins&gt;</div><div class="line">	&lt;/pluginManagement&gt;</div><div class="line">&lt;/build&gt;</div></pre></td></tr></table></figure></p>
<p>由于项目工程的jar版本都依赖taotao-parent工程，所以需要先将taotao-parent工程安装到本地maven仓库中，同样的，taotao-common也要安装到maven仓库中。安装方法：右键工程run as—maven install，执行完毕会在当前系统用户文件夹的.m2文件夹下面看到安装的taotao-parent和taotao-common<br><img src="http://img.blog.csdn.net/20160929152056555" alt="这里写图片描述"></p>
<p>(2)打包和运行<br>我们最终发布出去放到服务器上的是war包，即taotao-manager-web模块的war包，直接对聚合工程taotao-manager打包，会自动对工程下的模块的jar或war模块进行打包，最终发布的是taotao-manager-web下的war包。操作:右键run as -maven build ，选第二个（第一次选第一个也行），在 Goals一栏输入clean package，点击run即可。<br><img src="http://img.blog.csdn.net/20160929152724033" alt="执行成功的信息"></p>
<p>这里需要注意的地方是mapper模块是打成jar包的，默认不包含mybatis的映射xml文件，需要在taotao-manager-mapper的pom.xml文件加上以下配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 如果不添加此节点mybatis的mapper.xml文件都会被漏掉。 --&gt;</div><div class="line">	&lt;build&gt;</div><div class="line">		&lt;resources&gt;</div><div class="line">			&lt;resource&gt;</div><div class="line">				&lt;directory&gt;src/main/java&lt;/directory&gt;</div><div class="line">				&lt;includes&gt;</div><div class="line">					&lt;include&gt;**/*.properties&lt;/include&gt;</div><div class="line">					&lt;include&gt;**/*.xml&lt;/include&gt;</div><div class="line">				&lt;/includes&gt;</div><div class="line">				&lt;filtering&gt;false&lt;/filtering&gt;</div><div class="line">			&lt;/resource&gt;</div><div class="line">		&lt;/resources&gt;</div><div class="line">	&lt;/build&gt;</div></pre></td></tr></table></figure></p>
<p>运行或调试命令:右键taotao-manager工程run as 选第二项，在在 Goals一栏输入clean tomcat7:run，然后点击run即可。<br>调试时若提示找不到源文件，手动添加即可，可以在提示界面直接选择添加，也可以入下图在debug或run按钮的debug/run Configurations里面的Source选项卡进行配置，将需要的工程添加进去<br><img src="http://img.blog.csdn.net/20160929163345262" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20160929163359823" alt="这里写图片描述"></p>
<p>测试结果,浏览器访问index.jsp<br><img src="http://img.blog.csdn.net/20160929163617250" alt="这里写图片描述"></p>
<p>访问测试controller请求，查询数据库商品<br><img src="http://img.blog.csdn.net/20160929163800184" alt="这里写图片描述"></p>
<p>重新整理的工程源码<a href="http://download.csdn.net/detail/u012809062/9643235" target="_blank">点击下载</a></p>
]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[商城的实践(1)——说明篇]]></title>
      <url>/2016/09/29/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E%E7%9A%84%E5%AE%9E%E8%B7%B5(1)%E2%80%94%E2%80%94%E8%AF%B4%E6%98%8E%E7%AF%87/</url>
      <content type="html"><![CDATA[<p>   之前在贴吧看到有吧友分享这个淘淘商城的项目，简单看了下介绍原来是培训机构的一个培训项目，虽然是培训的教学项目，但从工程的基础架构创建到各种框架的整合，以及结合了许多常用的web技术，没有具体特别深入单一技术的研究，但整个项目可谓面面俱到，各种功能都有。正因为如此，这个项目用来简单了解各种技术在开发中的应用与结合，积累基础知识确实很有用处。<br>        本人今年刚毕业，在校一直学的是嵌入式方面的知识，在参加工作时才刚转的JavaWeb开发，对java开发的了解还停留在基础阶段，知识积累远远不够。因此，这段时间打算看看这个商城项目，希望有所受益。<br>        商城项目包括后台的CMS系统，到前台页面的商品展示页面，串通从发布商品到下单支付购买的整个流程（支付貌似没有，后面尝试加上），基本的商城功能都有了。手动实现一遍整个项目估计需要不少时间，介绍先到这里，开始搭框架。</p>
<p>吧友给的资料分享链接：<a href="http://pan.baidu.com/s/1jI36OGe" target="_blank">度盘链接</a>提取密码：7wfj</p>
]]></content>
      
        
        <tags>
            
            <tag> 商城技术应用 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[继承、多态、封装、抽象类与接口]]></title>
      <url>/2016/09/05/%E7%BB%A7%E6%89%BF%E3%80%81%E5%A4%9A%E6%80%81%E3%80%81%E5%B0%81%E8%A3%85%E3%80%81%E6%8A%BD%E8%B1%A1%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3/</url>
      <content type="html"><![CDATA[<p>作为一门面向对象语言，继承和多态是Java重要的特性。继承封装了一些公共特性，实现代码复用，减少代码冗余；多态可以动态调整对象的调用，降低对象之间的依存关系；接口是一种规范，可以通过接口实现多继承的功能。<br>一、继承<br>     利用继承，人们可以基于已存在的类构造一个新类。继承已存在的类就是复用（继承）这些类的方法和域。在此基础上，还可以添加一些新的方法和域，以满足新的需求。这是Java程序设计中的一项核心技术。[java核心技术]<br>     新建一个人物父类<a id="more"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;</div><div class="line"></div><div class="line">	private int age;</div><div class="line">	private String name;</div><div class="line">	</div><div class="line">	public Person(int age, String name)&#123;</div><div class="line">		this.age = age;</div><div class="line">		this.name = name;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public void info()&#123;</div><div class="line">		System.out.println(age);</div><div class="line">		System.out.println(name);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Teacher子类继承Person父类，关键字extends表示继承，extends表明正在构造的新类派生于一个已存在的类。已存在的类被称为超类（superclass）、基类（base class）或父类（parent class）；新类被称为子类（subclass）、派生类（derived class）或孩子类（child class）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">public class Teacher extends Person &#123;</div><div class="line"></div><div class="line">	//默认实现无参构造并可以不写，如果父类存在带参构造，则需要显式实现此构造</div><div class="line">	public Teacher(int age, String name) &#123;</div><div class="line">		super(22, &quot;shen&quot;);</div><div class="line">		// TODO Auto-generated constructor stub</div><div class="line">		super.info();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//重写父类方法</div><div class="line">	@Override</div><div class="line">	public void info()&#123;</div><div class="line">		System.out.println(&quot;rewrite...&quot;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		Teacher t = new Teacher(20, &quot;tutu&quot;);</div><div class="line">		t.info();//子类拥有所有父类的成员变量，但private的成员变量没有访问权限</div><div class="line">		//t.age//private变量不可访问</div><div class="line">		</div><div class="line">	&#125;	</div><div class="line">&#125;</div><div class="line">输出结果：</div><div class="line">22</div><div class="line">shen</div><div class="line">rewrite...</div></pre></td></tr></table></figure>
<p>二、多态<br>实现多态有三个条件：要有继承、要有重写、父类引用指向子类对象。<br>父类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public class Animal &#123;</div><div class="line">	public void eat()&#123;</div><div class="line">		System.out.println(&quot;eat food&quot;);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public void walk()&#123;</div><div class="line">		System.out.println(&quot;walk alone&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>子类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">public class Dog extends Animal &#123;</div><div class="line">	//重写父类方法</div><div class="line">	@Override</div><div class="line">	public void eat()&#123;</div><div class="line">		System.out.println(&quot;eat bone&quot;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public void walk(String dog1)&#123;</div><div class="line">		dog1 = &quot;tom&quot;;</div><div class="line">		System.out.println(&quot;walk with &quot; + dog1);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		Animal dog = new Dog();//向上转型，父类引用指向子类对象</div><div class="line">		dog.eat();</div><div class="line">		dog.walk();</div><div class="line">		//dog.walk(&quot;jane&quot;);//只能调用父类存在的方法</div><div class="line">		</div><div class="line">		Dog dd = (Dog)dog;//向下转型</div><div class="line">		dd.walk();</div><div class="line">		dd.walk(&quot;jane&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">输出结果：</div><div class="line">eat bone</div><div class="line">walk alone</div><div class="line">walk alone</div><div class="line">walk with tom</div></pre></td></tr></table></figure>
<p>多态可以使程序有良好的扩展，并可以对所有类的对象进行通用处理。<br>三、封装<br>在面向对象程式设计方法中，封装指一种将抽象性函式接口的实作细节部份包装、隐藏起来的方法。通常都使用getter和setter方法来实现，其他类要访问本类的私有成员变量都需要通过getter和setter方法。<br>例<br>实体类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;</div><div class="line"></div><div class="line">	private int age;</div><div class="line">	private String name;</div><div class="line">	public int getAge() &#123;</div><div class="line">		return age;</div><div class="line">	&#125;</div><div class="line">	public void setAge(int age) &#123;</div><div class="line">		this.age = age;</div><div class="line">	&#125;</div><div class="line">	public String getName() &#123;</div><div class="line">		return name;</div><div class="line">	&#125;</div><div class="line">	public void setName(String name) &#123;</div><div class="line">		this.name = name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>测试类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">public class Test &#123;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		Person t = new Person();</div><div class="line">		t.setAge(20);</div><div class="line">		t.setName(&quot;shen&quot;);</div><div class="line">		</div><div class="line">		System.out.println(&quot;Age:&quot; + t.getAge() + &quot; name:&quot; + t.getName());</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div><div class="line">输出：</div><div class="line">Age:20 name:shen</div></pre></td></tr></table></figure>
<p>四、抽象与接口<br>1、我们知道，在面向对象世界中，所有的对象都是通过类来描述的，但是并不是所有的类都是来描述对象的。如果一个类没有足够的信息来描述一个具体的对象，而需要其他具体的类来支撑它，那么这样的类我们称它为抽象类。<br>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public abstract class Animal &#123;</div><div class="line">	</div><div class="line">	private String name;</div><div class="line">	private float weight;</div><div class="line">	</div><div class="line">	public Animal(String name, float weight)&#123;</div><div class="line">		this.name = name;</div><div class="line">		this.weight = weight;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	abstract void run();//抽象类不一定有抽象方法，但包含抽象方法的类一定要被声明为抽象类</div><div class="line">	</div><div class="line">	public void eat()&#123;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>继承：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public class Cat extends Animal&#123;</div><div class="line">	</div><div class="line">	public Cat(String name, float weight) &#123;</div><div class="line">		super(name, weight);</div><div class="line">		// TODO Auto-generated constructor stub</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//覆盖抽象方法</div><div class="line">	@Override</div><div class="line">	void run() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line">		System.out.println(&quot;run fast&quot;);</div><div class="line">	&#125;</div><div class="line">		</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		//Animal cat = new Animal(&quot;tom&quot;, 20f);//错误,抽象类不能实例化</div><div class="line">		Cat cat = new Cat(&quot;tom&quot;, 20f);</div><div class="line">		cat.run();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>另注：<br>如果一个类包含抽象方法，那么该类必须是抽象类。<br>任何子类必须重写父类的抽象方法，或者声明自身为抽象类。<br>2、接口<br>接口是抽象方法的集合。接口并不是类，一个类通过继承接口的方式，从而来继承接口的抽象方法。<br>实现接口必须覆盖全部抽象方法，跟抽象类相似。但是java中不能通过extends实现多继承，可以通过实现多个接口来达到多继承的目的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public interface Person &#123;</div><div class="line">	public void eat();</div><div class="line">	public void say();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class Student implements Person &#123;</div><div class="line">	@Override</div><div class="line">	public void eat() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	@Override</div><div class="line">	public void say() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注：<br>接口是隐式抽象的，当声明一个接口的时候，不必使用abstract关键字。<br>接口中每一个方法也是隐式抽象的，声明时同样不需要abstract关键子。<br>接口中的方法都是公有的。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[集合]]></title>
      <url>/2016/08/13/%E9%9B%86%E5%90%88/</url>
      <content type="html"><![CDATA[<p><strong>一、概述</strong><br>    集合框架是Java一块很重要的内容，对常用的数据结构做了规范和实现。对象封装了数据，许多对象则构成了所谓集合。Java集合类库构成了集合类的框架。它为集合的实现者定义了大量的接口和抽象类，并且对其中的某些机制给予了描述。<br>    集合框架的接口和实现类：<br>    <img src="http://img.blog.csdn.net/20160818005915689" alt="集合框架的接口和实现类"><br>    <a id="more"></a><br><strong>二、Iterator接口</strong><br>Iterator接口与Collection系列、Map系列的集合不一样：Collection系列集合、Map系列集合主要用于盛装其他对象，而Iterator则主要用于遍历（即迭代访问）Collection集合中的元素，Iterator对象也被称为迭代器。[<a href="http://www.cnblogs.com/lixiaolun/p/4320771.html" target="_blank">引</a>]<br>Iterator接口定义了四个方法<br>–boolean hasNext()：如果被迭代的集合还元素没有被遍历，则返回true。<br>–Object next()：返回集合里下一个元素。<br>–void remove() ：删除集合里上一次next方法返回的元素<br>–void forEachRemaining(Consumer action)：这是Java 8为Iterator新增的默认方法，该方法可使用Lambda表达式来遍历集合元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc Iterator接口</div><div class="line"> * @date 2016年8月23日</div><div class="line"> */</div><div class="line">public class IteratorTest &#123;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		//Iterator是Collection父接口，可如此创建集合</div><div class="line">		Collection&lt;Object&gt; animals = new HashSet&lt;&gt;();</div><div class="line">		</div><div class="line">		//添加元素</div><div class="line">		animals.add(&quot;cat&quot;);</div><div class="line">		animals.add(&quot;dog&quot;);</div><div class="line">		animals.add(&quot;pig&quot;);</div><div class="line">		</div><div class="line">		//使用Lambda表达式遍历集合(java1.8新特性)</div><div class="line">		animals.forEach(obj -&gt; System.out.println(&quot;Lambda迭代输出：&quot; + obj));</div><div class="line">		</div><div class="line">		//iterator()方法获取迭代器</div><div class="line">		Iterator&lt;Object&gt; data = animals.iterator();</div><div class="line">		while(data.hasNext())&#123;</div><div class="line">			Object subData = data.next();</div><div class="line">			if(&quot;cat&quot;.equals(subData))&#123;</div><div class="line">				data.remove();//移除元素</div><div class="line">			&#125;</div><div class="line">			System.out.println(&quot;迭代器输出：&quot; + subData);</div><div class="line">        &#125;</div><div class="line">		System.out.println(animals);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出：<br><img src="http://img.blog.csdn.net/20160823143351810" alt="这里写图片描述"></p>
<p><strong>三、Collection接口</strong><br>        Collection不提供接口的任何直接实现，一个Collection代表一组Object，但它提供更加具体的子接口如List和Set，而继承自它们的 ArrayList, Vector, HashTable, HashMap等实现类才可被实例化。<br>1、List接口<br>List是一个有序集合（ordered collection）。元素可以添加到容器中某个特定的位置。将对象放置在某个位置上可以采用两种方式：使用整数索引或使用列表迭代器。[引 java核心技术]<br>List接口实现类主要有：ArrayList、Vector、LinkedList。<br>(1)ArrayList<br>ArrayList是List接口的可变数组的实现，其操作基本是对数组的操作，ArrayList是线程不安全的。<br>ArrayList包装了许多的方法，包括元素的增加移除、插入移动、转换数组等等：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc</div><div class="line"> * @date 2016年8月23日</div><div class="line"> */</div><div class="line">public class ListTest &#123;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line"></div><div class="line">		List&lt;String&gt; list = new ArrayList&lt;String&gt;();</div><div class="line">		list.add(&quot;1&quot;);//使用list时默认长度置为10</div><div class="line">		list.add(&quot;2&quot;);</div><div class="line">		list.add(&quot;3&quot;);</div><div class="line">		list.add(&quot;4&quot;);</div><div class="line">		list.add(&quot;5&quot;);</div><div class="line">		</div><div class="line">		System.out.println(&quot;list输出：&quot;+list);</div><div class="line">		list.remove(4);//移除元素</div><div class="line">		System.out.println(&quot;移除元素之后的list：&quot;+list);</div><div class="line">		Object[] arr = list.toArray();//转换为数组</div><div class="line">		System.out.println(&quot;数组元素输出：&quot;+arr[0]);</div><div class="line">		</div><div class="line">		List&lt;String&gt; c = new ArrayList&lt;&gt;(4);//预计有4个元素而创建</div><div class="line">		c.add(&quot;6&quot;);</div><div class="line">		c.add(&quot;7&quot;);</div><div class="line">		c.add(&quot;8&quot;);</div><div class="line">		c.add(&quot;9&quot;);</div><div class="line">		</div><div class="line">		c.add(&quot;10&quot;);//超过5个元素list会增加原来长度一半个元素,目前即长度为6</div><div class="line">		list.addAll(c);//增加一组数据,数据类型应相同</div><div class="line">		System.out.println(list);</div><div class="line">		</div><div class="line">		Iterator&lt;String&gt; data = list.iterator();//获取迭代器</div><div class="line">		System.out.println(&quot;迭代输出：&quot;);</div><div class="line">		data.forEachRemaining(action -&gt; System.out.print(action+&quot; &quot;));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出：<br><img src="http://img.blog.csdn.net/20160823143916449" alt="这里写图片描述"><br>ArrayList的各种操作虽然很方便，但是ArrayList的插入和删除，会导致内部数据大量移位，而扩容则需要新建一个ArrayList将原来的数据复制过去,会影响性能。如果我们已经知道需要的元素个数，我们可以初始化时指定ArrayList的容量，这样可以有效的避免数组多次扩充，从而提高效率。<br>(2)Vector<br>Vector类提供了实现可增长数组的功能，随着更多元素加入其中，数组变的更大。在删除一些元素之后，数组变小,而不像ArrayList的扩容方式，基本用法与ArrayList相同。Vector是同步类，是线程安全的。<br>(3)LinkedList<br>LinkedList是list的链表实现，列表中的每个节点都包含了对前一个和后一个元素的引用，除了大部分与ArrayList相同的方法，LinkedList还有一些其特有的方法，并且LinkedList在添加和删除元素时具有比ArrayList更好的性能，但在get数据时更慢。LinkedList适用于没有大规模的随机读取，大量的增加/删除操作。[<a href="http://blog.csdn.net/renfufei/article/details/17077425" target="_blank" rel="external">引</a>]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class LinkTest &#123;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		LinkedList&lt;String&gt; link = new LinkedList&lt;&gt;();</div><div class="line">		link.add(&quot;a&quot;);</div><div class="line">		link.add(&quot;b&quot;);</div><div class="line">		link.add(&quot;c&quot;);</div><div class="line">		link.add(&quot;d&quot;);</div><div class="line">		link.add(&quot;e&quot;);</div><div class="line">		System.out.println(&quot;第一个元素：&quot;+link.getFirst()+&quot;  最后一个元素：&quot;+link.getLast());</div><div class="line">		</div><div class="line">		link.remove(1);</div><div class="line">		System.out.println(link);</div><div class="line">		</div><div class="line">		link.add(3, &quot;zhiding&quot;);</div><div class="line">		System.out.println(link);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出：<br><img src="http://img.blog.csdn.net/20160823164333523" alt="这里写图片描述"></p>
<p>2、Set接口<br>由于Set接口提供的数据结构是数学意义上集合概念的抽象，因此它需要支持对象的添加、删除，而不需提供随机访问。Set具有与Collection完全一样的接口，因此没有任何额外的功能。实际上Set就是Collection，只是行为不同。Set不包含重复的元素。<br>Set的实现类主要有：HashSet，TreeSet，LinkedHashSet<br>(1)HashSet<br>不保证set的迭代顺序，不保证该顺序永恒不变，因此HashSet也没有get方法。此类允许使用null元素，底层是使用HashMap实现的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		HashSet&lt;String&gt; set = new HashSet&lt;&gt;();</div><div class="line">		set.add(&quot;adf&quot;);</div><div class="line">		set.add(&quot;bhf&quot;);</div><div class="line">		set.add(&quot;c32&quot;);</div><div class="line">		set.add(&quot;c32&quot;);//有重复元素，添加不了</div><div class="line">		set.add(null);//null也只允许只有一个</div><div class="line">		System.out.println(set);</div><div class="line">		</div><div class="line">		for(String str : set)&#123;</div><div class="line">			System.out.print(str +&quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		System.out.println();</div><div class="line">		Iterator&lt;String&gt; iterator = set.iterator();</div><div class="line">		while(iterator.hasNext())&#123;</div><div class="line">			String data = iterator.next();</div><div class="line">			System.out.print(data +&quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">输出：</div><div class="line">[null, bhf, adf, c32]</div><div class="line">null bhf adf c32 </div><div class="line">null bhf adf c32</div></pre></td></tr></table></figure>
<p>(2)TreeSet<br>TreeSet元素自然排序，底层是使用TreeMap实现的，自定义要显示Comparable接口。TreeSet可以给集合中的元素进行指定方式的排序，保证元素唯一性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc 测试类，实现Comparable&lt;T&gt;接口</div><div class="line"> * @date 2016年8月24日</div><div class="line"> */</div><div class="line">public class User implements Comparable&lt;User&gt;&#123;</div><div class="line">	</div><div class="line">	private String name;</div><div class="line">	private int age;</div><div class="line">	</div><div class="line">	//构造</div><div class="line">	public User(String name,int age)&#123;</div><div class="line">		this.name = name;</div><div class="line">		this.age = age;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//实现类</div><div class="line">	@Override</div><div class="line">	public int compareTo(User user) &#123;  </div><div class="line">        if(user == null)  </div><div class="line">            throw new NullPointerException();  </div><div class="line">        if(this.age &gt; user.age)  </div><div class="line">            return 1;  </div><div class="line">        if(this.age &lt; user.age)  </div><div class="line">            return -1;  </div><div class="line">        return 0;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">	//重写toString</div><div class="line">	@Override</div><div class="line">	public String toString() &#123;</div><div class="line">		return &quot;User [name=&quot; + name + &quot;, age=&quot; + age + &quot;]&quot;;</div><div class="line">	&#125;  </div><div class="line">&#125;</div><div class="line"></div><div class="line">//测试</div><div class="line">public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		Set&lt;User&gt; set = new TreeSet&lt;User&gt;();</div><div class="line">		</div><div class="line">		User user1 = new User(&quot;Tom&quot;, 20);</div><div class="line">		User user2 = new User(&quot;Jack&quot;, 21);</div><div class="line">		User user3 = new User(&quot;Dave&quot;, 22);</div><div class="line">		User user4 = new User(&quot;Jane&quot;, 12);</div><div class="line">		</div><div class="line">		set.add(user1);</div><div class="line">		set.add(user1);//重复，添加不了</div><div class="line">		set.add(user2);</div><div class="line">		set.add(user3);</div><div class="line">		set.add(user4);</div><div class="line">		</div><div class="line">		System.out.println(&quot;按年龄大小输出：&quot;);</div><div class="line">		System.out.println(set);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">输出</div><div class="line">按年龄大小输出：</div><div class="line">[User [name=Jane, age=12], User [name=Tom, age=20], User [name=Jack, age=21], User [name=Dave, age=22]]</div></pre></td></tr></table></figure>
<p>(3)LinkedHashSet<br>LinkedHashSet集合同样是根据元素的hashCode值来决定元素的存储位置，但是它同时使用链表维护元素的次序。这样使得元素看起 来像是以插入顺序保存的，也就是说，当遍历该集合时候，LinkedHashSet将会以元素的添加顺序访问集合的元素。<br>LinkedHashSet在迭代访问Set中的全部元素时，性能比HashSet好，但是插入时性能稍微逊色于HashSet。[<a href="http://www.cnblogs.com/Terry-greener/archive/2011/12/02/2271707.html" target="_blank">引</a>]</p>
<p><strong>四、Map接口</strong><br>在Collection实现中保存的直接是一个个对象，二在Map实现中保存的是一对对象，以键值对key-value的方式关联着。Map的常用实现类有HashMap，HashTabel和TreeMap。<br>1、HashMap<br>HashMap是基于哈希表的Map接口的非同步实现，其中元素表现无序，特别是它不保证该顺序恒久不变。HashMap会利用对象的hashCode来快速找到key。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		//使用实现类创建，键值指定对象类型</div><div class="line">		HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();</div><div class="line">		map.put(&quot;name&quot;, &quot;shen&quot;);</div><div class="line">		map.put(&quot;age&quot;, &quot;20&quot;);</div><div class="line">		map.put(&quot;age&quot;, &quot;19&quot;);//相同键多次存入数据覆盖</div><div class="line">		map.put(&quot;weight&quot;, &quot;100&quot;);</div><div class="line">		map.put(null, &quot;空&quot;);//允许空键值</div><div class="line">		map.put(null, null);</div><div class="line">		System.out.println(map);</div><div class="line">		</div><div class="line">		//对map集合的遍历，可取出具体的键和对应值</div><div class="line">		for(Entry&lt;String, String&gt; element:map.entrySet())&#123;</div><div class="line">			String key = element.getKey();</div><div class="line">			String value = element.getValue();</div><div class="line">			Class&lt;? extends Entry&gt; classData = element.getClass();</div><div class="line">			System.out.println(key + &quot;---- &quot; + value + &quot;---- &quot; + classData.getName());</div><div class="line">		&#125;</div><div class="line">				</div><div class="line">		//使用接口创建，不关心具体实现，只有在使用才具体实现</div><div class="line">		//键值的值一般设为Object，不关心什么类型的数据，当然，获取需要具体数据类型或对象需要转化</div><div class="line">		Map&lt;String, Object&gt; mapData = null;//new HashMap&lt;&gt;();</div><div class="line">		mapData = new HashMap&lt;&gt;();</div><div class="line">		mapData.put(&quot;name&quot;, &quot;Jack&quot;);</div><div class="line">		mapData.put(&quot;age&quot;, 21);</div><div class="line">		mapData.put(&quot;weight&quot;, 110.5);</div><div class="line">		System.out.println(mapData);</div><div class="line">		System.out.println(&quot;获取name值:&quot; + mapData.get(&quot;name&quot;));</div><div class="line">		Set&lt;String&gt; keys = mapData.keySet();</div><div class="line">		System.out.println(&quot;获取所有key:&quot; + keys);</div><div class="line">		Collection&lt;Object&gt; values = mapData.values();</div><div class="line">		System.out.println(&quot;获取所有value:&quot; + values);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">输出：</div><div class="line">&#123;null=null, name=shen, weight=100, age=19&#125;</div><div class="line">null---- null---- java.util.HashMap$Node</div><div class="line">name---- shen---- java.util.HashMap$Node</div><div class="line">weight---- 100---- java.util.HashMap$Node</div><div class="line">age---- 19---- java.util.HashMap$Node</div><div class="line">&#123;name=Jack, weight=110.5, age=21&#125;</div><div class="line">获取name值:Jack</div><div class="line">获取所有key:[name, weight, age]</div><div class="line">获取所有value:[Jack, 110.5, 21]</div></pre></td></tr></table></figure></p>
<p>2、HashTabel<br>HashTable在很大程度事实上和HashMap的实现差不多，主要区别是HashMap采用异步处理方式，性能更高，而HashTabel采用同步处理方式，性能较低。HashTabel属于线程安全类而HashMap属于线程不安全类。[<a href="http://blog.csdn.net/hanshileiai/article/details/6754808" target="_blank">参考</a>]</p>
<p>3、TreeMap<br>TreeMap是可排序的Map集合按照集合中的key进行排序，key不允许重复。TreeMap是红黑树基于Map接口的实现。<a href="http://blog.csdn.net/chenssy/article/details/26668941" target="_blank">关于TreeMap红黑树参考</a>,初次接触不容易理解，多查资料。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[字符相关]]></title>
      <url>/2016/07/09/%E5%AD%97%E7%AC%A6%E7%9B%B8%E5%85%B3/</url>
      <content type="html"><![CDATA[<p>一、字符类型<br>char是Java的一种基本数据类型，也是Java中的保留字。char在Java中占两个字节，无符号类型，是16位二进制Unicode字符。<br>char是类型表示的是字符，不是字符串；<br>char类型变量值只能用单引号来表示，不可使用双引号；<br>即表示单引号内的单个字符。<a id="more"></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc char test</div><div class="line"> * @date 2016年7月15日</div><div class="line"> */</div><div class="line">public class CharTest &#123;</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		//单引号内的单个字符</div><div class="line">		char test = &apos;C&apos;;</div><div class="line">		System.out.println(test);</div><div class="line">		</div><div class="line">		//数组</div><div class="line">		char cha[] = &#123;&apos;J&apos;,&apos;a&apos;,&apos;v&apos;,&apos;a&apos;&#125;;</div><div class="line">		System.out.println(cha);</div><div class="line">		</div><div class="line">		//Unicode编码，每一个字符用16位2进制数标识</div><div class="line">		char ucode = &apos;\u4F60&apos;;//20320</div><div class="line">		char hao = &apos;\u597d&apos;;//22909</div><div class="line">		</div><div class="line">		System.out.print(ucode);</div><div class="line">		System.out.println(hao);</div><div class="line">		</div><div class="line">		//转换成的对应值</div><div class="line">		System.out.println( ucode + hao);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">由于其编码方式，编码方式最多有65536种，远不足以使用，以及在数据库存储的一些问题，在一般情况下，char在java中的实际使用比较少，也并不推荐使用。</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20160720005324976" alt="这里写图片描述"></p>
<p>二、字符串类<br>1、String<br>(1)String类表示字符串，是字符串常量<a style="font-size:2px" href="http://baike.baidu.com/link?url=oXsjqHFvRV9jz1IVzi2ootperjJLDiv14Bi5m3f08Pg7qy4W0PTNOBMC422g_hEFMiU-rrpGjDAGHxHgLNKpdK" target="_blank">(另:常量池)</a>，其值在创建后不能改变，因此Stirng对象创建后是不可变的，直至到被GC回收。<br>(2)创建String对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">public class StringTest &#123;</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		String str1 = &quot;Java&quot;;//直接创建</div><div class="line">		</div><div class="line">		String str2 = new String();//面向对象基本创建方法,有时浪费内存</div><div class="line">		str2 = &quot;C++&quot;;</div><div class="line">		</div><div class="line">		String str3 = new String(&quot;C&quot;);//String类提供许多构造创建方法和其他方法,详JDK源码</div><div class="line">		</div><div class="line">		System.out.println(str1+&quot;--&quot;+str2+&quot;--&quot;+str3);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>(3)常见方法<br>I.获取字符串长度与某个字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String str = &quot;Java Code&quot;;</div><div class="line">str.charAt(0);//获取某个下标对应字符</div><div class="line">str.length();//字符串长度</div></pre></td></tr></table></figure>
<p>II.str.compareTo方法<br>    该方法的作用是比较两个字符串的大小，比较的原理是依次比较每个字符的字符编码。首先比较两个字符串的第一个字符，如果第一个字符串的字符编码大于第二个的字符串的字符编码，则返回大于0的值，如果小于则返回小于0的值，如果相等则比较后续的字符，如果两个字符串中的字符编码完全相同则返回0。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String data1 = &quot;Javi&quot;;</div><div class="line">String data2  = &quot;Java&quot;;</div><div class="line">int value = data1.compareTo(data2);</div></pre></td></tr></table></figure>
<p>III.截取方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String str = &quot;Java Code&quot;;</div><div class="line">String subStr = str.substring(7);//截取得到从某个下标之后的字符串</div><div class="line">String sub = str.substring(0, 5);//截取区间之内的字符串</div></pre></td></tr></table></figure>
<p>IV.连接方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">String st1 = &quot;Java&quot;;</div><div class="line">String st2 = &quot;Code&quot;;</div><div class="line">String st = st1.concat(st2);//连接组成一个新的字符串JavaCode</div><div class="line">String stt = st1+st2;//更直接的做法JavaCode</div><div class="line">String sst = st1+007;//参与连接中有字符串按字符串连接Java007</div></pre></td></tr></table></figure>
<p>V.查找方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String str = &quot;Java Code&quot;;</div><div class="line">int i = str.indexOf(&apos;o&apos;);//某个在字符串第一次出现的下标,不存在则返回-1</div><div class="line">int j = str.indexOf(&apos;o&apos;, 7);//从第几个字符开始查,返回下标，不存在则返回-1</div></pre></td></tr></table></figure>
<p>VI.replace方法<br>    该方法的作用是替换字符串中所有指定的字符，然后生成一个新的字符串。经过该方法调用以后，原来的字符串不发生改变。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String str = &quot;Java Code&quot;;</div><div class="line">String s = str.replace(&quot;Java&quot;, &quot;C++&quot;);//把Java代替成C++</div></pre></td></tr></table></figure></p>
<p>VII.split方法<br>    以特定的分隔符分隔字符串，生成一个 数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">String data = &quot;java,c++,c,c#&quot;;</div><div class="line">String arr[] = data.split(&quot;,&quot;);</div><div class="line">for(int k = 0;k&lt;arr.length;k++)&#123;</div><div class="line">	System.out.println(arr[k]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2、Stringbuffer<br>    同样是字符串类，Stringbuffer 是字符串变量，实现方式与String有所不同，在进行处理字符串时不生成新的对象。在存储和操作字符串操作比String更合适。<br>I.字符串拼接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">StringBuffer data = new StringBuffer(&quot;The&quot;);//创建对象</div><div class="line">StringBuffer data1 = data.append(&quot; Great&quot;);//拼接方法</div><div class="line">String str = &quot; Wall&quot;;</div><div class="line">data1.append(str).append(&quot;!&quot;);</div></pre></td></tr></table></figure>
<p>II.deleteCharAt方法</p>
<p><img src="http://img.blog.csdn.net/20160724035037353" alt="这里写图片描述"><br>此外，字符串操作相关的方法还有insert插入、reverse反转倒序、setCharAt修改某个下标上的字符、trimToSize将StringBuffer对象的中存储空间缩小到和字符串长度一样的长度，减少空间的浪费。<br>3、Stringbuilder<br>    Stringbuilder和StringBuffer基本类似，相关方法也一样</p>
<p>4、String、StringBuffer和Stringbuilder的具体区别<br>[以下复制,来自其他博主总结]<br>String：字符串常量<br>StringBuffer：字符创变量，线程安全<br>StringBuilder：字符创变量，非线程安全</p>
<p>如果要操作少量的数据用String<br>单线程操作字符串缓冲区下操作大量数据StringBuilder<br>多线程操作字符串缓冲区下操作大量数据StringBuffer<br>5、其他<a href="http://blog.csdn.net/renfufei/article/details/14448147" target="_blank">[引用]</a><br>I.字符串比较”==”与equal()方法<br>“==” 判断两个引用的是不是同一个内存地址(同一个物理对象).<br>equals 判断两个字符串的值是否相等.<br>除非你想判断两个string引用是否同一个对象,否则应该总是使用 equals()方法.<br>II.密码及其他问题上char[]优先于String原因<br>    String是不可变对象, 意思是一旦创建,那么整个对象就不可改变. 即使新手觉得String引用变了,实际上只是(指针)引用指向了另一个(新的)对象.<br>    而程序员可以明确地对字符数组进行修改,因此敏感信息(如密码)不容易在其他地方暴露(只要你用完后对char[]置0).</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[类与对象]]></title>
      <url>/2016/07/09/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/</url>
      <content type="html"><![CDATA[<p>一、Java的对象和类<br>Java作为一种面向对象语言，有类、对象、实例、方法、继承、重载、抽象、多态、封装的基本概念。<br>1、类<br>(1)类是Java的核心和本质，封装、继承、多态和抽象几大特性都离不开类，可以把类看成是对象的模板。<br>(2)类中的变量。包括局部变量、全局变量和类变量。<br>    局部变量：定义在方法中的变量，作用域为本方法中。<br>    成员变量：定义在类中方法外的变量，作用域为本类。<br>    类变量(静态变量)：类变量也声明在类中，方法体之外，但必须声明为static类型(static表示全局的、静态的)。<br>    <a id="more"></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc test</div><div class="line"> * @date 2016年7月10日</div><div class="line"> */</div><div class="line">public class Book &#123;</div><div class="line">	</div><div class="line">	static int num = 0;//类变量</div><div class="line">	static final String type = &quot;children&quot;;//用final变量只能被初始化一次，之后不能再赋值</div><div class="line">	</div><div class="line">	String str=&quot;this is a book&quot;;//实例变量</div><div class="line">	public void borrow()&#123;</div><div class="line">		int i = 0;//局部变量</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void rend()&#123;</div><div class="line">		//静态方法，无需创建对象就能使用</div><div class="line">		System.out.println(&quot;this is a static method.&quot;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		rend();//直接调用</div><div class="line">		System.out.println(&quot;this is a main function.&quot;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	static &#123;</div><div class="line">		//静态代码块，类加载时调用</div><div class="line">		System.out.println(&quot;this is a static code block.&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果：<br><img src="http://img.blog.csdn.net/20160710185420433" alt="这里写图片描述"><br>(3)构造方法<br>        每个类都有构造方法，如果没有显式定义构造方法，编译器会默认为类创建一个不带参的构造方法(若子类继承有带参构造方法的父类，需要显式调用父类构造方法)。<br>        构造方法名必须与类名相同，一个类中可以有多个构造方法(参数不同)，创建对象时至少一个构造方法。<br>2、对象<br>    对象的创建：声明，声明类的类型和名称；实例化，使用new创建一个对象；初始化，创建对象时会调用构造方法初始化对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * @author shen</div><div class="line"> * @desc test</div><div class="line"> * @date 2016年7月10日</div><div class="line"> */</div><div class="line">public class User &#123;</div><div class="line">	</div><div class="line">	private String type = &quot;student&quot;;</div><div class="line">	private String name;//私有属性只能在本类获取到</div><div class="line">	private int age;</div><div class="line">	public int height;//公有属性其他类也能获取到</div><div class="line">	</div><div class="line">	public int getHeight() &#123;</div><div class="line">		return height;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setHeight(int height) &#123;</div><div class="line">		this.height = height;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	//Javabean的规范，通过getter和setter对数据进行封装</div><div class="line">	public String getType() &#123;</div><div class="line">		return type;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setType(String type) &#123;</div><div class="line">		this.type = type;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public String getName() &#123;</div><div class="line">		return name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setName(String name) &#123;</div><div class="line">		this.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public int getAge() &#123;</div><div class="line">		return age;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setAge(int age) &#123;</div><div class="line">		this.age = age;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public User()&#123;</div><div class="line">		//无参构造方法</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public User(String num)&#123;</div><div class="line">		//带参构造</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public User(String name,int age)&#123;</div><div class="line">		//参数个数不同的构造</div><div class="line">		this.name = name;</div><div class="line">		this.age = age;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//普通方法</div><div class="line">	public void borrow(String bookName)&#123;</div><div class="line">		//bookName为方法体中的局部变量</div><div class="line">		System.out.println(this.name + &quot; borrow a book :&quot; + bookName );</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		</div><div class="line">		User jack = new User();//默认的无参构造创建对象</div><div class="line">		jack.age = 20;//私有属性，只能在本类使用这种方式</div><div class="line">		jack.name = &quot;jack&quot;;</div><div class="line">		</div><div class="line">		//公有属性其他类也能获取到，暴露了数据细节。将属性定义为private并使用getter和setter方法隐藏数据的细节(Java的封装特性)</div><div class="line">		jack.height = 170;</div><div class="line">		jack.borrow(&quot;Java code&quot;);</div><div class="line">		System.out.println(jack.type);</div><div class="line">		</div><div class="line">		User jane = new User();</div><div class="line">		jane.setAge(19);//Javabean规范，实现对数据细节的隐藏封装</div><div class="line">		jane.setName(&quot;jane&quot;);</div><div class="line">		jane.setType(&quot;teacher&quot;);</div><div class="line">		jane.borrow(&quot;C prime plus&quot;);</div><div class="line">		System.out.println(jane.type);</div><div class="line">		</div><div class="line">		User tom = new User(&quot;tom&quot;, 21);//使用带参构造创建对象</div><div class="line">		tom.borrow(&quot;C++ prime plus&quot;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果：<br><img src="http://img.blog.csdn.net/20160710185740775" alt="这里写图片描述"></p>
<p>二、基本规则<br>1、一个源文件中只能有一个public类，可以有多个非public类，并且public类名必须与源文件名称相同<br>2、包与import语句<br>(1)Java包主要是用来给类分类，创建包使用package语句实现。包也有基本的命名规则，根据公司或个人名、项目名、模块名等命名。<br>(2)import语句。import语句就是用来提供一个合理的路径，使得编译器可以找到某个类，有点类似与c的头文件和c++的命名空间。</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java 简介和开发环境]]></title>
      <url>/2016/07/01/Java%20%E7%AE%80%E4%BB%8B%E5%92%8C%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      <content type="html"><![CDATA[<p>一、定义与特点<br>定义：Java是一门面向对象编程语言，不仅吸收了C++语言的各种优点，还摒弃了C++里难以理解的多继承、指针等概念，因此Java语言具有功能强大和简单易用两个特征。Java语言作为静态面向对象编程语言的代表，极好地实现了面向对象理论，允许程序员以优雅的思维方式进行复杂的编程。[Java疯狂讲义]<br>特点：主要特点是面向对象和可移植等等，广泛应用于web应用程序(JavaEE相关)、嵌入式(安卓相关)，桌面程序、分布式系统等等。<a id="more"></a><br>二、开发工具和开发环境<br>JDK：Java开发包或Java开发工具，编写Java程序必须，已包含JRE。<br>JRE：Java运行环境，运行编写完毕的Java程序。<br>JDK的安装(Windows系统,Java8)<br>1、首先到oracle官网下载与计算机系统对应的Java SE的JDK即可。<br>2、安装、配置环境变量<br>配置JAVA_HOME的环境变量：<br>新建JAVA_HOME一个变量，路径为JDK的安装路径，指定到jdk文件夹<br><img src="http://img.blog.csdn.net/20160701013707829" alt="这里写图片描述"><br>jdk的版本是1.8，在1.6版本之后的jdk都不必配置classpath环境变量了。<br>3、基本命令<br>win+r运行cmd，输入java命令，可以看到各种选项命令<br><img src="http://img.blog.csdn.net/20160703095547077" alt="这里写图片描述"></p>
<p>输入java -version可以看到当前安装的jdk版本信息<br><img src="http://img.blog.csdn.net/20160701014317597" alt="这里写图片描述"></p>
<p>javac命令，各种编译选项<br><img src="http://img.blog.csdn.net/20160703095933655" alt="这里写图片描述"><br>三、基本数据类型<br>1、Java有八种基本数据类型，包括byte字节类型、int整形、short短整形、long长整形、char字符型、float浮点型(单精度)、double双精度类型、boolean布尔型。<br>2、基本知识<br>一个字节等于8位，一个字节等于256个数，就是-128到127一共256。<br>kB就是kBytes<br>Bytes就是“字节”的意思！<br>K就是千的意思，因为计算机是通过二进制来计算，10个1正好是1024<br>1111111111（二进制）=1024（十进制）<br>1Bytes（字节）=8bit（比特）<br>一个英文字母或一个阿拉伯数字就是一个字符，占用一个字节<br>一个汉字就是两个字符，占用两个字节。<br>3、数据类型转换<br>byte-&gt;short<br>char-&gt;int-&gt;long<br>float-&gt;double<br>int-&gt;float<br>long-&gt;double<br>范围小的转到范围大的<br>范围大的转换到范围小的会失去精度</p>
]]></content>
      
        
        <tags>
            
            <tag> Java基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring springmvc mybatis 整合]]></title>
      <url>/2016/04/10/spring%20springmvc%20mybatis%20%E6%95%B4%E5%90%88/</url>
      <content type="html"><![CDATA[<p>最近鼓捣ssm框架的东西，写篇博文记录。<br>环境 apache-tomcat-8.0.33、jdk1.8.0_05  maven Dynamic Web Module 2.5<br>1、各个xml配置文件的配置<br>(1)pom.xml 配置清单文件<br>连接池用的阿里巴巴Druid，数据库mysql，指定jdk编译版本1.8<a id="more"></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</div><div class="line">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</div><div class="line">  &lt;groupId&gt;cn.shen&lt;/groupId&gt;</div><div class="line">  &lt;artifactId&gt;ssmdemo&lt;/artifactId&gt;</div><div class="line">  &lt;packaging&gt;war&lt;/packaging&gt;</div><div class="line">  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</div><div class="line">  &lt;name&gt;ssmdemo Maven Webapp&lt;/name&gt;</div><div class="line">  &lt;url&gt;http://maven.apache.org&lt;/url&gt;</div><div class="line">  </div><div class="line">  &lt;dependencies&gt;</div><div class="line">		&lt;!-- 添加spring依赖，对应版本号jar包 --&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">	 </div><div class="line">		&lt;!-- 添加tomcat下servlet-api依赖,对应版本 --&gt;</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;javax.servlet&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;3.1.0&lt;/version&gt;</div><div class="line">			&lt;scope&gt;provided&lt;/scope&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line"></div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;junit&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;junit&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.12&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line"></div><div class="line">		</div><div class="line">		&lt;!-- 添加jtl支持 --&gt;</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;javax.servlet&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;jstl&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.2&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">	  </div><div class="line">	  	&lt;!-- 添加Spring支持 --&gt;</div><div class="line">		&lt;dependency&gt;</div><div class="line">	  		&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">	  		&lt;artifactId&gt;spring-core&lt;/artifactId&gt;</div><div class="line">	  		&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">	  	&lt;/dependency&gt;</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">	  		&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">	  		&lt;artifactId&gt;spring-beans&lt;/artifactId&gt;</div><div class="line">	  		&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">	  	&lt;/dependency&gt;</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">	         &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">	         &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;</div><div class="line">	         &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">	        &lt;/dependency&gt;</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">	  		&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">	  		&lt;artifactId&gt;spring-context&lt;/artifactId&gt;</div><div class="line">	  		&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">	  	&lt;/dependency&gt;</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">	  		&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">	  		&lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;</div><div class="line">	  		&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">	  	&lt;/dependency&gt;</div><div class="line">	  	</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-web&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-aop&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">	  </div><div class="line">		  &lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.mybatis&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.2.3&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;!-- 添加日志支持 --&gt;</div><div class="line">	  	&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;log4j&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;log4j&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.2.17&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.slf4j&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.7.12&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;!-- 添加mybatis支持 --&gt;</div><div class="line">		 &lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;org.mybatis&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;mybatis&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;3.3.0&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;!-- jdbc驱动包  --&gt;</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;mysql&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;5.1.37&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;commons-fileupload&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.3.1&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">		&lt;!-- 添加连接池druid支持 --&gt;</div><div class="line">		&lt;dependency&gt;</div><div class="line">			&lt;groupId&gt;com.alibaba&lt;/groupId&gt;</div><div class="line">			&lt;artifactId&gt;druid&lt;/artifactId&gt;</div><div class="line">			&lt;version&gt;1.0.16&lt;/version&gt;</div><div class="line">		&lt;/dependency&gt;</div><div class="line">		</div><div class="line">	&lt;/dependencies&gt;</div><div class="line">  </div><div class="line">  &lt;build&gt;</div><div class="line">    &lt;finalName&gt;ssmdemo&lt;/finalName&gt;</div><div class="line">    &lt;!-- 指定jdk编译器版本 --&gt;</div><div class="line">		&lt;plugins&gt;</div><div class="line">			&lt;plugin&gt;</div><div class="line">				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</div><div class="line">				&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</div><div class="line">				&lt;version&gt;3.1&lt;/version&gt;</div><div class="line">				&lt;configuration&gt;</div><div class="line">					&lt;source&gt;1.8&lt;/source&gt;</div><div class="line">					&lt;target&gt;1.8&lt;/target&gt;</div><div class="line">				&lt;/configuration&gt;</div><div class="line">			&lt;/plugin&gt;</div><div class="line">		&lt;/plugins&gt;</div><div class="line">  &lt;/build&gt;</div><div class="line">&lt;/project&gt;</div></pre></td></tr></table></figure>
<p>(2)web.xml配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance</div><div class="line"> http://www.springmodules.org/schema/cache/springmodules-cache.xsd</div><div class="line"> http://www.springmodules.org/schema/cache/springmodules-ehcache.xsd &quot;</div><div class="line">	xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; </div><div class="line">	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot; </div><div class="line">	id=&quot;WebApp_ID&quot; version=&quot;2.5&quot;&gt;</div><div class="line">  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;</div><div class="line">  </div><div class="line">   &lt;!-- Spring配置文件 --&gt;</div><div class="line">   &lt;!--  --&gt;</div><div class="line">	&lt;context-param&gt;</div><div class="line">		&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</div><div class="line">		&lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;</div><div class="line">	&lt;/context-param&gt;</div><div class="line">   </div><div class="line">   &lt;!-- 解决工程编码过滤器 --&gt;</div><div class="line">	&lt;filter&gt;</div><div class="line">		&lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;</div><div class="line">		&lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;</div><div class="line">		&lt;init-param&gt;</div><div class="line">			&lt;param-name&gt;encoding&lt;/param-name&gt;</div><div class="line">			&lt;param-value&gt;UTF-8&lt;/param-value&gt;</div><div class="line">		&lt;/init-param&gt;</div><div class="line">		&lt;init-param&gt;</div><div class="line">			&lt;param-name&gt;forceEncoding&lt;/param-name&gt;</div><div class="line">			&lt;param-value&gt;true&lt;/param-value&gt;</div><div class="line">		&lt;/init-param&gt;</div><div class="line">	&lt;/filter&gt;</div><div class="line">	&lt;filter-mapping&gt;</div><div class="line">		&lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;</div><div class="line">		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</div><div class="line">	&lt;/filter-mapping&gt;</div><div class="line">   </div><div class="line">    &lt;!-- Spring监听器 --&gt;</div><div class="line">	&lt;listener&gt;</div><div class="line">		&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;</div><div class="line">	&lt;/listener&gt;</div><div class="line">	</div><div class="line">   &lt;!-- 添加对springmvc的支持 --&gt;</div><div class="line">	&lt;servlet&gt;</div><div class="line">		&lt;servlet-name&gt;springMVC&lt;/servlet-name&gt;</div><div class="line">		&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</div><div class="line">		&lt;init-param&gt;</div><div class="line">			&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</div><div class="line">			&lt;param-value&gt;classpath:spring-mvc.xml&lt;/param-value&gt;</div><div class="line">		&lt;/init-param&gt;</div><div class="line">		&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</div><div class="line">		&lt;async-supported&gt;true&lt;/async-supported&gt;</div><div class="line">	&lt;/servlet&gt;</div><div class="line">	&lt;servlet-mapping&gt;</div><div class="line">        &lt;servlet-name&gt;springMVC&lt;/servlet-name&gt;</div><div class="line">        &lt;url-pattern&gt;*.do&lt;/url-pattern&gt;</div><div class="line">    &lt;/servlet-mapping&gt;</div><div class="line">	&lt;servlet-mapping&gt;</div><div class="line">		&lt;servlet-name&gt;springMVC&lt;/servlet-name&gt;</div><div class="line">		&lt;url-pattern&gt;*.html&lt;/url-pattern&gt;</div><div class="line">	&lt;/servlet-mapping&gt;</div><div class="line">&lt;/web-app&gt;</div></pre></td></tr></table></figure>
<p>(3)mybatis配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">	&lt;!-- 别名 --&gt;</div><div class="line">	&lt;typeAliases&gt;</div><div class="line">		&lt;package name=&quot;cn.web.open.model&quot;/&gt;</div><div class="line">	&lt;/typeAliases&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
<p>(4)springmvc配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;    </div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    </div><div class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;   </div><div class="line">    xmlns:p=&quot;http://www.springframework.org/schema/p&quot;  </div><div class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;   </div><div class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;  </div><div class="line">    xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;  </div><div class="line">    xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;  </div><div class="line">    xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;</div><div class="line">    xsi:schemaLocation=&quot;    </div><div class="line">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/mvc   http://www.springframework.org/schema/mvc/spring-mvc.xsd</div><div class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd&quot;&gt;    </div><div class="line"></div><div class="line">	</div><div class="line">	&lt;!-- 使用注解的包，包括子集 --&gt;</div><div class="line">	&lt;context:component-scan base-package=&quot;cn.web.open.controller&quot; /&gt;</div><div class="line">	&lt;!-- 开启注解 --&gt;</div><div class="line">	&lt;mvc:annotation-driven/&gt;</div><div class="line">	</div><div class="line">	&lt;mvc:resources mapping=&quot;/static/**&quot; location=&quot;/static/&quot;/&gt;</div><div class="line"></div><div class="line">	&lt;!-- 视图解析器 --&gt;</div><div class="line">	&lt;bean id=&quot;viewResolver&quot;</div><div class="line">		class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</div><div class="line">		&lt;property name=&quot;prefix&quot; value=&quot;/&quot; /&gt;	</div><div class="line">		&lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line">	</div><div class="line">	&lt;!-- 文件上传解析器 id 必须为multipartResolver --&gt;</div><div class="line">	&lt;bean id=&quot;multipartResolver&quot;</div><div class="line">        class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;</div><div class="line">		&lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot;/&gt;  </div><div class="line">	    &lt;property name=&quot;maxUploadSize&quot; value=&quot;10000000&quot;/&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line"></div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<p>(5)数据源及整合配置applicationContext.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;    </div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    </div><div class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;   </div><div class="line">    xmlns:p=&quot;http://www.springframework.org/schema/p&quot;  </div><div class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;   </div><div class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;  </div><div class="line">    xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;  </div><div class="line">    xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;  </div><div class="line">    xsi:schemaLocation=&quot;    </div><div class="line">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd  </div><div class="line">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd&quot;&gt;    </div><div class="line">        </div><div class="line">	</div><div class="line">	</div><div class="line">	&lt;!-- 配置数据源 ,连接池用的阿里druid--&gt;</div><div class="line">	&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt;</div><div class="line">		&lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</div><div class="line">		&lt;!-- </div><div class="line">		&lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://IP+数据库&quot;/&gt;</div><div class="line">		&lt;property name=&quot;username&quot; value=&quot;用户名&quot;/&gt;</div><div class="line">		&lt;property name=&quot;password&quot; value=&quot;密码&quot;/&gt;</div><div class="line">		 --&gt;</div><div class="line">		 &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://121.42.57.186:3306/blog&quot;/&gt;</div><div class="line">		&lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</div><div class="line">		&lt;property name=&quot;password&quot; value=&quot;shen200800&quot;/&gt;</div><div class="line">		</div><div class="line">	&lt;/bean&gt;</div><div class="line"></div><div class="line">	&lt;!-- 配置mybatis的sqlSessionFactory --&gt;</div><div class="line">	&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</div><div class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</div><div class="line">		&lt;!-- 自动扫描mappers.xml文件 --&gt;</div><div class="line">		&lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:mappers/*.xml&quot;&gt;&lt;/property&gt;</div><div class="line">		&lt;!-- mybatis配置文件 --&gt;</div><div class="line">		&lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot;&gt;&lt;/property&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line"></div><div class="line">	&lt;!-- DAO接口所在包名，Spring会自动查找其下的类 --&gt;</div><div class="line">	&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</div><div class="line">		&lt;property name=&quot;basePackage&quot; value=&quot;cn.web.open.dao&quot; /&gt;</div><div class="line">		&lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;sqlSessionFactory&quot;&gt;&lt;/property&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line"></div><div class="line">	&lt;!-- (事务管理)transaction manager, use JtaTransactionManager for global tx --&gt;</div><div class="line">	&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</div><div class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</div><div class="line">	&lt;/bean&gt;</div><div class="line">	&lt;!-- 5. 使用声明式事务 transaction-manager：引用上面定义的事务管理器--&gt;</div><div class="line">	&lt;tx:annotation-driven transaction-manager=&quot;txManager&quot; /&gt;</div><div class="line">	</div><div class="line">	</div><div class="line">  &lt;!-- 配置事务通知属性 --&gt;  </div><div class="line">    &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;  </div><div class="line">        &lt;!-- 定义事务传播属性 --&gt;  </div><div class="line">        &lt;tx:attributes&gt;  </div><div class="line">            &lt;tx:method name=&quot;insert*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;update*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;edit*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;save*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;add*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;new*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;set*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;remove*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;delete*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;change*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;check*&quot; propagation=&quot;REQUIRED&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;get*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;find*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;load*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot; /&gt;  </div><div class="line">            &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot; /&gt;  </div><div class="line">        &lt;/tx:attributes&gt;  </div><div class="line">    &lt;/tx:advice&gt;  </div><div class="line">	</div><div class="line">  </div><div class="line">    &lt;!-- 配置事务切面 --&gt;  </div><div class="line">    &lt;aop:config&gt;  </div><div class="line">        &lt;aop:pointcut id=&quot;serviceOperation&quot;  </div><div class="line">            expression=&quot;execution(* cn.web.open.service.*.*(..))&quot; /&gt;  </div><div class="line">        &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;serviceOperation&quot; /&gt;  </div><div class="line">    &lt;/aop:config&gt;  </div><div class="line">    </div><div class="line">   &lt;!-- 自动扫描 --&gt;</div><div class="line">	&lt;context:component-scan base-package=&quot;cn.web.open.service&quot; /&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<p>2、工程结构<br>(1)分层结构<br><img src="http://img.blog.csdn.net/20160409215530663" alt="这里写图片描述"></p>
<p>(2)实体类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">package cn.web.open.model;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line"></div><div class="line">public class User &#123;</div><div class="line">	private String userCode;</div><div class="line">	private String userName;</div><div class="line">	private String userPwd;</div><div class="line">	private String email;</div><div class="line">	private String address;</div><div class="line">	private Date userBorn;</div><div class="line">	</div><div class="line">	public String getUserCode() &#123;</div><div class="line">		return userCode;</div><div class="line">	&#125;</div><div class="line">	public void setUserCode(String userCode) &#123;</div><div class="line">		this.userCode = userCode;</div><div class="line">	&#125;</div><div class="line">	public String getUserName() &#123;</div><div class="line">		return userName;</div><div class="line">	&#125;</div><div class="line">	public void setUserName(String userName) &#123;</div><div class="line">		this.userName = userName;</div><div class="line">	&#125;</div><div class="line">	public String getUserPwd() &#123;</div><div class="line">		return userPwd;</div><div class="line">	&#125;</div><div class="line">	public void setUserPwd(String userPwd) &#123;</div><div class="line">		this.userPwd = userPwd;</div><div class="line">	&#125;</div><div class="line">	public String getEmail() &#123;</div><div class="line">		return email;</div><div class="line">	&#125;</div><div class="line">	public void setEmail(String email) &#123;</div><div class="line">		this.email = email;</div><div class="line">	&#125;</div><div class="line">	public String getAddress() &#123;</div><div class="line">		return address;</div><div class="line">	&#125;</div><div class="line">	public void setAddress(String address) &#123;</div><div class="line">		this.address = address;</div><div class="line">	&#125;</div><div class="line">	public Date getUserBorn() &#123;</div><div class="line">		return userBorn;</div><div class="line">	&#125;</div><div class="line">	public void setUserBorn(Date userBorn) &#123;</div><div class="line">		this.userBorn = userBorn;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>dao接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">package cn.web.open.dao;</div><div class="line">import cn.web.open.model.User;</div><div class="line"></div><div class="line">public interface UserDao &#123;</div><div class="line">	User findById(String code,String pwd);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>service接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">package cn.web.open.service;</div><div class="line">import cn.web.open.model.User;</div><div class="line"></div><div class="line">public interface UserService &#123;</div><div class="line">	</div><div class="line">	User findById(String code,String pwd);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>service实现类,@Resource注入dao</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">package cn.web.open.service.impl;</div><div class="line"></div><div class="line">import javax.annotation.Resource;</div><div class="line">import org.springframework.stereotype.Service;</div><div class="line">import cn.web.open.dao.UserDao;</div><div class="line">import cn.web.open.model.User;</div><div class="line">import cn.web.open.service.UserService;</div><div class="line"></div><div class="line">@Service(&quot;userService&quot;)</div><div class="line">public class UserServiceImpl implements UserService&#123;</div><div class="line">	@Resource</div><div class="line">	private UserDao userDao;</div><div class="line"></div><div class="line">	public User findById(String code,String pwd) &#123;</div><div class="line">		User user = userDao.findById(code,pwd);</div><div class="line">		return user;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>控制器controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package cn.web.open.controller;</div><div class="line"></div><div class="line"></div><div class="line">import javax.annotation.Resource;</div><div class="line">import javax.servlet.http.HttpServletRequest;</div><div class="line">import org.springframework.stereotype.Controller;</div><div class="line">import org.springframework.ui.Model;</div><div class="line">import org.springframework.web.bind.annotation.RequestMapping;</div><div class="line">import cn.web.open.model.User;</div><div class="line">import cn.web.open.service.UserService;</div><div class="line"></div><div class="line">@Controller</div><div class="line">//@RequestMapping(&quot;/user&quot;)</div><div class="line">public class UserController &#123;</div><div class="line">	</div><div class="line">	@Resource</div><div class="line">	private UserService userService;</div><div class="line">	</div><div class="line">	@RequestMapping(&quot;/login&quot;)</div><div class="line">	public String login(HttpServletRequest request, Model model) &#123;</div><div class="line">		String code = request.getParameter(&quot;usercode&quot;);</div><div class="line">		String pwd = request.getParameter(&quot;password&quot;);</div><div class="line">		User user_login = userService.findById(code,pwd);</div><div class="line">		System.out.println(&quot;---&gt;&quot;+user_login);</div><div class="line">		</div><div class="line">		if (null == user_login) &#123;</div><div class="line">			System.out.println(&quot;Error login!&quot;);</div><div class="line">			return &quot;redirect:index.jsp?oper=error&quot;;</div><div class="line">		&#125; else &#123;</div><div class="line">			model.addAttribute(&quot;user&quot;, user_login);</div><div class="line">			return &quot;pages/success&quot;;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>sql语句文件mappers/userMapper.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;pre name=&quot;code&quot; class=&quot;html&quot;&gt;&lt;pre name=&quot;code&quot; class=&quot;html&quot;&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</div><div class="line">&lt;mapper namespace=&quot;cn.web.open.dao.UserDao&quot;&gt;</div><div class="line">	&lt;resultMap type=&quot;User&quot; id=&quot;UserResult&quot;&gt;</div><div class="line">		&lt;result column=&quot;USER_CODE&quot; property=&quot;userCode&quot; /&gt;</div><div class="line">		&lt;result column=&quot;USER_NAME&quot; property=&quot;userName&quot; /&gt;</div><div class="line">		&lt;result column=&quot;USER_PWD&quot; property=&quot;userPwd&quot; /&gt;</div><div class="line">	&lt;/resultMap&gt;</div><div class="line">	&lt;!-- 查询条件:账号密码用户类型. 0第一个参数,1第二个参数,对应dao接口参数 --&gt;</div><div class="line">	&lt;select id=&quot;findById&quot; parameterType=&quot;String&quot; resultMap=&quot;UserResult&quot;&gt;</div><div class="line">		SELECT USER_CODE,USER_NAME,USER_PWD FROM BLOG_USER WHERE USER_CODE=#&#123;0&#125; AND USER_PWD=#&#123;1&#125; AND USER_TYPE=2</div><div class="line">	&lt;/select&gt;</div><div class="line"></div><div class="line">	&lt;!-- </div><div class="line">	&lt;select id=&quot;getAllUsers&quot; resultMap=&quot;userResult&quot;&gt;</div><div class="line">		SELECT USER_CODE,USER_NAME,USER_PWD,CREATE_DATE</div><div class="line">		FROM BLOG_USER</div><div class="line">	&lt;/select&gt;</div><div class="line">	 --&gt;</div><div class="line">&lt;/mapper&gt;</div></pre></td></tr></table></figure>
<p>(3)前台的一些测试页面<br><img src="http://img.blog.csdn.net/20160409221836381" alt="这里写图片描述"><br>WEB_INF下文件不能通过URL直接访问,登录页面网上拿了别人做了一个页面，挺有趣的，访问工程地址,端口你自己配的,输入管理员类型的账号测试<br><img src="http://img.blog.csdn.net/20160409222553125" alt="这里写图片描述"><br>刚开始对于各种注解的使用不甚了解鼓捣了许久,用maven管理项目构建时也碰到许多小问题，着实查了许多资料,下过别人的demo参考，总算是把ssm这一套搭起来了，如果发现有问题，请留言指教。demo下载<a href="http://download.csdn.net/detail/u012809062/9486330" target="_blank" rel="external">http://download.csdn.net/detail/u012809062/9486330</a></p>
]]></content>
      
        
        <tags>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MySQL入门接触记录--从安装到Java通过JDBC连接MySQL数据库]]></title>
      <url>/2015/12/12/MySQL%E5%85%A5%E9%97%A8%E6%8E%A5%E8%A7%A6%E8%AE%B0%E5%BD%95--%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0Java%E9%80%9A%E8%BF%87JDBC%E8%BF%9E%E6%8E%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>一、安装MySQL<br>1.本人用的版本是mysql-5.6.24-winx64解压免装版，链接：<br><a href="http://xiazai.zol.com.cn/detail/4/33431.shtml" target="_blank" rel="external">http://xiazai.zol.com.cn/detail/4/33431.shtml</a><br>解压后找到my-default.ini文件，复制改名为my.ini，修改添加以下语句：<a id="more"></a><br>[client]<br>port=3306<br>default-character-set=utf8</p>
<p>[mysqld]<br>port=3306<br>character_set_server=utf8</p>
<p>#以下路径为你解压到的文件夹<br>basedir = D:\Program Files\mysql-5.6.24-winx64<br>datadir = D:\Program Files\mysql-5.6.24-winx64\data<br>sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES<br>2.配置环境变量：计算机-属性-高级系统设置-高级-环境变量，在Path中添加<br>D:\Program Files\mysql-5.6.24-winx64\bin<br>路径依然根据自己所解压到的路径决定，注意添加时前面用；分号隔开。<br>3.win+r进dos，cd到解压文件目录的bin文件下<br>安装服务：mysqld -install<br>启动服务:net start mysql<br>如果要删除服务，命令为：mysqld -remove<br>安装结束———-</p>
<p>二、创建数据库和表<br>以一个简单例子为例，步骤如下:<br>win+r进dos并cd到解压路径的bin文件下，执行mysql -uroot -p<br>因为初始密码为空，直接回车，如图</p>
<p>show databases;  显示目前所有的数据库<br>create database 库名;  因为之前person已经创建过，所有提示存在<br>创建完我们使用它，use person;</p>
<p>接着创建一个表名student的表,有两个简单的属性, 命令:create table &lt;表名&gt; (&lt;字段名 1&gt; &lt;类型 1&gt; [,..&lt;字段名 n&gt; &lt;类型 n&gt;]); 具体如下:</p>
<p>查看表结构命令: show columns from 表名;<br>插入数据命令:insert into &lt;表名&gt; [( &lt;字段名 1&gt;[,..&lt;字段名 n &gt; ])] values ( 值 1 )[, ( 值 n )]<br>以下随便插入两个<br>select * from 表名;  显示表所有内容</p>
<p>三、在eclipse上通过JDBC连接MySQl数据库<br>1.下载对应MySQL的驱动包 <a href="http://dev.mysql.com/downloads/connector/j/" target="_blank" rel="external">http://dev.mysql.com/downloads/connector/j/</a><br>解压驱动包，eclipse新建一个java工程MysqlDemo，复制驱动包的.jar文件，在java工程右键paste，接着在.jar包右键Build Path - Configure Build Path,这样驱动就加载进来了</p>
<p>测试程序参考自<a href="http://qq163230530.blog.163.com/blog/static/4289250620081186262719/" target="_blank" rel="external">http://qq163230530.blog.163.com/blog/static/4289250620081186262719/</a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.sql.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MysqlDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="comment">//声明Connection对象</span></div><div class="line">        Connection con;</div><div class="line">        <span class="comment">//驱动程序名</span></div><div class="line">        String driver = <span class="string">"com.mysql.jdbc.Driver"</span>;</div><div class="line">        <span class="comment">//URL指向要访问的数据库名mydata</span></div><div class="line">        String url = <span class="string">"jdbc:mysql://localhost:3306/person"</span>;</div><div class="line">        <span class="comment">//MySQL配置时的用户名</span></div><div class="line">        String user = <span class="string">"root"</span>;</div><div class="line">        <span class="comment">//MySQL配置时的密码</span></div><div class="line">        String password = <span class="string">""</span>;</div><div class="line">        <span class="comment">//遍历查询结果集</span></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//加载驱动程序</span></div><div class="line">            Class.forName(driver);</div><div class="line">            <span class="comment">//1.getConnection()方法，连接MySQL数据库！！</span></div><div class="line">            con = DriverManager.getConnection(url,user,password);</div><div class="line">            <span class="keyword">if</span>(!con.isClosed())</div><div class="line">                System.out.println(<span class="string">"Succeeded connecting to the Database!"</span>);</div><div class="line">            <span class="comment">//2.创建statement类对象，用来执行SQL语句！！</span></div><div class="line">            Statement statement = con.createStatement();</div><div class="line">            <span class="comment">//要执行的SQL语句</span></div><div class="line">            String sql = <span class="string">"select * from student"</span>;</div><div class="line">            <span class="comment">//3.ResultSet类，用来存放获取的结果集！！</span></div><div class="line">            ResultSet rs = statement.executeQuery(sql);</div><div class="line">            System.out.println(<span class="string">"-----------------"</span>);</div><div class="line">            System.out.println(<span class="string">"执行结果如下所示:"</span>);  </div><div class="line">            System.out.println(<span class="string">"-----------------"</span>);  </div><div class="line">            System.out.println(<span class="string">" 学号"</span> + <span class="string">"\t"</span> + <span class="string">" 姓名"</span>);  </div><div class="line">            System.out.println(<span class="string">"-----------------"</span>);  </div><div class="line">             </div><div class="line">            String name = <span class="keyword">null</span>;</div><div class="line">            String id = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">while</span>(rs.next())&#123;</div><div class="line">                <span class="comment">//获取stuname这列数据</span></div><div class="line">                name = rs.getString(<span class="string">"name"</span>);</div><div class="line">                <span class="comment">//获取stuid这列数据</span></div><div class="line">                id = rs.getString(<span class="string">"id"</span>);</div><div class="line">                <span class="comment">//首先使用ISO-8859-1字符集将name解码为字节序列并将结果存储新的字节数组中。</span></div><div class="line">                <span class="comment">//然后使用GB2312字符集解码指定的字节数组。</span></div><div class="line">                name = <span class="keyword">new</span> String(name.getBytes(<span class="string">"ISO-8859-1"</span>),<span class="string">"gb2312"</span>);</div><div class="line">                <span class="comment">//输出结果</span></div><div class="line">                System.out.println(id + <span class="string">"\t"</span> + name);</div><div class="line">            &#125;</div><div class="line">            rs.close();</div><div class="line">            con.close();</div><div class="line">        &#125; <span class="keyword">catch</span>(ClassNotFoundException e) &#123;   </div><div class="line">            <span class="comment">//数据库驱动类异常处理</span></div><div class="line">            System.out.println(<span class="string">"Sorry,can`t find the Driver!"</span>);   </div><div class="line">            e.printStackTrace();   </div><div class="line">            &#125; <span class="keyword">catch</span>(SQLException e) &#123;</div><div class="line">            <span class="comment">//数据库连接失败异常处理</span></div><div class="line">            e.printStackTrace();  </div><div class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span>&#123;</div><div class="line">            System.out.println(<span class="string">"数据库数据成功获取！！"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>run结果</p>
<p>印象流程大概这样，水平有限，记录。</p>
]]></content>
      
        
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[opencv简单的彩色图像灰度化和二值化（学习笔记）]]></title>
      <url>/2015/05/04/opencv%E7%AE%80%E5%8D%95%E7%9A%84%E5%BD%A9%E8%89%B2%E5%9B%BE%E5%83%8F%E7%81%B0%E5%BA%A6%E5%8C%96%E5%92%8C%E4%BA%8C%E5%80%BC%E5%8C%96%EF%BC%88%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>  图像的灰度化即是将彩色图像转化成为灰度图像的过程成为图像的灰度化处理。彩色图像中的每个像素的颜色有R、G、B三个分量决定，而每个分量有255中值可取，这样一个像素点可以有1600多万（255<em>255</em>255）的颜色的变化范围。而灰度图像是R、G、B三个分量相同的一种特殊的彩色图像，其一个像素点的变化范围为255种，所以在数字图像处理种一般先将各种格式的图像转变成灰度图像以使后续的图像的计算量变得少一些。灰度图像的描述与彩色图像一样仍然反映了整幅图像的整体和局部的色度和亮度等级的分布和特征。图像的灰度化处理可用两种方法来实现。<br>   图像的二值化是将图像上的像素点的灰度值设置为0或255，也就是将整个图像呈现出明显的黑白效果。要对RGB彩色图像进行二值化一般首先要对图像进行灰度化处理。<br><a id="more"></a><br>例子<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cv.h"</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"highgui.h"</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cvaux.h&gt;</span></span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">    &#123;</div><div class="line">        IplImage* img;</div><div class="line">        IplImage* img0;</div><div class="line">        IplImage* img1;</div><div class="line"></div><div class="line">        img = cvLoadImage(<span class="string">"test.jpg"</span>);<span class="comment">//默认初始图像放在工程文件下</span></div><div class="line">        <span class="comment">//IplImage* img1 = img;</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="literal">NULL</span> == img)</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">//灰度化操作</span></div><div class="line">        img0 = cvCreateImage(cvGetSize(img),IPL_DEPTH_8U,<span class="number">1</span>);<span class="comment">//申请一段内存</span></div><div class="line">        cvCvtColor(img,img0,CV_BGR2GRAY);</div><div class="line"><span class="comment">//图像数据复制</span></div><div class="line">        img1 = cvCreateImage(cvGetSize(img),IPL_DEPTH_8U,<span class="number">1</span>);<span class="comment">//申请一段内存</span></div><div class="line">        cvCopy(img0, img1, <span class="literal">NULL</span>);<span class="comment">//数据复制，若直接赋值相当指针指向同一地址会对原本img0操作</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//二值化操作</span></div><div class="line">        <span class="keyword">int</span> height = img1-&gt;height;</div><div class="line">        <span class="keyword">int</span> width = img1-&gt;width;</div><div class="line">        <span class="keyword">int</span> step = img1-&gt;widthStep;</div><div class="line">        <span class="keyword">int</span> channels = img1-&gt;nChannels;</div><div class="line">        uchar *data = (uchar*)img1-&gt;imageData;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i != height; ++ i)</div><div class="line">        &#123;</div><div class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j != width; ++ j)</div><div class="line">         &#123;</div><div class="line">             <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k != channels; ++ k)</div><div class="line">             &#123;</div><div class="line">                 <span class="keyword">if</span>(data[i*step+j*channels+k]&lt;<span class="number">128</span>)</div><div class="line">                  data[i*step+j*channels+k]=<span class="number">0</span>;<span class="comment">//255-data[i*step+j*channels+k];</span></div><div class="line">                  <span class="keyword">else</span></div><div class="line">                  data[i*step+j*channels+k]=<span class="number">255</span>;<span class="comment">//255-data[i*step+j*channels+k];</span></div><div class="line">             &#125;</div><div class="line">         &#125;</div><div class="line">        &#125;</div><div class="line"><span class="comment">//创建窗口、显示图像、销毁图像、释放图像</span></div><div class="line">        cvNamedWindow( <span class="string">"test1"</span>, <span class="number">0</span> );</div><div class="line">        cvShowImage(<span class="string">"test1"</span>, img0);</div><div class="line"></div><div class="line">        cvNamedWindow( <span class="string">"test"</span>, <span class="number">0</span> );</div><div class="line">        cvShowImage(<span class="string">"test"</span>, img1);</div><div class="line"></div><div class="line">        cvWaitKey(<span class="number">0</span>);</div><div class="line"></div><div class="line">        cvDestroyWindow( <span class="string">"test1"</span> );</div><div class="line">        cvDestroyWindow( <span class="string">"test"</span> );</div><div class="line"></div><div class="line">        cvReleaseImage( &amp;img0 );</div><div class="line">        cvReleaseImage( &amp;img1 );</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[avr单片机三种时钟模式]]></title>
      <url>/2015/05/04/avr%E5%8D%95%E7%89%87%E6%9C%BA%E4%B8%89%E7%A7%8D%E6%97%B6%E9%92%9F%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>AVR单片机时钟有三种模式：<br>1、内部时钟源，可分为内部晶振和外部晶振，用的是单片机内部的振荡电路。内部晶振可以设置1M、2M、4M、8MHz晶振频率，外部可支持到16MHz（MEGA16或者MEGA16A）MEGA16L可支持最高8MHz的外部晶振（通过熔丝设置）。<br>2、外部时钟源，靠外部振荡电路提供时钟，可以用外部同步时钟信号（如用其他单片机提供时钟）或者外部振荡器（如有源晶振）将此信号接到单片机XTAL1端口，熔丝设置为外部时钟即可（不是外部晶振）。<br>3、设置晶振熔丝错误会导致芯片锁死，如果设置为外部晶振，直接加晶振即可解除，设置为外部时钟源，那只好提供外部时钟才能解除（有源晶振）。</p>
]]></content>
      
        
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
